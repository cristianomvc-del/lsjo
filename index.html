<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>LSJO - Liga Supremos de Jogos Online</title>
    
    <style>
        /* RESET E BASE */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: radial-gradient(circle, #1e2a3a 0%, #111821 100%); 
            color: #eee; 
            display: flex; 
            justify-content: center; 
            padding: 10px; 
            min-height: 100vh;
        }
        
        /* CONTAINER PRINCIPAL */
        .container { 
            width: 100%; 
            max-width: 1200px; 
            background-color: #243142; 
            border-radius: 15px; 
            overflow: hidden; 
            box-shadow: 0 15px 50px rgba(0,0,0,0.7); 
            display: flex; 
            flex-direction: column; 
            border: 1px solid #34495e; 
        }

        /* ===== HEADER RESPONSIVO ===== */
        .header { 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            padding: 20px 30px; 
            background: linear-gradient(135deg, #2c3e50 0%, #000000 100%); 
            position: relative;
            border-bottom: 4px solid #f1c40f; 
            overflow: hidden;
            flex-wrap: wrap;
        }
        .header::before { 
            content: ""; 
            position: absolute; 
            top: -50%; 
            left: -10%; 
            width: 70%; 
            height: 200%; 
            background: radial-gradient(circle, rgba(52, 152, 219, 0.2) 0%, transparent 70%); 
            transform: rotate(-15deg); 
        }
        .logo-area { 
            position: relative; 
            z-index: 2; 
        }
        .logo-area h1 { 
            font-size: 48px; 
            color: #fff; 
            text-shadow: 0 4px 10px rgba(0,0,0,0.5); 
            margin: 0; 
            font-family: 'Arial Black', sans-serif; 
            line-height: 0.9; 
            letter-spacing: -2px; 
        }
        .logo-area p { 
            font-size: 16px; 
            color: #f1c40f; 
            font-weight: bold; 
            margin: 0; 
            letter-spacing: 1px; 
            text-transform: uppercase; 
        }
        .logo-area span { 
            font-size: 12px; 
            color: #bdc3c7; 
            display: block; 
            margin-top: 5px; 
        }

        .pool-table-visual {
            position: relative; 
            z-index: 2; 
            width: 250px; 
            height: 130px; 
            background: #222; 
            border: 6px solid #555;
            border-radius: 10px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.8), inset 0 0 50px rgba(0,0,0,0.5);
            display: flex; 
            align-items: center; 
            justify-content: center; 
            transform: perspective(500px) rotateX(20deg);
        }
        .cue-stick { 
            position: absolute; 
            width: 160px; 
            height: 4px; 
            background: linear-gradient(90deg, #63472b, #d4af37, #fff); 
            transform: rotate(-25deg); 
            top: 50px; 
            left: -10px; 
            box-shadow: 2px 5px 10px rgba(0,0,0,0.5); 
            border-radius: 2px; 
        }
        .ball-8-top { 
            width: 60px; 
            height: 60px; 
            background: radial-gradient(circle at 30% 30%, #444, #000); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            position: relative; 
            box-shadow: 5px 10px 20px rgba(0,0,0,0.6); 
            border: 1px solid #333; 
        }
        .ball-8-top .inner-circle { 
            width: 28px; 
            height: 28px; 
            background: white; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-weight: 900; 
            color: black; 
            font-size: 16px; 
        }

        .info-bar { 
            background-color: #ecf0f1; 
            padding: 8px 15px; 
            font-size: 12px; 
            color: #2c3e50; 
            font-weight: bold; 
            border-bottom: 1px solid #bdc3c7; 
            text-align: center;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .total-jogadores {
            background: #2c3e50;
            color: #f1c40f;
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 11px;
            font-weight: bold;
        }

        /* ===== LAYOUT PRINCIPAL RESPONSIVO ===== */
        .main-content { 
            display: grid; 
            grid-template-columns: 200px 1fr 220px; 
            gap: 15px; 
            padding: 15px; 
            background-color: #1a2533; 
        }

        /* Sidebars */
        .sidebar-left, .sidebar-right { 
            display: flex; 
            flex-direction: column; 
            gap: 10px; 
        }

        /* Bot√µes */
        .btn-menu { 
            background: linear-gradient(180deg, #ffffff 0%, #dfe6e9 100%); 
            color: #2d3436; 
            border: 1px solid #b2bec3; 
            padding: 12px; 
            border-radius: 20px; 
            text-align: center; 
            font-weight: bold; 
            cursor: pointer; 
            font-size: 11px; 
            transition: 0.3s; 
            width: 100%;
        }
        .btn-menu:hover { 
            background: linear-gradient(180deg, #636e72 0%, #2d3436 100%); 
            color: white; 
            transform: translateY(-2px); 
        }
        .btn-blue { 
            background: linear-gradient(180deg, #3498db 0%, #2980b9 100%); 
            color: white; 
            border: 1px solid #1c5980; 
        }
        
        .btn-master-especial { 
            background: #000; 
            color: #f1c40f; 
            border: 2px solid #f1c40f; 
            display: none; 
        }
        .btn-pato { 
            background: linear-gradient(180deg, #e67e22 0%, #d35400 100%) !important; 
            color: white !important; 
            display: none; 
        }

        /* Painel Central */
        .center-panel { 
            background: #ffffff; 
            border-radius: 15px; 
            padding: 20px; 
            color: #2c3e50; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.4); 
            overflow-x: auto;
        }
        .section-title { 
            color: white; 
            padding: 12px; 
            border-radius: 10px; 
            text-align: center; 
            margin-bottom: 20px; 
            font-weight: bold; 
            text-transform: uppercase; 
        }

        /* Grids responsivos */
        .grid-how-works { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 15px; 
            margin-top: 10px; 
        }
        .step-card { 
            border: 3px solid #ccc; 
            border-radius: 15px; 
            padding: 20px; 
            text-align: center; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            background: #fff; 
            min-height: 120px; 
        }
        .step-card strong { 
            display: block; 
            font-size: 16px; 
            margin-bottom: 8px; 
            color: #333; 
        }
        .step-card p { 
            font-size: 13px; 
            color: #666; 
            line-height: 1.3; 
        }
        .card-green { border-color: #27ae60; }
        .card-blue { border-color: #2980b9; }
        .card-orange { border-color: #e67e22; }
        .card-gold { border-color: #f1c40f; }

        /* Ranking cards */
        .ranking-options { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
            gap: 15px; 
        }
        .rank-card { 
            background: #f8f9fa; 
            border: 2px solid #ddd; 
            border-radius: 15px; 
            padding: 15px; 
            text-align: center; 
            cursor: pointer; 
            transition: 0.3s; 
        }
        .rank-card:hover { 
            transform: translateY(-5px); 
            border-color: #2980b9; 
        }
        .rank-icon { 
            width: 70px; 
            height: 70px; 
            margin: 0 auto 10px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 35px; 
            border-radius: 50%; 
            background: #2c3e50; 
            color: #fff; 
            border: 3px solid #f1c40f; 
        }
        .icon-9 { 
            background: radial-gradient(circle at 30% 30%, #f1c40f 0%, #d4ac0d 100%); 
            color: #000; 
            border: 3px solid #fff; 
        }

        /* ===== RANKING MODERNO COM PAGINA√á√ÉO ===== */
        .tab-container { 
            display: flex; 
            gap: 8px; 
            margin-bottom: 20px; 
            border-bottom: 2px solid #eee; 
            padding-bottom: 10px; 
            flex-wrap: wrap;
        }
        .tab-button { 
            flex: 1; 
            padding: 12px; 
            border: none; 
            background: #f1f2f6; 
            cursor: pointer; 
            font-weight: bold; 
            font-size: 12px; 
            border-radius: 50px; 
            transition: 0.3s; 
            min-width: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            color: #475569;
            border: 1px solid #e2e8f0;
        }
        .tab-button.active { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; 
            border: none;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        .tab-icon {
            font-size: 14px;
        }

        .btn-voltar {
            background: white;
            border: 2px solid #e2e8f0;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 12px;
            cursor: pointer;
            margin-bottom: 20px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: 0.3s;
            color: #475569;
        }

        .btn-voltar:hover {
            background: #f1f5f9;
            border-color: #94a3b8;
            transform: translateX(-5px);
        }

        .seta {
            font-size: 16px;
            font-weight: bold;
        }

        /* Ranking Table */
        .ranking-table-wrapper {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin: 20px 0;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .ranking-table-moderno {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .ranking-table-moderno thead tr {
            background: linear-gradient(135deg, #1e293b, #0f172a);
        }

        .ranking-table-moderno th {
            color: white;
            font-weight: 600;
            padding: 16px 12px;
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: 1px;
            border-bottom: 3px solid #f1c40f;
        }

        .ranking-table-moderno td {
            padding: 14px 12px;
            border-bottom: 1px solid #e2e8f0;
            font-weight: 500;
        }

        .ranking-table-moderno tbody tr:nth-child(even) {
            background-color: #f8fafc;
        }

        .ranking-table-moderno tbody tr:hover {
            background: linear-gradient(135deg, #eef2ff, #e0e7ff);
            transform: scale(1.01);
            transition: 0.2s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .ranking-table-moderno tbody tr.top-1 {
            background: linear-gradient(135deg, #fef9c3, #fde047);
            font-weight: bold;
        }

        .ranking-table-moderno tbody tr.top-1:hover {
            background: linear-gradient(135deg, #fde047, #facc15);
        }

        .ranking-table-moderno tbody tr.top-2 {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
        }

        .ranking-table-moderno tbody tr.top-3 {
            background: linear-gradient(135deg, #fed7aa, #fdba74);
        }

        /* Estilo para slots vazios */
        .slot-vazio {
            opacity: 0.7;
            background: linear-gradient(135deg, #f8fafc, #f1f5f9) !important;
        }
        
        .slot-vazio td {
            color: #64748b !important;
            font-style: italic;
        }

        .slot-vazio .streak-indicator {
            color: #94a3b8 !important;
        }

        /* Ranking Cards (Mobile) */
        .ranking-cards-container {
            display: none;
        }

        /* Cards vazios no mobile */
        .ranking-card.vazio {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border: 2px dashed #cbd5e1;
        }
        
        .ranking-card.vazio .ranking-card-nome {
            color: #64748b;
            font-style: italic;
        }

        .ranking-card.vazio .ranking-card-pontos {
            color: #94a3b8;
        }

        /* Pagina√ß√£o */
        .pagination-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 20px 0 10px;
            flex-wrap: wrap;
        }

        .pagination-btn {
            background: white;
            border: 2px solid #e2e8f0;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 12px;
            cursor: pointer;
            transition: 0.3s;
            color: #475569;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .pagination-btn:hover:not(:disabled) {
            background: #f1f5f9;
            border-color: #94a3b8;
            transform: translateY(-2px);
        }

        .pagination-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .pagination-info {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 13px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        /* Mensagem de ranking vazio */
        .empty-ranking-message {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border-radius: 20px;
            margin: 20px 0;
        }
        
        .empty-ranking-message h3 {
            font-size: 18px;
            color: #1e293b;
            margin-bottom: 10px;
        }
        
        .empty-ranking-message p {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 20px;
        }
        
        .empty-ranking-message .icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .empty-ranking-message .btn-menu {
            width: auto;
            padding: 10px 30px;
            margin: 0 auto;
            display: inline-block;
        }

        /* Legenda */
        .ranking-legenda {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .legenda-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #475569;
        }

        .legenda-cor {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
        }

        /* Streak colors */
        .streak-high {
            color: #f59e0b !important;
            font-weight: bold;
        }

        /* ===== √çCONES DO PERFIL - TAMANHO REDUZIDO (40x40) ===== */
        .icones-perfil-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .icone-perfil {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            border: 2px solid transparent;
        }

        .icone-perfil.pato {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #000;
            border-color: #d97706;
        }

        .icone-perfil.bola8 {
            background: linear-gradient(135deg, #2c3e50, #000000);
            color: white;
            border-color: #f1c40f;
        }

        .icone-perfil.bola9 {
            background: linear-gradient(135deg, #f1c40f, #f39c12);
            color: #000;
            border-color: #fff;
        }

        .icone-perfil.truco {
            background: linear-gradient(135deg, #27ae60, #16a085);
            color: #fff;
            border-color: #f1c40f;
        }

        .icone-perfil:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 6px 15px rgba(241, 196, 15, 0.5);
        }

        .icone-perfil.inativo {
            opacity: 0.3;
            filter: grayscale(80%);
            cursor: not-allowed;
        }

        .icone-perfil.inativo:hover {
            transform: none;
            box-shadow: none;
        }

        /* Modal de sele√ß√£o de liga - CORRIGIDO */
        .modal-select-liga {
            background: linear-gradient(135deg, #2c3e50, #1a2634);
            border-radius: 25px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            border: 3px solid #f1c40f;
            color: white;
            text-align: center;
        }

        .modal-select-liga h3 {
            color: #f1c40f;
            margin-bottom: 20px;
            font-size: 22px;
        }

        .modal-select-liga p {
            color: #bdc3c7;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .opcoes-liga {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin: 25px 0;
        }

        .opcao-liga {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 15px 5px;
            cursor: pointer;
            transition: 0.3s;
            border: 2px solid transparent;
        }

        .opcao-liga:hover {
            transform: scale(1.05);
            border-color: #f1c40f;
            background: rgba(241, 196, 15, 0.2);
        }

        .opcao-liga .icone-grande {
            font-size: 36px;
            margin-bottom: 8px;
        }

        .opcao-liga .nome-liga {
            font-size: 13px;
            font-weight: bold;
            color: white;
        }

        /* Estilos do Painel Master */
        .master-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            flex-wrap: wrap;
        }

        .master-tab {
            background: #2c3e50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 30px 30px 0 0;
            cursor: pointer;
            font-weight: bold;
            font-size: 12px;
            transition: 0.3s;
            opacity: 0.7;
        }

        .master-tab.active {
            background: #f1c40f;
            color: #000;
            opacity: 1;
            transform: translateY(-2px);
        }

        .master-panel {
            background: #1a2634;
            border-radius: 15px;
            padding: 20px;
            color: white;
            margin-top: 15px;
        }

        .search-box {
            background: #2c3e50;
            border: 1px solid #f1c40f;
            border-radius: 30px;
            padding: 8px 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }

        .search-box input {
            flex: 1;
            background: transparent;
            border: none;
            color: white;
            outline: none;
            font-size: 14px;
        }

        .search-box input::placeholder {
            color: #95a5a6;
        }

        .search-box button {
            background: #f1c40f;
            border: none;
            border-radius: 20px;
            padding: 5px 15px;
            font-weight: bold;
            cursor: pointer;
        }

        .master-table {
            width: 100%;
            border-collapse: collapse;
            background: #2c3e50;
            border-radius: 15px;
            overflow: hidden;
            font-size: 12px;
        }

        .master-table th {
            background: #000;
            color: #f1c40f;
            padding: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .master-table td {
            padding: 10px;
            border-bottom: 1px solid #405060;
        }

        .master-table tr:hover {
            background: #34495e;
        }

        .btn-ban {
            background: #c0392b;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }

        .btn-unban {
            background: #27ae60;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }

        .btn-edit {
            background: #2980b9;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            margin-right: 3px;
        }

        .btn-revert {
            background: #f39c12;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #2c3e50;
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            border: 3px solid #f1c40f;
        }

        .modal-content h3 {
            color: #f1c40f;
            margin-bottom: 20px;
            text-align: center;
        }

        .modal-content input, .modal-content select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #f1c40f;
            background: #34495e;
            color: white;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
        }

        .modal-confirm {
            background: #27ae60;
            color: white;
        }

        .modal-cancel {
            background: #c0392b;
            color: white;
        }

        .notificacao-item {
            background: #2c3e50;
            border-left: 4px solid #f1c40f;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            font-size: 12px;
        }

        .notificacao-item .vencedor {
            color: #27ae60;
            font-weight: bold;
        }

        .notificacao-item .perdedor {
            color: #c0392b;
            font-weight: bold;
        }

        .notificacao-item .tempo {
            color: #f1c40f;
            font-size: 10px;
            margin-top: 5px;
        }

        .badge {
            background: #f1c40f;
            color: #000;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            margin-left: 5px;
        }

        /* ===== MODAIS DE ESTAT√çSTICAS ===== */
        .estatisticas-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-content-estatisticas {
            background: linear-gradient(135deg, #2c3e50, #1a2634);
            border-radius: 25px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            border: 3px solid #f1c40f;
            color: white;
            position: relative;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f1c40f;
        }

        .modal-header h2 {
            color: #f1c40f;
            font-size: 24px;
            margin-top: 10px;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 28px;
            cursor: pointer;
            color: #f1c40f;
            transition: 0.3s;
        }

        .modal-close:hover {
            transform: scale(1.2);
            color: #e67e22;
        }

        .estatisticas-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .estatistica-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(241, 196, 15, 0.3);
        }

        .estatistica-card .valor {
            font-size: 24px;
            font-weight: bold;
            color: #f1c40f;
            margin: 5px 0;
        }

        .estatistica-card .rotulo {
            font-size: 11px;
            color: #bdc3c7;
            text-transform: uppercase;
        }

        .ranking-posicao {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 50px;
        }

        .ranking-posicao .posicao-numero {
            font-size: 32px;
            font-weight: 900;
            color: #f1c40f;
        }

        .ranking-posicao .posicao-label {
            font-size: 12px;
            color: #bdc3c7;
        }

        .streak-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            font-size: 18px;
        }

        .streak-info .fire {
            color: #f59e0b;
            font-size: 24px;
        }

        .btn-fechar-modal {
            background: #f1c40f;
            color: #000;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            margin: 20px auto 0;
            display: block;
            width: fit-content;
            transition: 0.3s;
        }

        .btn-fechar-modal:hover {
            background: #f39c12;
            transform: scale(1.05);
        }

        /* Formul√°rios responsivos */
        .form-group { 
            display: grid; 
            grid-template-columns: 140px 1fr; 
            margin-bottom: 15px; 
            align-items: center; 
            text-align: left; 
        }
        .form-group label { 
            font-weight: bold; 
            font-size: 13px; 
            color: #333; 
        }
        .form-group input, 
        .form-group select { 
            padding: 10px 12px; 
            border: 1px solid #ccc; 
            border-radius: 5px; 
            background: #f9f9f9; 
            font-size: 14px; 
            outline: none; 
            width: 100%;
        }
        .form-group small {
            font-size: 11px;
            color: #7f8c8d;
            margin-top: 3px;
            display: block;
        }
        .form-group input[type="checkbox"] {
            width: auto;
            margin-right: 5px;
        }
        .form-group a {
            color: #2980b9;
            text-decoration: none;
        }
        .form-group a:hover {
            text-decoration: underline;
        }
        .btn-submit { 
            background: linear-gradient(180deg, #3498db 0%, #2980b9 100%); 
            color: white; 
            border: none; 
            padding: 15px; 
            width: 80%; 
            border-radius: 30px; 
            font-weight: bold; 
            cursor: pointer; 
            margin: 20px auto 0; 
            display: block; 
        }

        /* Sidebar direita */
        .right-box { 
            background: white; 
            border-radius: 12px; 
            overflow: hidden; 
            margin-bottom: 15px; 
            color: #2c3e50; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.2); 
        }
        .right-box-title { 
            background: #2c3e50; 
            color: white; 
            padding: 8px; 
            font-size: 12px; 
            text-align: center; 
            font-weight: bold; 
            text-transform: uppercase; 
        }
        .right-box-content { 
            padding: 15px; 
            font-size: 12px; 
        }
        .login-input { 
            width: 100%; 
            padding: 10px; 
            margin-bottom: 10px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
        }
        .btn-login { 
            width: 100%; 
            padding: 10px; 
            background: #27ae60; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
            font-weight: bold; 
        }
        .profile-card { 
            text-align: center; 
        }
        .profile-avatar { 
            width: 60px; 
            height: 60px; 
            background: #34495e; 
            border-radius: 50%; 
            margin: 0 auto 10px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            font-size: 24px; 
            border: 2px solid #f1c40f; 
        }
        .profile-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 5px;
            margin: 15px 0;
        }
        .stat-item {
            background: #f0f0f0;
            padding: 5px;
            border-radius: 4px;
            font-size: 11px;
        }
        .btn-action { 
            width: 100%; 
            padding: 8px; 
            margin-top: 8px; 
            font-size: 11px; 
            border-radius: 4px; 
            border: none; 
            cursor: pointer; 
            font-weight: bold; 
        }
        .btn-join { background: #f1c40f; color: #000; }
        .btn-special { background: #8e44ad; color: #fff; }
        .btn-logout { background: #c0392b; color: #fff; }
        .footer-line { 
            padding: 15px; 
            text-align: center; 
            color: #7f8c8d; 
            font-size: 12px; 
        }

        /* ===== MEDIA QUERIES ===== */
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 180px 1fr;
                gap: 15px;
            }
            .sidebar-right {
                grid-column: span 2;
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }
            .logo-area h1 {
                font-size: 42px;
            }
            .pool-table-visual {
                width: 200px;
                height: 110px;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
                padding: 15px;
            }
            .logo-area h1 {
                font-size: 38px;
            }
            .logo-area p {
                font-size: 14px;
            }
            .pool-table-visual {
                margin-top: 15px;
                width: 180px;
                height: 100px;
            }
            .cue-stick {
                width: 120px;
                top: 40px;
            }
            .ball-8-top {
                width: 50px;
                height: 50px;
            }
            .ball-8-top .inner-circle {
                width: 22px;
                height: 22px;
                font-size: 14px;
            }
            
            .ranking-table-wrapper {
                display: none;
            }
            
            .ranking-cards-container {
                display: flex;
                flex-direction: column;
                gap: 12px;
                margin: 20px 0;
            }
            
            .ranking-card {
                background: white;
                border-radius: 16px;
                padding: 16px;
                display: flex;
                align-items: center;
                gap: 15px;
                box-shadow: 0 8px 20px rgba(0,0,0,0.06);
                border: 1px solid #e2e8f0;
                transition: 0.3s;
                position: relative;
                overflow: hidden;
            }
            
            .ranking-card:hover {
                transform: translateY(-3px);
                box-shadow: 0 12px 30px rgba(0,0,0,0.1);
            }
            
            .ranking-card::before {
                content: '';
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                width: 6px;
                background: linear-gradient(180deg, #94a3b8, #64748b);
            }
            
            .ranking-card.top-1::before {
                background: linear-gradient(180deg, #fbbf24, #f59e0b);
            }
            
            .ranking-card.top-2::before {
                background: linear-gradient(180deg, #94a3b8, #64748b);
            }
            
            .ranking-card.top-3::before {
                background: linear-gradient(180deg, #fca5a5, #ef4444);
            }
            
            .ranking-card-avatar {
                width: 50px;
                height: 50px;
                background: linear-gradient(135deg, #94a3b8, #64748b);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-size: 24px;
            }
            
            .ranking-card.top-1 .ranking-card-avatar {
                background: linear-gradient(135deg, #fbbf24, #f59e0b);
            }
            
            .ranking-card.top-2 .ranking-card-avatar {
                background: linear-gradient(135deg, #94a3b8, #64748b);
            }
            
            .ranking-card.top-3 .ranking-card-avatar {
                background: linear-gradient(135deg, #fca5a5, #ef4444);
            }
            
            .ranking-card-info {
                flex: 1;
            }
            
            .ranking-card-nome {
                font-weight: 700;
                font-size: 16px;
                color: #0f172a;
                margin-bottom: 4px;
            }
            
            .ranking-card-detalhes {
                display: flex;
                gap: 15px;
                font-size: 12px;
                color: #64748b;
            }
            
            .ranking-card-posicao {
                font-size: 20px;
                font-weight: 900;
                min-width: 40px;
                text-align: center;
                color: #f1c40f;
            }
            
            .ranking-card-pontos {
                font-weight: 700;
                color: #2980b9;
                font-size: 18px;
                min-width: 60px;
                text-align: right;
            }
            
            .ranking-card.vazio .ranking-card-avatar {
                background: linear-gradient(135deg, #cbd5e1, #94a3b8);
            }
            
            .ranking-card.vazio .ranking-card-pontos {
                color: #94a3b8;
            }
            
            .grid-how-works {
                gap: 10px;
            }
            .step-card {
                padding: 15px;
                min-height: 100px;
            }
            .step-card strong {
                font-size: 14px;
            }
            
            .info-bar {
                flex-direction: column;
                text-align: center;
            }
        }

        @media (max-width: 576px) {
            body {
                padding: 5px;
            }
            
            .main-content {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 10px;
            }
            
            .sidebar-left {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 8px;
            }
            
            .sidebar-right {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .btn-menu {
                padding: 10px;
                font-size: 10px;
                border-radius: 15px;
            }
            
            .center-panel {
                padding: 12px;
            }
            
            .section-title {
                font-size: 14px;
                padding: 10px;
            }
            
            .grid-how-works {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .ranking-options {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .rank-card {
                padding: 12px;
            }
            
            .rank-icon {
                width: 60px;
                height: 60px;
                font-size: 30px;
            }
            
            .form-group {
                grid-template-columns: 1fr;
                gap: 5px;
            }
            
            .form-group label {
                margin-bottom: 2px;
            }
            
            .form-group > div[style*="display: flex"] {
                flex-direction: row !important;
                flex-wrap: wrap;
            }
            
            #dia-nasc, #mes-nasc, #ano-nasc {
                min-width: calc(33.33% - 5px) !important;
                flex: 1 !important;
            }
            
            .form-group select {
                width: 100%;
            }
            
            .btn-submit {
                width: 100%;
                padding: 12px;
                font-size: 14px;
            }
            
            .tab-button {
                font-size: 11px;
                padding: 10px;
                min-width: 80px;
            }
            
            .profile-stats {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .stat-item {
                padding: 8px;
            }
            
            .ranking-card {
                padding: 12px;
                flex-wrap: wrap;
            }
            
            .ranking-card-avatar {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
            
            .ranking-card-nome {
                font-size: 14px;
            }
            
            .ranking-card-pontos {
                font-size: 16px;
            }
            
            .ranking-card-posicao {
                width: 100%;
                text-align: left;
                margin-bottom: 5px;
            }
            
            .pagination-container {
                gap: 10px;
            }
            
            .pagination-btn {
                padding: 8px 15px;
                font-size: 11px;
            }
            
            .pagination-info {
                padding: 6px 15px;
                font-size: 12px;
            }
            
            .master-table {
                font-size: 10px;
            }
            
            .master-table th, .master-table td {
                padding: 6px;
            }
            
            .btn-edit, .btn-ban, .btn-unban, .btn-revert {
                padding: 3px 6px;
                font-size: 9px;
            }
        }

        @media (max-width: 400px) {
            .logo-area h1 {
                font-size: 32px;
            }
            
            .logo-area p {
                font-size: 12px;
            }
            
            .sidebar-left {
                grid-template-columns: 1fr;
            }
            
            .btn-menu {
                font-size: 12px;
                padding: 12px;
            }
            
            .pool-table-visual {
                width: 150px;
                height: 85px;
            }
            
            .cue-stick {
                width: 100px;
                top: 35px;
            }
            
            #dia-nasc, #mes-nasc, #ano-nasc {
                min-width: 100% !important;
                margin-bottom: 5px;
            }
            
            .icones-perfil-container {
                gap: 5px;
            }
            
            .icone-perfil {
                width: 35px;
                height: 35px;
                font-size: 18px;
            }
        }

        .char-counter {
            font-size: 10px;
            color: #2980b9;
            display: block;
            margin-top: 3px;
        }
    </style>
</head>
<body>

<div class="container">
    <header class="header">
        <div class="logo-area">
            <h1>LSJO</h1>
            <p>Liga Supremos de Jogos Online</p>
            <span>Liderando a divers√£o desde 2026</span>
        </div>
        <div class="pool-table-visual">
            <div class="cue-stick"></div>
            <div class="ball-8-top"><div class="inner-circle">8</div></div>
        </div>
    </header>

    <div class="info-bar" id="relogio">
        <span>üìÖ Carregando data e hora...</span>
        <span class="total-jogadores" id="total-jogadores-info">üë• Total: 0 jogadores</span>
    </div>

    <div class="main-content">
        <aside class="sidebar-left">
            <button class="btn-menu" onclick="showSection('home')">üè† HOME</button>
            <button class="btn-menu btn-pato" id="nav-pato" onclick="showSection('notificar')">ü¶Ü NOTIFICAR</button>
            <button class="btn-menu btn-master-especial" id="nav-master" onclick="showSection('master')">üëë PAINEL MASTER</button>
            <button class="btn-menu btn-blue" onclick="showSection('rankings-hub')">üèÜ RANKINGS</button>
            <button class="btn-menu" id="nav-cadastro" onclick="showSection('cadastro')">üìù CADASTRO</button>
            <button class="btn-menu">üìú REGRAS</button>
            <button class="btn-menu">üìß CONTATO</button>
        </aside>

        <main class="center-panel">
            <section id="section-home">
                <div class="section-title" style="background: #2980b9;">üè† PAGINA INICIAL LSJO</div>
                <div class="grid-how-works">
                    <div class="step-card card-green"><strong>üìù 1. CADASTRE-SE</strong><p>Crie sua conta e receba seu ID exclusivo.</p></div>
                    <div class="step-card card-blue"><strong>üéÆ 2. JOGUE</strong><p>Desafie advers√°rios em nossos servidores parceiros.</p></div>
                    <div class="step-card card-orange"><strong>üì¢ 3. NOTIFIQUE</strong><p>Ao perder, envie o resultado para validar o ranking.</p></div>
                    <div class="step-card card-gold"><strong>üèÜ 4. RANKING</strong><p>Acompanhe sua posi√ß√£o e torne-se um Supremo.</p></div>
                </div>
            </section>

            <section id="section-notificar" style="display:none;">
                <div class="section-title" style="background: #e67e22;">üì¢ NOTIFICAR DERROTA</div>
                <div style="background: #f8f9fa; border: 2px solid #e67e22; border-radius: 15px; padding: 20px;">
                    <div class="form-group">
                        <label>Liga do Jogo:</label>
                        <select id="notif-liga">
                            <option value="BOLA 8">üé± BOLA 8</option>
                            <option value="BOLA 9">9Ô∏è‚É£ BOLA 9</option>
                            <option value="TRUCO">üÉè TRUCO</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ID do Vencedor:</label>
                        <input type="text" id="notif-venc" placeholder="Ex: 1001">
                    </div>
                    <div class="form-group">
                        <label>Qtd Derrotas:</label>
                        <select id="notif-qtd">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                        </select>
                    </div>
                    <button class="btn-submit" id="btn-enviar-notif" style="background: #e67e22;">CONFIRMAR DERROTA ü¶Ü</button>
                </div>
            </section>

            <section id="section-master" style="display:none;">
                <div class="section-title" style="background: #000; border: 1px solid #f1c40f; color: #f1c40f;">üëë SISTEMA DEUS - CONTROLE MASTER</div>
                
                <!-- Abas do Master -->
                <div class="master-tabs">
                    <button class="master-tab active" onclick="mudarMasterTab('usuarios')">üë• USU√ÅRIOS</button>
                    <button class="master-tab" onclick="mudarMasterTab('notificacoes')">üì¢ NOTIFICA√á√ïES (30min)</button>
                </div>
                
                <!-- Painel de Usu√°rios -->
                <div id="master-usuarios" class="master-panel">
                    <div class="search-box">
                        <input type="text" id="search-user" placeholder="Buscar por ID ou Nick..." onkeyup="filtrarUsuarios()">
                        <button>üîç</button>
                    </div>
                    
                    <div style="overflow-x: auto;">
                        <table class="master-table" id="tabela-usuarios">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>NICK</th>
                                    <th>SENHA</th>
                                    <th>PONTOS</th>
                                    <th>STATUS</th>
                                    <th>A√á√ïES</th>
                                </tr>
                            </thead>
                            <tbody id="lista-usuarios-master">
                                <!-- Ser√° preenchido via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Painel de Notifica√ß√µes (√∫ltimos 30min) -->
                <div id="master-notificacoes" class="master-panel" style="display: none;">
                    <h3 style="color: #f1c40f; margin-bottom: 15px;">üìã √öLTIMAS NOTIFICA√á√ïES (30 MINUTOS)</h3>
                    <div id="lista-notificacoes" style="max-height: 500px; overflow-y: auto;">
                        <!-- Ser√° preenchido via JS -->
                    </div>
                </div>
            </section>

            <section id="section-rankings-hub" style="display:none;">
                <div class="section-title" style="background: #34495e;">üèÜ SELECIONE O JOGO</div>
                <div class="ranking-options">
                    <div class="rank-card" onclick="abrirRanking('BOLA 8')">
                        <div class="rank-icon">üé±</div>
                        <h3>Bola 8</h3>
                    </div>
                    <div class="rank-card" onclick="abrirRanking('BOLA 9')">
                        <div class="rank-icon icon-9">9</div>
                        <h3>Bola 9</h3>
                    </div>
                    <div class="rank-card" onclick="abrirRanking('TRUCO')">
                        <div class="rank-icon">üÉè</div>
                        <h3>Truco</h3>
                    </div>
                </div>
            </section>

            <section id="section-ranking-view" style="display:none;">
                <div class="section-title" id="ranking-view-title" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    üèÜ RANKING BOLA 8
                </div>
                
                <div class="tab-container">
                    <button class="tab-button active" onclick="mudarAbaRanking('PONTOS', this)">
                        <span class="tab-icon">‚≠ê</span> PONTOS
                    </button>
                    <button class="tab-button" onclick="mudarAbaRanking('SEQU√äNCIA', this)">
                        <span class="tab-icon">üî•</span> STREAK
                    </button>
                    <button class="tab-button" onclick="mudarAbaRanking('APROVEITAMENTO', this)">
                        <span class="tab-icon">üìä</span> APROVEITAMENTO
                    </button>
                </div>
                
                <button class="btn-voltar" onclick="showSection('rankings-hub')">
                    <span class="seta">‚Üê</span> VOLTAR AOS JOGOS
                </button>
                
                <!-- Ranking Cards (Mobile) -->
                <div class="ranking-cards-container" id="ranking-cards">
                    <!-- Cards ser√£o gerados via JS -->
                </div>
                
                <!-- Ranking Table (Desktop) -->
                <div class="ranking-table-wrapper">
                    <table class="ranking-table-moderno">
                        <thead>
                            <tr>
                                <th>POSI√á√ÉO</th>
                                <th>JOGADOR</th>
                                <th>ID</th>
                                <th>PONTOS</th>
                                <th>V/D</th>
                                <th>STREAK</th>
                            </tr>
                        </thead>
                        <tbody id="corpo-tabela-dinamica">
                            <!-- Dados ser√£o inseridos via JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Mensagem de ranking vazio (ser√° mostrada via JS quando necess√°rio) -->
                <div id="empty-ranking-message" class="empty-ranking-message" style="display: none;">
                    <div class="icon">üèÜ</div>
                    <h3>Nenhum jogador cadastrado ainda</h3>
                    <p>Seja o primeiro a se cadastrar e aparecer no ranking!</p>
                    <button class="btn-menu btn-blue" onclick="showSection('cadastro')" style="width: auto; padding: 10px 30px; margin: 0 auto;">FAZER CADASTRO</button>
                </div>
                
                <!-- Pagina√ß√£o -->
                <div class="pagination-container" id="pagination">
                    <button class="pagination-btn" id="prev-page" onclick="mudarPagina('anterior')" disabled>
                        <span>‚Üê</span> ANTERIOR
                    </button>
                    <span class="pagination-info" id="page-info">P√°gina 1 de 1</span>
                    <button class="pagination-btn" id="next-page" onclick="mudarPagina('proxima')" disabled>
                        PR√ìXIMA <span>‚Üí</span>
                    </button>
                </div>
                
                <!-- Legenda -->
                <div class="ranking-legenda">
                    <div class="legenda-item">
                        <span class="legenda-cor" style="background: linear-gradient(135deg, #fbbf24, #f59e0b);"></span>
                        <span>TOP 3 - Elit√©rio Supremo</span>
                    </div>
                    <div class="legenda-item">
                        <span class="legenda-cor" style="background: linear-gradient(135deg, #60a5fa, #3b82f6);"></span>
                        <span>TOP 10 - Mestres da Bola</span>
                    </div>
                    <div class="legenda-item">
                        <span class="legenda-cor" style="background: linear-gradient(135deg, #34d399, #10b981);"></span>
                        <span>TOP 20 - Guerreiros</span>
                    </div>
                    <div class="legenda-item">
                        <span class="legenda-cor" style="background: #94a3b8;"></span>
                        <span>Vaga Dispon√≠vel</span>
                    </div>
                </div>
            </section>

            <section id="section-cadastro" style="display:none;">
                <div class="section-title" style="background: #27ae60;">üìù NOVO REGISTRO</div>
                <div style="max-width: 600px; margin: 0 auto;">
                    <div class="form-group">
                        <label>Nome de Usu√°rio*</label>
                        <div>
                            <input type="text" id="reg-nick" value="LSJO_" maxlength="15" oninput="validarPrefixo(this)" style="font-weight: bold; color: #2980b9;">
                            <span class="char-counter" id="contador">10 caracteres restantes</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Senha*</label>
                        <input type="password" id="reg-pass" placeholder="M√≠nimo 6 caracteres" minlength="6">
                    </div>
                    
                    <div class="form-group">
                        <label>Confirmar Senha*</label>
                        <input type="password" id="reg-pass-confirm" placeholder="Digite a senha novamente">
                    </div>
                    
                    <div class="form-group">
                        <label>Data de Nascimento*</label>
                        <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                            <select id="dia-nasc" style="flex:1; min-width: 70px;" required>
                                <option value="">Dia</option>
                            </select>
                            <select id="mes-nasc" style="flex:2; min-width: 100px;" required>
                                <option value="">M√™s</option>
                                <option value="1">Janeiro</option>
                                <option value="2">Fevereiro</option>
                                <option value="3">Mar√ßo</option>
                                <option value="4">Abril</option>
                                <option value="5">Maio</option>
                                <option value="6">Junho</option>
                                <option value="7">Julho</option>
                                <option value="8">Agosto</option>
                                <option value="9">Setembro</option>
                                <option value="10">Outubro</option>
                                <option value="11">Novembro</option>
                                <option value="12">Dezembro</option>
                            </select>
                            <select id="ano-nasc" style="flex:1; min-width: 80px;" required>
                                <option value="">Ano</option>
                            </select>
                        </div>
                        <small style="color: #666; display: block; margin-top: 5px;">Voc√™ deve ter pelo menos 13 anos</small>
                    </div>
                    
                    <div class="form-group">
                        <label>Email (opcional)</label>
                        <input type="email" id="reg-email" placeholder="seu@email.com">
                    </div>
                    
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox" id="termos" required>
                            <span style="font-size: 12px;">Li e aceito os <a href="#" style="color: #2980b9;">termos de uso</a></span>
                        </label>
                    </div>
                    
                    <button class="btn-submit" id="btn-cadastro-firebase">CRIAR MINHA CONTA</button>
                    
                    <div style="text-align: center; margin-top: 15px; font-size: 12px; color: #666;">
                        J√° tem uma conta? <a href="#" onclick="showSection('home'); document.getElementById('box-login').style.display='block';" style="color: #2980b9; text-decoration: none;">Fa√ßa login</a>
                    </div>
                </div>
            </section>
        </main>

        <aside class="sidebar-right">
            <div class="right-box" id="box-login">
                <div class="right-box-title">üîê ACESSO RESTRITO</div>
                <div class="right-box-content">
                    <input type="text" class="login-input" id="login-id" placeholder="ID de Acesso">
                    <input type="password" class="login-input" id="login-pass" placeholder="Senha">
                    <button class="btn-login" id="btn-login-firebase">ENTRAR</button>
                </div>
            </div>

            <!-- PERFIL CORRIGIDO - SEM MODAL AUTOM√ÅTICO -->
            <div class="right-box" id="box-perfil" style="display:none;">
                <div class="right-box-title">ü™™ PERFIL DO SUPREMO</div>
                <div class="right-box-content profile-card">
                    <div class="profile-avatar">üé±</div>
                    <span class="profile-name" id="user-name">LSJO_PLAYER</span>
                    <div class="profile-stats">
                        <div class="stat-item"><span>ID:</span> <strong id="user-id-card">0000</strong></div>
                        <div class="stat-item"><span>Pontos:</span> <strong id="user-pts-card">0</strong></div>
                        <div class="stat-item"><span>Status:</span> <strong style="color:green">Ativa</strong></div>
                    </div>
                    
                    <!-- √çCONES DAS LIGAS - APARECEM APENAS SE INSCRITO -->
                    <div class="icones-perfil-container" id="icones-ligas-container">
                        <!-- PATINHO (sempre vis√≠vel) -->
                        <div class="icone-perfil pato" onclick="showSection('notificar')" title="Notificar Derrota">
                            ü¶Ü
                        </div>
                        
                        <!-- √çCONES DAS LIGAS (ser√£o controlados por JS) -->
                        <div id="icone-bola8" class="icone-perfil bola8 inativo" onclick="abrirEstatisticasLiga('BOLA 8')" title="Bola 8 (N√£o inscrito)" style="display: none;">
                            üé±
                        </div>
                        
                        <div id="icone-bola9" class="icone-perfil bola9 inativo" onclick="abrirEstatisticasLiga('BOLA 9')" title="Bola 9 (N√£o inscrito)" style="display: none;">
                            9Ô∏è‚É£
                        </div>
                        
                        <div id="icone-truco" class="icone-perfil truco inativo" onclick="abrirEstatisticasLiga('TRUCO')" title="Truco (N√£o inscrito)" style="display: none;">
                            üÉè
                        </div>
                    </div>
                    
                    <button class="btn-action btn-join" onclick="abrirModalSelecionarLiga()">INSCREVER NA LIGA</button>
                    <button class="btn-action btn-special">MEMBRO ESPECIAL ‚≠ê</button>
                    <button class="btn-action btn-logout" onclick="fazerLogout()">DESLIGAR</button>
                </div>
            </div>

            <div class="right-box">
                <div class="right-box-title">üìä ESTAT√çSTICAS</div>
                <div class="right-box-content">
                    <div>Sistema: Soma Zero</div>
                    <div>Status: <span style="color:green">‚óè Online</span></div>
                    <div>Total de Vagas: <strong>40 por p√°gina</strong></div>
                </div>
            </div>
            <div class="right-box">
                <div class="right-box-title">üì¢ AVISOS</div>
                <div class="right-box-content">Notifica√ß√µes falsas resultam em banimento.</div>
            </div>
        </aside>
    </div>
    <footer class="footer-line">LSJO ¬© 2026 - Todos os direitos reservados</footer>
</div>

<!-- MODAL DE SELE√á√ÉO DE LIGA (s√≥ abre quando clicar no bot√£o) -->
<div id="modal-select-liga" class="modal">
    <div class="modal-select-liga">
        <h3>üéØ ESCOLHA UMA LIGA</h3>
        <p>Selecione qual liga voc√™ quer participar:</p>
        
        <div class="opcoes-liga">
            <div class="opcao-liga" onclick="inscreverNaLiga('BOLA 8')">
                <div class="icone-grande">üé±</div>
                <div class="nome-liga">BOLA 8</div>
            </div>
            <div class="opcao-liga" onclick="inscreverNaLiga('BOLA 9')">
                <div class="icone-grande">9Ô∏è‚É£</div>
                <div class="nome-liga">BOLA 9</div>
            </div>
            <div class="opcao-liga" onclick="inscreverNaLiga('TRUCO')">
                <div class="icone-grande">üÉè</div>
                <div class="nome-liga">TRUCO</div>
            </div>
        </div>
        
        <button class="btn-fechar-modal" onclick="fecharModal('modal-select-liga')" style="margin-top: 0;">CANCELAR</button>
    </div>
</div>

<!-- Modais do Master -->
<div id="modal-edit-id" class="modal">
    <div class="modal-content">
        <h3>‚úèÔ∏è ALTERAR ID</h3>
        <input type="text" id="edit-user-id" placeholder="ID atual" readonly>
        <input type="text" id="edit-new-id" placeholder="Novo ID (4 d√≠gitos)" maxlength="4">
        <div class="modal-buttons">
            <button class="modal-confirm" onclick="confirmarAlterarId()">CONFIRMAR</button>
            <button class="modal-cancel" onclick="fecharModal('modal-edit-id')">CANCELAR</button>
        </div>
    </div>
</div>

<div id="modal-revert-notif" class="modal">
    <div class="modal-content">
        <h3>‚Ü©Ô∏è REVERTER NOTIFICA√á√ÉO</h3>
        <p id="revert-info" style="color: white; margin-bottom: 15px;"></p>
        <div class="modal-buttons">
            <button class="modal-confirm" onclick="confirmarReverter()">REVERTER</button>
            <button class="modal-cancel" onclick="fecharModal('modal-revert-notif')">CANCELAR</button>
        </div>
    </div>
</div>

<!-- MODAIS DE ESTAT√çSTICAS DAS LIGAS -->
<!-- Modal Estat√≠sticas Bola 8 -->
<div id="modal-bola8" class="estatisticas-modal">
    <div class="modal-content-estatisticas">
        <span class="modal-close" onclick="fecharModalEstatisticas('modal-bola8')">&times;</span>
        <div class="modal-header">
            <div style="font-size: 48px;">üé±</div>
            <h2>BOLA 8</h2>
        </div>
        
        <div class="ranking-posicao">
            <span class="posicao-label">Ranking Geral:</span>
            <span class="posicao-numero" id="bola8-posicao">#0</span>
        </div>
        
        <div class="estatisticas-grid">
            <div class="estatistica-card">
                <div class="rotulo">PONTOS</div>
                <div class="valor" id="bola8-pontos">0</div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">V/D</div>
                <div class="valor" id="bola8-vd">0/0</div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">STREAK</div>
                <div class="valor streak-info">
                    <span class="fire">üî•</span>
                    <span id="bola8-streak">0</span>
                </div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">APROVEIT.</div>
                <div class="valor" id="bola8-aproveitamento">0%</div>
            </div>
        </div>
        
        <div class="ranking-posicao" style="background: rgba(241,196,15,0.1);">
            <span class="posicao-label">Ranking Aproveitamento:</span>
            <span class="posicao-numero" id="bola8-posicao-aproveitamento">#0</span>
        </div>
        
        <button class="btn-fechar-modal" onclick="fecharModalEstatisticas('modal-bola8')">FECHAR</button>
    </div>
</div>

<!-- Modal Estat√≠sticas Bola 9 -->
<div id="modal-bola9" class="estatisticas-modal">
    <div class="modal-content-estatisticas">
        <span class="modal-close" onclick="fecharModalEstatisticas('modal-bola9')">&times;</span>
        <div class="modal-header">
            <div style="font-size: 48px;">9Ô∏è‚É£</div>
            <h2>BOLA 9</h2>
        </div>
        
        <div class="ranking-posicao">
            <span class="posicao-label">Ranking Geral:</span>
            <span class="posicao-numero" id="bola9-posicao">#0</span>
        </div>
        
        <div class="estatisticas-grid">
            <div class="estatistica-card">
                <div class="rotulo">PONTOS</div>
                <div class="valor" id="bola9-pontos">0</div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">V/D</div>
                <div class="valor" id="bola9-vd">0/0</div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">STREAK</div>
                <div class="valor streak-info">
                    <span class="fire">üî•</span>
                    <span id="bola9-streak">0</span>
                </div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">APROVEIT.</div>
                <div class="valor" id="bola9-aproveitamento">0%</div>
            </div>
        </div>
        
        <div class="ranking-posicao" style="background: rgba(241,196,15,0.1);">
            <span class="posicao-label">Ranking Aproveitamento:</span>
            <span class="posicao-numero" id="bola9-posicao-aproveitamento">#0</span>
        </div>
        
        <button class="btn-fechar-modal" onclick="fecharModalEstatisticas('modal-bola9')">FECHAR</button>
    </div>
</div>

<!-- Modal Estat√≠sticas Truco -->
<div id="modal-truco" class="estatisticas-modal">
    <div class="modal-content-estatisticas">
        <span class="modal-close" onclick="fecharModalEstatisticas('modal-truco')">&times;</span>
        <div class="modal-header">
            <div style="font-size: 48px;">üÉè</div>
            <h2>TRUCO</h2>
        </div>
        
        <div class="ranking-posicao">
            <span class="posicao-label">Ranking Geral:</span>
            <span class="posicao-numero" id="truco-posicao">#0</span>
        </div>
        
        <div class="estatisticas-grid">
            <div class="estatistica-card">
                <div class="rotulo">PONTOS</div>
                <div class="valor" id="truco-pontos">0</div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">V/D</div>
                <div class="valor" id="truco-vd">0/0</div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">STREAK</div>
                <div class="valor streak-info">
                    <span class="fire">üî•</span>
                    <span id="truco-streak">0</span>
                </div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">APROVEIT.</div>
                <div class="valor" id="truco-aproveitamento">0%</div>
            </div>
        </div>
        
        <div class="ranking-posicao" style="background: rgba(241,196,15,0.1);">
            <span class="posicao-label">Ranking Aproveitamento:</span>
            <span class="posicao-numero" id="truco-posicao-aproveitamento">#0</span>
        </div>
        
        <button class="btn-fechar-modal" onclick="fecharModalEstatisticas('modal-truco')">FECHAR</button>
    </div>
</div>

<audio id="duckSound" src="https://www.soundjay.com/nature/sounds/duck-quack-1.mp3"></audio>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getDatabase, ref, set, get, child, onValue, update, remove, push } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

    // CONFIGURA√á√ÉO CORRIGIDA COM REGI√ÉO EUROPE-WEST1
    const firebaseConfig = {
        apiKey: "AIzaSyDez172nRfLpCffiEKRRtxMsVR0LL12sbE",
        authDomain: "lsjo-a5672.firebaseapp.com",
        projectId: "lsjo-a5672",
        databaseURL: "https://lsjo-a5672-default-rtdb.europe-west1.firebasedatabase.app/",
        appId: "1:251677846751:web:6eb9ebf1c1f6159b9a8d6a"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    let usuarioLogado = null;
    
    // Vari√°veis de pagina√ß√£o
    let paginaAtual = 1;
    const ITENS_POR_PAGINA = 40;
    let totalJogadores = 0;
    let todosJogadores = [];
    let rankingTipoAtual = 'BOLA 8';
    let tipoOrdenacaoAtual = 'PONTOS';
    
    // Vari√°veis para o modal
    let usuarioSelecionado = null;
    let notificacaoSelecionada = null;

    // Gerar op√ß√µes de data
    function gerarOpcoesData() {
        const diaSelect = document.getElementById('dia-nasc');
        const anoSelect = document.getElementById('ano-nasc');
        
        if (diaSelect) {
            diaSelect.innerHTML = '<option value="">Dia</option>';
            for (let i = 1; i <= 31; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i.toString().padStart(2, '0');
                diaSelect.appendChild(option);
            }
        }
        
        if (anoSelect) {
            anoSelect.innerHTML = '<option value="">Ano</option>';
            const anoAtual = new Date().getFullYear();
            const anoMinimo = anoAtual - 100;
            const anoMaximo = anoAtual - 13;
            
            for (let i = anoMaximo; i >= anoMinimo; i--) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                anoSelect.appendChild(option);
            }
        }
    }

    // Fun√ß√£o para calcular streak baseado no hist√≥rico
    function calcularStreak(jogador) {
        if (!jogador.historico || jogador.historico.length === 0) {
            return 0;
        }
        
        const ultimasPartidas = jogador.historico.slice(-10);
        let streak = 0;
        
        for (let i = ultimasPartidas.length - 1; i >= 0; i--) {
            if (ultimasPartidas[i].resultado === 'vitoria') {
                streak++;
            } else {
                break;
            }
        }
        
        return streak;
    }

    // Fun√ß√£o para calcular aproveitamento
    function calcularAproveitamento(jogador) {
        const vitorias = jogador.v || 0;
        const derrotas = jogador.d || 0;
        const totalJogos = vitorias + derrotas;
        
        if (totalJogos === 0) return 0;
        return Math.round((vitorias / totalJogos) * 100);
    }

    // CADASTRO
    document.getElementById('btn-cadastro-firebase').onclick = async () => {
        const nick = document.getElementById('reg-nick').value;
        const pass = document.getElementById('reg-pass').value;
        const passConfirm = document.getElementById('reg-pass-confirm')?.value;
        const dia = document.getElementById('dia-nasc')?.value;
        const mes = document.getElementById('mes-nasc')?.value;
        const ano = document.getElementById('ano-nasc')?.value;
        const termos = document.getElementById('termos')?.checked;
        
        if (nick === "LSJO_" || nick.length < 6) { 
            alert("Escolha um nome com pelo menos 6 caracteres!"); 
            return; 
        }
        
        if (pass.length < 6) {
            alert("A senha deve ter no m√≠nimo 6 caracteres!");
            return;
        }
        
        if (pass !== passConfirm) {
            alert("As senhas n√£o conferem!");
            return;
        }
        
        if (!dia || !mes || !ano) {
            alert("Por favor, preencha sua data de nascimento completa!");
            return;
        }
        
        if (!termos) {
            alert("Voc√™ precisa aceitar os termos de uso!");
            return;
        }
        
        // Validar idade m√≠nima (13 anos)
        const dataNasc = new Date(ano, mes - 1, dia);
        const hoje = new Date();
        let idade = hoje.getFullYear() - dataNasc.getFullYear();
        const mesDiff = hoje.getMonth() - dataNasc.getMonth();
        
        if (mesDiff < 0 || (mesDiff === 0 && hoje.getDate() < dataNasc.getDate())) {
            idade--;
        }
        
        if (idade < 13) {
            alert("Voc√™ deve ter pelo menos 13 anos para se cadastrar!");
            return;
        }
        
        const id = Math.floor(1000 + Math.random() * 9000).toString();
        
        try {
            await set(ref(db, 'usuarios/' + id), {
                nickname: nick, 
                senha: pass, 
                id: id, 
                pontos: 0,
                v: 0, 
                d: 0,
                status: 'ativo',
                banido: false,
                historico: [], // Inicializa hist√≥rico vazio
                dataNasc: `${dia}/${mes}/${ano}`,
                email: document.getElementById('reg-email')?.value || '',
                dataCadastro: new Date().toISOString()
            });
            
            alert(`‚úÖ CONTA CRIADA COM SUCESSO!\n\nUsu√°rio: ${nick}\nID de Acesso: ${id}\n\nGuarde seu ID com seguran√ßa!`);
            showSection('home');
        } catch (error) {
            alert("Erro ao criar conta: " + error.message);
        }
    };

    // LOGIN
    document.getElementById('btn-login-firebase').onclick = async () => {
        const id = document.getElementById('login-id').value;
        const pass = document.getElementById('login-pass').value;

        if(id === "0001" && pass === "20042018") {
            document.getElementById('nav-master').style.display = 'block';
            entrarNoPerfil({nickname: "LSJO_MASTER", id: "0001", pontos: "0", status: 'ativo'});
            return;
        }

        const dbRef = ref(db);
        const snap = await get(child(dbRef, `usuarios/${id}`));
        if (snap.exists() && snap.val().senha === pass) {
            if (snap.val().banido) {
                alert("‚ùå Esta conta est√° banida!");
                return;
            }
            usuarioLogado = snap.val();
            entrarNoPerfil(usuarioLogado);
        } else {
            alert("ID ou Senha incorretos!");
        }
    };

    // Fun√ß√£o para entrar no perfil
    function entrarNoPerfil(user) {
        usuarioLogado = user;
        document.getElementById('user-name').innerText = user.nickname;
        document.getElementById('user-id-card').innerText = user.id;
        document.getElementById('user-pts-card').innerText = user.pontos || 0;
        document.getElementById('box-login').style.display = 'none';
        document.getElementById('box-perfil').style.display = 'block';
        document.getElementById('nav-pato').style.display = 'block';
        document.getElementById('nav-cadastro').style.display = 'none';
        
        // Atualizar √≠cones das ligas
        atualizarIconesLigas();
    }

    // ===== FUN√á√ïES DAS LIGAS =====
    
    // Abrir modal para selecionar liga (s√≥ quando clicar no bot√£o)
    window.abrirModalSelecionarLiga = () => {
        if (!usuarioLogado) {
            alert("Fa√ßa login primeiro!");
            return;
        }
        document.getElementById('modal-select-liga').style.display = 'flex';
    };

    // Inscrever na liga selecionada
    window.inscreverNaLiga = async (liga) => {
        if (!usuarioLogado) {
            alert("Fa√ßa login primeiro!");
            return;
        }
        
        // Verificar se j√° est√° inscrito
        const inscricaoRef = ref(db, `ligas/${liga}/inscritos/${usuarioLogado.id}`);
        const snap = await get(inscricaoRef);
        
        if (snap.exists()) {
            alert(`Voc√™ j√° est√° inscrito na liga ${liga}!`);
            fecharModal('modal-select-liga');
            return;
        }
        
        // Inscrever na liga
        await set(ref(db, `ligas/${liga}/inscritos/${usuarioLogado.id}`), {
            id: usuarioLogado.id,
            nickname: usuarioLogado.nickname,
            dataInscricao: Date.now()
        });
        
        // Inicializar estat√≠sticas
        await set(ref(db, `ligas/${liga}/estatisticas/${usuarioLogado.id}`), {
            pontos: 0,
            vitorias: 0,
            derrotas: 0
        });
        
        alert(`‚úÖ Inscrito na liga ${liga} com sucesso!`);
        fecharModal('modal-select-liga');
        atualizarIconesLigas();
    };

    // Abrir estat√≠sticas da liga
    window.abrirEstatisticasLiga = async (liga) => {
        if (!usuarioLogado) {
            alert("Fa√ßa login primeiro!");
            return;
        }
        
        // Verificar se o usu√°rio est√° inscrito na liga
        const inscricaoRef = ref(db, `ligas/${liga}/inscritos/${usuarioLogado.id}`);
        const snap = await get(inscricaoRef);
        
        if (!snap.exists()) {
            alert(`Voc√™ n√£o est√° inscrito na liga ${liga}!`);
            return;
        }
        
        // Buscar estat√≠sticas da liga
        const estatisticasRef = ref(db, `ligas/${liga}/estatisticas/${usuarioLogado.id}`);
        const statsSnap = await get(estatisticasRef);
        const stats = statsSnap.val() || {
            pontos: 0,
            vitorias: 0,
            derrotas: 0
        };
        
        // Buscar todos os jogadores da liga para calcular rankings
        const rankingRef = ref(db, `ligas/${liga}/estatisticas`);
        const rankingSnap = await get(rankingRef);
        const rankingData = rankingSnap.val() || {};
        
        // Calcular posi√ß√£o no ranking geral
        const rankingGeral = Object.entries(rankingData)
            .map(([id, data]) => ({ id, pontos: data.pontos || 0, vitorias: data.vitorias || 0, derrotas: data.derrotas || 0 }))
            .sort((a, b) => b.pontos - a.pontos);
        
        const posicaoGeral = rankingGeral.findIndex(j => j.id === usuarioLogado.id) + 1;
        
        // Calcular ranking por aproveitamento
        const rankingAproveitamento = Object.entries(rankingData)
            .map(([id, data]) => {
                const vitorias = data.vitorias || 0;
                const derrotas = data.derrotas || 0;
                const total = vitorias + derrotas;
                const aproveitamento = total > 0 ? (vitorias / total) * 100 : 0;
                return { id, aproveitamento, vitorias, derrotas };
            })
            .sort((a, b) => b.aproveitamento - a.aproveitamento);
        
        const posicaoAproveitamento = rankingAproveitamento.findIndex(j => j.id === usuarioLogado.id) + 1;
        
        // Calcular streak (√∫ltimas partidas na liga)
        const historicoRef = ref(db, `usuarios/${usuarioLogado.id}/historico`);
        const historicoSnap = await get(historicoRef);
        const historico = historicoSnap.val() || [];
        const historicoLiga = historico.filter(h => h.liga === liga);
        const ultimas5 = historicoLiga.slice(-5);
        let streak = 0;
        for (let i = ultimas5.length - 1; i >= 0; i--) {
            if (ultimas5[i].resultado === 'vitoria') streak++;
            else break;
        }
        
        // Calcular aproveitamento
        const vitorias = stats.vitorias || 0;
        const derrotas = stats.derrotas || 0;
        const total = vitorias + derrotas;
        const aproveitamento = total > 0 ? Math.round((vitorias / total) * 100) : 0;
        
        // Atualizar modal com os dados
        const modalId = liga === 'BOLA 8' ? 'modal-bola8' : (liga === 'BOLA 9' ? 'modal-bola9' : 'modal-truco');
        const prefixo = liga === 'BOLA 8' ? 'bola8' : (liga === 'BOLA 9' ? 'bola9' : 'truco');
        
        document.getElementById(`${prefixo}-posicao`).innerText = `#${posicaoGeral || 0}`;
        document.getElementById(`${prefixo}-pontos`).innerText = stats.pontos || 0;
        document.getElementById(`${prefixo}-vd`).innerText = `${stats.vitorias || 0}/${stats.derrotas || 0}`;
        document.getElementById(`${prefixo}-streak`).innerText = streak;
        document.getElementById(`${prefixo}-aproveitamento`).innerText = `${aproveitamento}%`;
        document.getElementById(`${prefixo}-posicao-aproveitamento`).innerText = `#${posicaoAproveitamento || 0}`;
        
        // Mostrar modal
        document.getElementById(modalId).style.display = 'flex';
    };

    // Fechar modal de estat√≠sticas
    window.fecharModalEstatisticas = (modalId) => {
        document.getElementById(modalId).style.display = 'none';
    };

    // Atualizar √≠cones das ligas no perfil
    async function atualizarIconesLigas() {
        if (!usuarioLogado) return;
        
        const ligas = ['BOLA 8', 'BOLA 9', 'TRUCO'];
        const icones = {
            'BOLA 8': 'icone-bola8',
            'BOLA 9': 'icone-bola9',
            'TRUCO': 'icone-truco'
        };
        
        for (const liga of ligas) {
            const iconeId = icones[liga];
            const icone = document.getElementById(iconeId);
            
            // Verificar se est√° inscrito
            const inscricaoRef = ref(db, `ligas/${liga}/inscritos/${usuarioLogado.id}`);
            const snap = await get(inscricaoRef);
            
            if (snap.exists()) {
                icone.style.display = 'flex';
                icone.classList.remove('inativo');
                icone.title = `${liga} (Clique para ver estat√≠sticas)`;
            } else {
                icone.style.display = 'none'; // S√≥ aparece se estiver inscrito
            }
        }
    }

    // RANKING COM PAGINA√á√ÉO
    window.abrirRanking = (tipo) => {
        rankingTipoAtual = tipo;
        showSection('ranking-view');
        document.getElementById('ranking-view-title').innerHTML = `üèÜ RANKING ${tipo}`;
        paginaAtual = 1;
        tipoOrdenacaoAtual = 'PONTOS';
        
        // Resetar abas
        document.querySelectorAll('.tab-button').forEach((btn, index) => {
            if (index === 0) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });
        
        const usuariosRef = ref(db, 'usuarios');
        onValue(usuariosRef, (snapshot) => {
            const data = snapshot.val();
            todosJogadores = [];
            
            if(data) {
                todosJogadores = Object.values(data)
                    .filter(u => u.id !== "0001" && !u.banido)
                    .map(jogador => {
                        if (!jogador.historico) {
                            // Criar hist√≥rico baseado nas vit√≥rias/derrotas
                            const historico = [];
                            const totalVitorias = jogador.v || 0;
                            const totalDerrotas = jogador.d || 0;
                            
                            for (let i = 0; i < totalVitorias; i++) {
                                historico.push({ resultado: 'vitoria' });
                            }
                            for (let i = 0; i < totalDerrotas; i++) {
                                historico.push({ resultado: 'derrota' });
                            }
                            return { ...jogador, historico };
                        }
                        return jogador;
                    });
            }
            
            totalJogadores = todosJogadores.length;
            document.getElementById('total-jogadores-info').innerHTML = `üë• Total: ${totalJogadores} jogadores`;
            
            atualizarPaginacao();
            renderizarPaginaAtual('PONTOS');
        });
    };

    function renderizarPaginaAtual(tipoOrdenacao = tipoOrdenacaoAtual) {
        const corpo = document.getElementById('corpo-tabela-dinamica');
        const cardsContainer = document.getElementById('ranking-cards');
        const emptyMessage = document.getElementById('empty-ranking-message');
        
        if (!corpo || !cardsContainer) return;
        
        corpo.innerHTML = "";
        cardsContainer.innerHTML = "";
        
        // Calcular streak e aproveitamento para todos os jogadores
        const jogadoresComMetricas = todosJogadores.map(jogador => ({
            ...jogador,
            streak: calcularStreak(jogador),
            aproveitamento: calcularAproveitamento(jogador)
        }));
        
        // Ordenar baseado no tipo selecionado
        let jogadoresOrdenados = [...jogadoresComMetricas];
        
        switch(tipoOrdenacao) {
            case 'PONTOS':
                jogadoresOrdenados.sort((a, b) => (b.pontos || 0) - (a.pontos || 0));
                break;
            case 'SEQU√äNCIA':
                jogadoresOrdenados.sort((a, b) => b.streak - a.streak);
                break;
            case 'APROVEITAMENTO':
                jogadoresOrdenados.sort((a, b) => b.aproveitamento - a.aproveitamento);
                break;
        }
        
        // Se n√£o h√° jogadores, mostrar mensagem vazia
        if (todosJogadores.length === 0) {
            emptyMessage.style.display = 'block';
            document.getElementById('pagination').style.display = 'none';
            return;
        } else {
            emptyMessage.style.display = 'none';
            document.getElementById('pagination').style.display = 'flex';
        }
        
        // Calcular itens da p√°gina atual
        const inicio = (paginaAtual - 1) * ITENS_POR_PAGINA;
        const fim = inicio + ITENS_POR_PAGINA;
        const jogadoresPagina = jogadoresOrdenados.slice(inicio, fim);
        
        // Renderizar jogadores reais
        jogadoresPagina.forEach((jogador, index) => {
            const posicaoGlobal = inicio + index + 1;
            const classeLinha = posicaoGlobal === 1 ? 'top-1' : (posicaoGlobal === 2 ? 'top-2' : (posicaoGlobal === 3 ? 'top-3' : ''));
            const avatar = ["üé±", "üî•", "‚ö°", "üëë", "‚≠ê"][index % 5];
            const streakClass = jogador.streak > 5 ? 'streak-high' : '';
            
            let valorColuna;
            if (tipoOrdenacao === 'PONTOS') {
                valorColuna = `${jogador.pontos || 0} pts`;
            } else if (tipoOrdenacao === 'SEQU√äNCIA') {
                valorColuna = `üî• ${jogador.streak}`;
            } else {
                valorColuna = `${jogador.aproveitamento}%`;
            }
            
            corpo.innerHTML += `
                <tr class="${classeLinha}">
                    <td><strong>${posicaoGlobal}¬∫</strong></td>
                    <td>${jogador.nickname}</td>
                    <td>${jogador.id}</td>
                    <td><strong style="color: #2980b9;">${valorColuna}</strong></td>
                    <td>${jogador.v || 0}/${jogador.d || 0}</td>
                    <td>
                        <span style="display: flex; align-items: center; gap: 5px;">
                            <span class="${streakClass}">üî•</span>
                            <span class="${streakClass}">${jogador.streak}</span>
                        </span>
                    </td>
                </tr>
            `;
            
            // Cards para mobile
            cardsContainer.innerHTML += `
                <div class="ranking-card ${classeLinha}">
                    <div class="ranking-card-avatar">${avatar}</div>
                    <div class="ranking-card-info">
                        <div class="ranking-card-nome">${jogador.nickname}</div>
                        <div class="ranking-card-detalhes">
                            <span>ID: ${jogador.id}</span>
                            <span>${jogador.v || 0}V / ${jogador.d || 0}D</span>
                        </div>
                    </div>
                    <div class="ranking-card-posicao">${posicaoGlobal}¬∫</div>
                    <div class="ranking-card-pontos">${valorColuna}</div>
                </div>
            `;
        });
        
        // Preencher vagas restantes na p√°gina
        const vagasRestantes = ITENS_POR_PAGINA - jogadoresPagina.length;
        for (let i = 0; i < vagasRestantes; i++) {
            const posicaoVaga = inicio + jogadoresPagina.length + i + 1;
            const avatar = ["üé±", "üî•", "‚ö°", "üëë", "‚≠ê"][(jogadoresPagina.length + i) % 5];
            
            corpo.innerHTML += `
                <tr class="slot-vazio">
                    <td><strong>${posicaoVaga}¬∫</strong></td>
                    <td>--- VAGA DISPON√çVEL ---</td>
                    <td>-----</td>
                    <td><strong style="color: #94a3b8;">0</strong></td>
                    <td>0/0</td>
                    <td><span style="color: #94a3b8;">üî• 0</span></td>
                </tr>
            `;
            
            cardsContainer.innerHTML += `
                <div class="ranking-card vazio">
                    <div class="ranking-card-avatar">${avatar}</div>
                    <div class="ranking-card-info">
                        <div class="ranking-card-nome">--- VAGA DISPON√çVEL ---</div>
                        <div class="ranking-card-detalhes">
                            <span>Aguardando Jogador</span>
                        </div>
                    </div>
                    <div class="ranking-card-posicao">${posicaoVaga}¬∫</div>
                    <div class="ranking-card-pontos">0</div>
                </div>
            `;
        }
    }

    function atualizarPaginacao() {
        const totalPaginas = Math.max(1, Math.ceil(Math.max(totalJogadores, 1) / ITENS_POR_PAGINA));
        document.getElementById('page-info').innerHTML = `P√°gina ${paginaAtual} de ${totalPaginas}`;
        
        document.getElementById('prev-page').disabled = paginaAtual === 1;
        document.getElementById('next-page').disabled = paginaAtual === totalPaginas;
    }

    window.mudarPagina = (direcao) => {
        if (direcao === 'anterior' && paginaAtual > 1) {
            paginaAtual--;
        } else if (direcao === 'proxima') {
            const totalPaginas = Math.max(1, Math.ceil(Math.max(totalJogadores, 1) / ITENS_POR_PAGINA));
            if (paginaAtual < totalPaginas) {
                paginaAtual++;
            }
        }
        atualizarPaginacao();
        renderizarPaginaAtual(tipoOrdenacaoAtual);
    };

    window.mudarAbaRanking = (tipo, btn) => {
        document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        tipoOrdenacaoAtual = tipo;
        paginaAtual = 1;
        renderizarPaginaAtual(tipo);
    };

    // NOTIFICAR DERROTA - AGORA COM LIGA ESPEC√çFICA
    document.getElementById('btn-enviar-notif').onclick = async () => {
        const liga = document.getElementById('notif-liga').value;
        const idVenc = document.getElementById('notif-venc').value;
        const qtd = parseInt(document.getElementById('notif-qtd').value);
        const agora = Date.now();

        if(!usuarioLogado) {
            alert("Voc√™ precisa estar logado!");
            return;
        }
        if(idVenc === usuarioLogado.id) {
            alert("Voc√™ n√£o pode notificar derrota para si mesmo!");
            return;
        }
        
        const snapV = await get(child(ref(db), `usuarios/${idVenc}`));
        if(!snapV.exists()) {
            alert("Vencedor n√£o existe!");
            return;
        }
        
        if (snapV.val().banido) {
            alert("Vencedor est√° banido!");
            return;
        }

        const travaRef = ref(db, `travas/${usuarioLogado.id}_vs_${idVenc}`);
        const snapT = await get(travaRef);
        let count = 0;
        if(snapT.exists() && (agora - snapT.val().timestamp < 12*60*60*1000)) {
            count = snapT.val().quantidade;
        }

        if(count + qtd > 7) {
            alert("Limite de 7 derrotas por 12h atingido!");
            return;
        }

        // Atualizar pontos apenas na liga espec√≠fica
        const pontosPerdidos = qtd * 2;
        const pontosGanhos = qtd * 2;
        
        // Atualizar no perfil geral
        await update(ref(db, `usuarios/${usuarioLogado.id}`), { 
            pontos: (usuarioLogado.pontos || 0) - pontosPerdidos, 
            d: (usuarioLogado.d || 0) + qtd 
        });
        
        await update(ref(db, `usuarios/${idVenc}`), { 
            pontos: (snapV.val().pontos || 0) + pontosGanhos, 
            v: (snapV.val().v || 0) + qtd 
        });
        
        // Atualizar estat√≠sticas da liga
        const statsPerdedorRef = ref(db, `ligas/${liga}/estatisticas/${usuarioLogado.id}`);
        const statsPerdedorSnap = await get(statsPerdedorRef);
        const statsPerdedor = statsPerdedorSnap.val() || { pontos: 0, vitorias: 0, derrotas: 0 };
        
        await set(statsPerdedorRef, {
            pontos: (statsPerdedor.pontos || 0) - pontosPerdidos,
            vitorias: statsPerdedor.vitorias || 0,
            derrotas: (statsPerdedor.derrotas || 0) + qtd
        });
        
        const statsVencedorRef = ref(db, `ligas/${liga}/estatisticas/${idVenc}`);
        const statsVencedorSnap = await get(statsVencedorRef);
        const statsVencedor = statsVencedorSnap.val() || { pontos: 0, vitorias: 0, derrotas: 0 };
        
        await set(statsVencedorRef, {
            pontos: (statsVencedor.pontos || 0) + pontosGanhos,
            vitorias: (statsVencedor.vitorias || 0) + qtd,
            derrotas: statsVencedor.derrotas || 0
        });
        
        // Atualizar hist√≥rico
        const perdedorHist = [...(usuarioLogado.historico || [])];
        const vencedorHist = [...(snapV.val().historico || [])];
        
        for (let i = 0; i < qtd; i++) {
            perdedorHist.push({ resultado: 'derrota', data: agora, liga: liga, vencedorId: idVenc });
            vencedorHist.push({ resultado: 'vitoria', data: agora, liga: liga, perdedorId: usuarioLogado.id });
        }
        
        await update(ref(db, `usuarios/${usuarioLogado.id}`), { historico: perdedorHist });
        await update(ref(db, `usuarios/${idVenc}`), { historico: vencedorHist });
        
        // Registrar notifica√ß√£o para o master
        const notifRef = ref(db, 'notificacoes');
        await push(notifRef, {
            liga: liga,
            vencedorId: idVenc,
            vencedorNome: snapV.val().nickname,
            perdedorId: usuarioLogado.id,
            perdedorNome: usuarioLogado.nickname,
            quantidade: qtd,
            pontosGanhos: pontosGanhos,
            pontosPerdidos: pontosPerdidos,
            timestamp: agora
        });
        
        await set(travaRef, { quantidade: count + qtd, timestamp: agora });

        document.getElementById('duckSound').play();
        alert(`ü¶Ü Derrota Notificada na liga ${liga} com sucesso!`);
        
        // Atualizar √≠cones das ligas
        atualizarIconesLigas();
        location.reload();
    };

    // ===== FUN√á√ïES DO PAINEL MASTER =====
    
    window.mudarMasterTab = (tab) => {
        // Atualizar abas
        document.querySelectorAll('.master-tab').forEach(t => t.classList.remove('active'));
        event.target.classList.add('active');
        
        // Mostrar painel correspondente
        if (tab === 'usuarios') {
            document.getElementById('master-usuarios').style.display = 'block';
            document.getElementById('master-notificacoes').style.display = 'none';
            carregarUsuariosMaster();
        } else {
            document.getElementById('master-usuarios').style.display = 'none';
            document.getElementById('master-notificacoes').style.display = 'block';
            carregarNotificacoes();
        }
    };

    // Carregar usu√°rios no painel master
    function carregarUsuariosMaster() {
        const usuariosRef = ref(db, 'usuarios');
        onValue(usuariosRef, (snapshot) => {
            const data = snapshot.val();
            const listaMaster = document.getElementById('lista-usuarios-master');
            if(!listaMaster) return;
            listaMaster.innerHTML = "";
            
            if(data) {
                Object.values(data).forEach(u => {
                    if(u.id !== "0001") {
                        const status = u.banido ? '<span style="color: #c0392b;">üî¥ BANIDO</span>' : '<span style="color: #27ae60;">üü¢ ATIVO</span>';
                        const acoes = u.banido ? 
                            `<button class="btn-unban" onclick="desbanirUsuario('${u.id}')">DESBANIR</button>` :
                            `<button class="btn-edit" onclick="abrirModalEditarId('${u.id}')">‚úèÔ∏è ID</button>
                             <button class="btn-ban" onclick="banirUsuario('${u.id}')">üö´ BANIR</button>`;
                        
                        listaMaster.innerHTML += `<tr>
                            <td><strong>${u.id}</strong></td>
                            <td>${u.nickname}</td>
                            <td>${u.senha}</td>
                            <td>${u.pontos || 0}</td>
                            <td>${status}</td>
                            <td>${acoes}</td>
                        </tr>`;
                    }
                });
            }
        });
    }

    // Carregar notifica√ß√µes dos √∫ltimos 30 minutos
    async function carregarNotificacoes() {
        const notifRef = ref(db, 'notificacoes');
        const snapshot = await get(notifRef);
        const data = snapshot.val();
        const listaNotif = document.getElementById('lista-notificacoes');
        
        if (!listaNotif) return;
        listaNotif.innerHTML = "";
        
        const agora = Date.now();
        const meiaHora = 30 * 60 * 1000; // 30 minutos em ms
        
        if (data) {
            const notificacoes = Object.entries(data)
                .map(([key, value]) => ({ id: key, ...value }))
                .filter(n => (agora - n.timestamp) <= meiaHora)
                .sort((a, b) => b.timestamp - a.timestamp);
            
            if (notificacoes.length === 0) {
                listaNotif.innerHTML = '<div style="text-align: center; padding: 30px; color: #95a5a6;">üì≠ Nenhuma notifica√ß√£o nos √∫ltimos 30 minutos</div>';
                return;
            }
            
            notificacoes.forEach(notif => {
                const dataNotif = new Date(notif.timestamp).toLocaleString('pt-BR');
                const tempoAtras = Math.round((agora - notif.timestamp) / 60000); // minutos
                
                listaNotif.innerHTML += `
                    <div class="notificacao-item">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <span class="badge">${notif.liga}</span>
                                <strong class="vencedor">${notif.vencedorNome}</strong> üèÜ vs 
                                <strong class="perdedor">${notif.perdedorNome}</strong>
                            </div>
                            <button class="btn-revert" onclick="abrirModalReverter('${notif.id}', '${notif.vencedorId}', '${notif.perdedorId}', ${notif.quantidade}, ${notif.pontosGanhos})">‚Ü©Ô∏è REVERTER</button>
                        </div>
                        <div style="margin-top: 5px; color: #bdc3c7;">
                            ${notif.quantidade}x derrotas | +${notif.pontosGanhos} pts / -${notif.pontosPerdidos} pts
                        </div>
                        <div class="tempo">‚è±Ô∏è ${dataNotif} (h√° ${tempoAtras} min)</div>
                    </div>
                `;
            });
        } else {
            listaNotif.innerHTML = '<div style="text-align: center; padding: 30px; color: #95a5a6;">üì≠ Nenhuma notifica√ß√£o encontrada</div>';
        }
    }

    // Fun√ß√µes do Master
    window.banirUsuario = async (id) => {
        if(confirm(`‚ö†Ô∏è Tem certeza que deseja BANIR o ID ${id}?`)) {
            await update(ref(db, `usuarios/${id}`), { 
                banido: true,
                status: 'banido'
            });
            alert(`‚úÖ Usu√°rio ${id} banido com sucesso!`);
            carregarUsuariosMaster();
        }
    };

    window.desbanirUsuario = async (id) => {
        if(confirm(`‚ö†Ô∏è Tem certeza que deseja DESBANIR o ID ${id}?`)) {
            await update(ref(db, `usuarios/${id}`), { 
                banido: false,
                status: 'ativo'
            });
            alert(`‚úÖ Usu√°rio ${id} desbanido com sucesso!`);
            carregarUsuariosMaster();
        }
    };

    window.abrirModalEditarId = (id) => {
        usuarioSelecionado = id;
        document.getElementById('edit-user-id').value = id;
        document.getElementById('modal-edit-id').style.display = 'flex';
    };

    window.confirmarAlterarId = async () => {
        const novoId = document.getElementById('edit-new-id').value;
        
        if (!novoId || novoId.length !== 4 || isNaN(novoId)) {
            alert("‚ùå Digite um ID v√°lido de 4 d√≠gitos!");
            return;
        }
        
        // Verificar se o novo ID j√° existe
        const snap = await get(child(ref(db), `usuarios/${novoId}`));
        if (snap.exists()) {
            alert("‚ùå Este ID j√° est√° em uso por outro jogador!");
            return;
        }
        
        // Buscar dados do usu√°rio antigo
        const snapOld = await get(child(ref(db), `usuarios/${usuarioSelecionado}`));
        const userData = snapOld.val();
        
        // Criar novo usu√°rio com o novo ID
        await set(ref(db, `usuarios/${novoId}`), {
            ...userData,
            id: novoId
        });
        
        // Remover usu√°rio antigo
        await remove(ref(db, `usuarios/${usuarioSelecionado}`));
        
        alert(`‚úÖ ID alterado de ${usuarioSelecionado} para ${novoId} com sucesso!`);
        fecharModal('modal-edit-id');
        document.getElementById('edit-new-id').value = '';
        carregarUsuariosMaster();
    };

    window.abrirModalReverter = (notifId, vencedorId, perdedorId, qtd, pontos) => {
        notificacaoSelecionada = { notifId, vencedorId, perdedorId, qtd, pontos };
        document.getElementById('revert-info').innerHTML = 
            `Reverter notifica√ß√£o?<br><br>` +
            `üèÜ Vencedor ID: ${vencedorId}<br>` +
            `üò¢ Perdedor ID: ${perdedorId}<br>` +
            `üìä Quantidade: ${qtd} derrotas<br>` +
            `üí∞ Pontos: ${pontos}`;
        document.getElementById('modal-revert-notif').style.display = 'flex';
    };

    window.confirmarReverter = async () => {
        const n = notificacaoSelecionada;
        
        // Buscar dados atuais
        const snapVencedor = await get(child(ref(db), `usuarios/${n.vencedorId}`));
        const snapPerdedor = await get(child(ref(db), `usuarios/${n.perdedorId}`));
        
        const vencedor = snapVencedor.val();
        const perdedor = snapPerdedor.val();
        
        // Reverter pontos
        await update(ref(db, `usuarios/${n.vencedorId}`), {
            pontos: (vencedor.pontos || 0) - n.pontos,
            v: (vencedor.v || 0) - n.qtd
        });
        
        await update(ref(db, `usuarios/${n.perdedorId}`), {
            pontos: (perdedor.pontos || 0) + n.pontos,
            d: (perdedor.d || 0) - n.qtd
        });
        
        // Remover do hist√≥rico
        const novoHistVencedor = (vencedor.historico || []).filter(h => 
            !(h.data === n.timestamp && h.resultado === 'vitoria' && h.perdedorId === n.perdedorId)
        );
        
        const novoHistPerdedor = (perdedor.historico || []).filter(h => 
            !(h.data === n.timestamp && h.resultado === 'derrota' && h.vencedorId === n.vencedorId)
        );
        
        await update(ref(db, `usuarios/${n.vencedorId}`), { historico: novoHistVencedor });
        await update(ref(db, `usuarios/${n.perdedorId}`), { historico: novoHistPerdedor });
        
        // Remover notifica√ß√£o
        await remove(ref(db, `notificacoes/${n.notifId}`));
        
        alert("‚úÖ Notifica√ß√£o revertida com sucesso!");
        fecharModal('modal-revert-notif');
        carregarNotificacoes();
    };

    window.filtrarUsuarios = () => {
        const filtro = document.getElementById('search-user').value.toLowerCase();
        const linhas = document.querySelectorAll('#lista-usuarios-master tr');
        
        linhas.forEach(linha => {
            const texto = linha.innerText.toLowerCase();
            if (texto.includes(filtro) || filtro === '') {
                linha.style.display = '';
            } else {
                linha.style.display = 'none';
            }
        });
    };

    window.fecharModal = (modalId) => {
        document.getElementById(modalId).style.display = 'none';
    };

    // PAINEL MASTER - Monitorar notifica√ß√µes em tempo real
    onValue(ref(db, 'notificacoes'), () => {
        // Se a aba de notifica√ß√µes estiver vis√≠vel, atualizar
        if (document.getElementById('master-notificacoes').style.display === 'block') {
            carregarNotificacoes();
        }
    });

    // Inicializa√ß√£o
    document.addEventListener('DOMContentLoaded', () => {
        gerarOpcoesData();
        setInterval(atualizarRelogio, 1000);
        atualizarRelogio();
        showSection('home');
        
        // Carregar usu√°rios master se estiver logado
        const navMaster = document.getElementById('nav-master');
        if (navMaster.style.display === 'block') {
            carregarUsuariosMaster();
        }
    });

    function atualizarRelogio() {
        const agora = new Date();
        const info = document.getElementById('relogio');
        const totalJogadoresSpan = document.getElementById('total-jogadores-info');
        if(info && totalJogadoresSpan) {
            info.querySelector('span:first-child').innerHTML = `üìÖ ${agora.toLocaleDateString('pt-BR')} - ‚è∞ ${agora.toLocaleTimeString('pt-BR')}`;
            totalJogadoresSpan.innerHTML = `üë• Total: ${totalJogadores} jogadores`;
        }
    }
</script>

<script>
    function showSection(id) {
        document.querySelectorAll('main > section').forEach(s => s.style.display = 'none');
        const section = document.getElementById('section-' + id);
        if(section) section.style.display = 'block';
    }

    function validarPrefixo(input) {
        if (!input.value.startsWith("LSJO_")) { 
            input.value = "LSJO_"; 
        }
        const restantes = 15 - input.value.length;
        document.getElementById('contador').innerHTML = `${restantes} caracteres restantes`;
        if(restantes < 3) {
            document.getElementById('contador').style.color = '#c0392b';
        } else {
            document.getElementById('contador').style.color = '#2980b9';
        }
    }

    function fazerLogout() {
        if(confirm("Deseja realmente desligar?")) { 
            location.reload(); 
        }
    }
    
    // Fechar modal ao clicar fora
    window.onclick = function(event) {
        if (event.target.classList.contains('modal')) {
            event.target.style.display = 'none';
        }
        if (event.target.classList.contains('estatisticas-modal')) {
            event.target.style.display = 'none';
        }
    }
</script>
</body>
</html>
