<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>LSJO - Liga Supremos de Jogos Online</title>
    
    <style>
        /* RESET E BASE */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: radial-gradient(circle, #1e2a3a 0%, #111821 100%); 
            color: #eee; 
            display: flex; 
            justify-content: center; 
            padding: 10px; 
            min-height: 100vh;
        }
        
        /* CONTAINER PRINCIPAL */
        .container { 
            width: 100%; 
            max-width: 1200px; 
            background-color: #243142; 
            border-radius: 15px; 
            overflow: hidden; 
            box-shadow: 0 15px 50px rgba(0,0,0,0.7); 
            display: flex; 
            flex-direction: column; 
            border: 1px solid #34495e; 
        }

        /* ===== HEADER RESPONSIVO ===== */
        .header { 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            padding: 20px 30px; 
            background: linear-gradient(135deg, #2c3e50 0%, #000000 100%); 
            position: relative;
            border-bottom: 4px solid #f1c40f; 
            overflow: hidden;
            flex-wrap: wrap;
        }
        .header::before { 
            content: ""; 
            position: absolute; 
            top: -50%; 
            left: -10%; 
            width: 70%; 
            height: 200%; 
            background: radial-gradient(circle, rgba(52, 152, 219, 0.2) 0%, transparent 70%); 
            transform: rotate(-15deg); 
        }
        .logo-area { 
            position: relative; 
            z-index: 2; 
        }
        .logo-area h1 { 
            font-size: 48px; 
            color: #fff; 
            text-shadow: 0 4px 10px rgba(0,0,0,0.5); 
            margin: 0; 
            font-family: 'Arial Black', sans-serif; 
            line-height: 0.9; 
            letter-spacing: -2px; 
        }
        .logo-area p { 
            font-size: 16px; 
            color: #f1c40f; 
            font-weight: bold; 
            margin: 0; 
            letter-spacing: 1px; 
            text-transform: uppercase; 
        }
        .logo-area span { 
            font-size: 12px; 
            color: #bdc3c7; 
            display: block; 
            margin-top: 5px; 
        }

        .pool-table-visual {
            position: relative; 
            z-index: 2; 
            width: 250px; 
            height: 130px; 
            background: #222; 
            border: 6px solid #555;
            border-radius: 10px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.8), inset 0 0 50px rgba(0,0,0,0.5);
            display: flex; 
            align-items: center; 
            justify-content: center; 
            transform: perspective(500px) rotateX(20deg);
        }
        .cue-stick { 
            position: absolute; 
            width: 160px; 
            height: 4px; 
            background: linear-gradient(90deg, #63472b, #d4af37, #fff); 
            transform: rotate(-25deg); 
            top: 50px; 
            left: -10px; 
            box-shadow: 2px 5px 10px rgba(0,0,0,0.5); 
            border-radius: 2px; 
        }
        .ball-8-top { 
            width: 60px; 
            height: 60px; 
            background: radial-gradient(circle at 30% 30%, #444, #000); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            position: relative; 
            box-shadow: 5px 10px 20px rgba(0,0,0,0.6); 
            border: 1px solid #333; 
        }
        .ball-8-top .inner-circle { 
            width: 28px; 
            height: 28px; 
            background: white; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-weight: 900; 
            color: black; 
            font-size: 16px; 
        }

        .info-bar { 
            background-color: #ecf0f1; 
            padding: 8px 15px; 
            font-size: 12px; 
            color: #2c3e50; 
            font-weight: bold; 
            border-bottom: 1px solid #bdc3c7; 
            text-align: center;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .total-jogadores {
            background: #2c3e50;
            color: #f1c40f;
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 11px;
            font-weight: bold;
        }

        /* ===== LAYOUT PRINCIPAL RESPONSIVO ===== */
        .main-content { 
            display: grid; 
            grid-template-columns: 200px 1fr 220px; 
            gap: 15px; 
            padding: 15px; 
            background-color: #1a2533; 
        }

        /* Sidebars */
        .sidebar-left, .sidebar-right { 
            display: flex; 
            flex-direction: column; 
            gap: 10px; 
        }

        /* Botões */
        .btn-menu { 
            background: linear-gradient(180deg, #ffffff 0%, #dfe6e9 100%); 
            color: #2d3436; 
            border: 1px solid #b2bec3; 
            padding: 12px; 
            border-radius: 20px; 
            text-align: center; 
            font-weight: bold; 
            cursor: pointer; 
            font-size: 11px; 
            transition: 0.3s; 
            width: 100%;
        }
        .btn-menu:hover { 
            background: linear-gradient(180deg, #636e72 0%, #2d3436 100%); 
            color: white; 
            transform: translateY(-2px); 
        }
        .btn-blue { 
            background: linear-gradient(180deg, #3498db 0%, #2980b9 100%); 
            color: white; 
            border: 1px solid #1c5980; 
        }
        
        .btn-master-especial { 
            background: #000; 
            color: #f1c40f; 
            border: 2px solid #f1c40f; 
            display: none; 
        }
        .btn-pato { 
            background: linear-gradient(180deg, #e67e22 0%, #d35400 100%) !important; 
            color: white !important; 
            display: none; 
        }

        /* Botão Jogos (inicialmente oculto) */
        .btn-jogos {
            display: none !important;
        }

        /* Painel Central */
        .center-panel { 
            background: #ffffff; 
            border-radius: 15px; 
            padding: 20px; 
            color: #2c3e50; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.4); 
            overflow-x: auto;
        }
        .section-title { 
            color: white; 
            padding: 12px; 
            border-radius: 10px; 
            text-align: center; 
            margin-bottom: 20px; 
            font-weight: bold; 
            text-transform: uppercase; 
        }

        /* Grids responsivos */
        .grid-how-works { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); 
            gap: 15px; 
            margin-top: 10px; 
        }
        .step-card { 
            border: 3px solid #ccc; 
            border-radius: 15px; 
            padding: 20px; 
            text-align: center; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            background: #fff; 
            min-height: 120px; 
        }
        .step-card strong { 
            display: block; 
            font-size: 16px; 
            margin-bottom: 8px; 
            color: #333; 
        }
        .step-card p { 
            font-size: 13px; 
            color: #666; 
            line-height: 1.3; 
        }
        .card-green { border-color: #27ae60; }
        .card-blue { border-color: #2980b9; }
        .card-orange { border-color: #e67e22; }
        .card-gold { border-color: #f1c40f; }

        /* Ranking cards */
        .ranking-options { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
            gap: 15px; 
        }
        .rank-card { 
            background: #f8f9fa; 
            border: 2px solid #ddd; 
            border-radius: 15px; 
            padding: 15px; 
            text-align: center; 
            cursor: pointer; 
            transition: 0.3s; 
        }
        .rank-card:hover { 
            transform: translateY(-5px); 
            border-color: #2980b9; 
        }
        .rank-icon { 
            width: 70px; 
            height: 70px; 
            margin: 0 auto 10px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 35px; 
            border-radius: 50%; 
            background: #2c3e50; 
            color: #fff; 
            border: 3px solid #f1c40f; 
        }
        .icon-9 { 
            background: radial-gradient(circle at 30% 30%, #f1c40f 0%, #d4ac0d 100%); 
            color: #000; 
            border: 3px solid #fff; 
        }

        /* ===== SEÇÃO DE JOGOS ===== */
        .jogos-container {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .jogo-card {
            background: linear-gradient(145deg, #2c3e50, #1e2a3a);
            border-radius: 20px;
            padding: 25px;
            width: 260px;
            text-align: center;
            cursor: pointer;
            transition: 0.4s;
            border: 2px solid #f1c40f;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
        }

        .jogo-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            transform: rotate(30deg);
            transition: 0.6s;
        }

        .jogo-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(241, 196, 15, 0.3);
            border-color: #f39c12;
        }

        .jogo-card:hover::before {
            transform: rotate(30deg) translate(10%, 10%);
        }

        .bola-jogo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            font-weight: 900;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5), inset 0 -5px 15px rgba(0,0,0,0.6), inset 0 5px 15px rgba(255,255,255,0.3);
            position: relative;
            transition: 0.4s;
        }

        .bola-jogo::after {
            content: '';
            position: absolute;
            top: 15px;
            left: 25px;
            width: 25px;
            height: 25px;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0.2) 70%);
            border-radius: 50%;
            opacity: 0.8;
        }

        .bola8 {
            background: radial-gradient(circle at 30% 30%, #333, #000);
            color: white;
            border: 3px solid #f1c40f;
        }

        .bola9 {
            background: radial-gradient(circle at 30% 30%, #f1c40f, #f39c12);
            color: #000;
            border: 3px solid white;
        }

        .jogo-card h3 {
            color: #f1c40f;
            font-size: 24px;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .btn-jogar {
            background: linear-gradient(135deg, #f1c40f, #f39c12);
            color: #000;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            margin-top: 15px;
            transition: 0.3s;
            border: 2px solid transparent;
            width: 100%;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-jogar:hover {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            transform: scale(1.05);
            border-color: white;
            box-shadow: 0 5px 15px rgba(241, 196, 15, 0.4);
        }

        .aviso-jogos {
            text-align: center;
            margin: 30px auto;
            padding: 20px;
            max-width: 600px;
            background: rgba(52, 73, 94, 0.5);
            border-radius: 15px;
            border-left: 4px solid #f1c40f;
            border-right: 4px solid #f1c40f;
            backdrop-filter: blur(5px);
        }

        .aviso-jogos p {
            color: #ecf0f1;
            font-size: 14px;
            line-height: 1.6;
        }

        .aviso-jogos .destaque {
            color: #f1c40f;
            font-weight: bold;
        }

        .aviso-jogos .icone {
            font-size: 24px;
            margin-bottom: 10px;
            display: block;
        }

        /* ===== SEÇÃO DE REGRAS ===== */
        .regras-container {
            max-width: 800px;
            margin: 0 auto;
            color: #2c3e50;
        }

        .regras-secao {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #f1c40f;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        .regras-secao h2 {
            color: #f1c40f;
            font-size: 20px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .regras-secao h3 {
            color: #2980b9;
            font-size: 18px;
            margin: 15px 0 10px;
        }

        .regras-secao p {
            font-size: 14px;
            line-height: 1.6;
            color: #34495e;
            margin-bottom: 10px;
        }

        .regras-secao ul, .regras-secao ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .regras-secao li {
            font-size: 14px;
            line-height: 1.6;
            color: #34495e;
            margin-bottom: 5px;
        }

        .regras-secao .destaque {
            background: #f1c40f;
            color: #000;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        .regras-secao .aviso {
            background: #e67e22;
            color: white;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .regras-secao .sucesso {
            background: #27ae60;
            color: white;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .regras-secao .exemplo {
            background: #ecf0f1;
            padding: 10px;
            border-radius: 8px;
            font-family: monospace;
            margin: 10px 0;
        }

        .badge-regra {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 12px;
            margin-right: 5px;
        }

        /* ===== RANKING MODERNO COM PAGINAÇÃO ===== */
        .tab-container { 
            display: flex; 
            gap: 8px; 
            margin-bottom: 20px; 
            border-bottom: 2px solid #eee; 
            padding-bottom: 10px; 
            flex-wrap: wrap;
        }
        .tab-button { 
            flex: 1; 
            padding: 12px; 
            border: none; 
            background: #f1f2f6; 
            cursor: pointer; 
            font-weight: bold; 
            font-size: 12px; 
            border-radius: 50px; 
            transition: 0.3s; 
            min-width: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            color: #475569;
            border: 1px solid #e2e8f0;
        }
        .tab-button.active { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; 
            border: none;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        .tab-icon {
            font-size: 14px;
        }

        .btn-voltar {
            background: white;
            border: 2px solid #e2e8f0;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 12px;
            cursor: pointer;
            margin-bottom: 20px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: 0.3s;
            color: #475569;
        }

        .btn-voltar:hover {
            background: #f1f5f9;
            border-color: #94a3b8;
            transform: translateX(-5px);
        }

        .seta {
            font-size: 16px;
            font-weight: bold;
        }

        /* Ranking Table */
        .ranking-table-wrapper {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin: 20px 0;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .ranking-table-moderno {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .ranking-table-moderno thead tr {
            background: linear-gradient(135deg, #1e293b, #0f172a);
        }

        .ranking-table-moderno th {
            color: white;
            font-weight: 600;
            padding: 16px 12px;
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: 1px;
            border-bottom: 3px solid #f1c40f;
        }

        .ranking-table-moderno td {
            padding: 14px 12px;
            border-bottom: 1px solid #e2e8f0;
            font-weight: 500;
        }

        .ranking-table-moderno tbody tr:nth-child(even) {
            background-color: #f8fafc;
        }

        .ranking-table-moderno tbody tr:hover {
            background: linear-gradient(135deg, #eef2ff, #e0e7ff);
            transform: scale(1.01);
            transition: 0.2s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .ranking-table-moderno tbody tr.top-1 {
            background: linear-gradient(135deg, #fef9c3, #fde047);
            font-weight: bold;
        }

        .ranking-table-moderno tbody tr.top-1:hover {
            background: linear-gradient(135deg, #fde047, #facc15);
        }

        .ranking-table-moderno tbody tr.top-2 {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
        }

        .ranking-table-moderno tbody tr.top-3 {
            background: linear-gradient(135deg, #fed7aa, #fdba74);
        }

        /* Estilo para slots vazios */
        .slot-vazio {
            opacity: 0.7;
            background: linear-gradient(135deg, #f8fafc, #f1f5f9) !important;
        }
        
        .slot-vazio td {
            color: #64748b !important;
            font-style: italic;
        }

        .slot-vazio .streak-indicator {
            color: #94a3b8 !important;
        }

        /* Ranking Cards (Mobile) */
        .ranking-cards-container {
            display: none;
        }

        /* Cards vazios no mobile */
        .ranking-card.vazio {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border: 2px dashed #cbd5e1;
        }
        
        .ranking-card.vazio .ranking-card-nome {
            color: #64748b;
            font-style: italic;
        }

        .ranking-card.vazio .ranking-card-pontos {
            color: #94a3b8;
        }

        /* Paginação */
        .pagination-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 20px 0 10px;
            flex-wrap: wrap;
        }

        .pagination-btn {
            background: white;
            border: 2px solid #e2e8f0;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 12px;
            cursor: pointer;
            transition: 0.3s;
            color: #475569;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .pagination-btn:hover:not(:disabled) {
            background: #f1f5f9;
            border-color: #94a3b8;
            transform: translateY(-2px);
        }

        .pagination-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .pagination-info {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 13px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        /* Mensagem de ranking vazio */
        .empty-ranking-message {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border-radius: 20px;
            margin: 20px 0;
        }
        
        .empty-ranking-message h3 {
            font-size: 18px;
            color: #1e293b;
            margin-bottom: 10px;
        }
        
        .empty-ranking-message p {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 20px;
        }
        
        .empty-ranking-message .icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .empty-ranking-message .btn-menu {
            width: auto;
            padding: 10px 30px;
            margin: 0 auto;
            display: inline-block;
        }

        /* Legenda */
        .ranking-legenda {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .legenda-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #475569;
        }

        .legenda-cor {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
        }

        /* Streak colors */
        .streak-high {
            color: #f59e0b !important;
            font-weight: bold;
        }

        /* ===== ÍCONES DO PERFIL ===== */
        .icones-perfil-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .icone-perfil {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            border: 2px solid transparent;
        }

        .icone-perfil.pato {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #000;
            border-color: #d97706;
        }

        .icone-perfil.pato.disabled {
            opacity: 0.3;
            filter: grayscale(80%);
            cursor: not-allowed;
            pointer-events: none;
        }

        .icone-perfil.bola8 {
            background: linear-gradient(135deg, #2c3e50, #000000);
            color: white;
            border-color: #f1c40f;
        }

        .icone-perfil.bola9 {
            background: linear-gradient(135deg, #f1c40f, #f39c12);
            color: #000;
            border-color: #fff;
        }

        .icone-perfil.truco {
            background: linear-gradient(135deg, #27ae60, #16a085);
            color: #fff;
            border-color: #f1c40f;
        }

        .icone-perfil:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 6px 15px rgba(241, 196, 15, 0.5);
        }

        .icone-perfil.inativo {
            opacity: 0.3;
            filter: grayscale(80%);
            cursor: not-allowed;
        }

        .icone-perfil.inativo:hover {
            transform: none;
            box-shadow: none;
        }

        /* Avatar editável */
        .avatar-container {
            position: relative;
            width: 60px;
            height: 60px;
            margin: 0 auto 10px;
        }

        .profile-avatar {
            width: 60px;
            height: 60px;
            background: #34495e;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 30px;
            border: 2px solid #f1c40f;
            cursor: pointer;
            transition: 0.3s;
        }

        .profile-avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px #f1c40f;
        }

        .edit-avatar-icon {
            position: absolute;
            bottom: 0;
            right: 0;
            background: #f1c40f;
            color: #000;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            border: 2px solid #fff;
            transition: 0.3s;
        }

        .edit-avatar-icon:hover {
            transform: scale(1.1);
            background: #f39c12;
        }

        /* Modal de avatares */
        .avatares-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .avatar-opcao {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #34495e;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: 0.3s;
            margin: 0 auto;
        }

        .avatar-opcao:hover {
            transform: scale(1.1);
            border-color: #f1c40f;
        }

        .avatar-opcao.selecionado {
            border-color: #f1c40f;
            box-shadow: 0 0 15px #f1c40f;
        }

        /* Modal de seleção de liga */
        .modal-select-liga {
            background: linear-gradient(135deg, #2c3e50, #1a2634);
            border-radius: 25px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            border: 3px solid #f1c40f;
            color: white;
            text-align: center;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-select-liga h3 {
            color: #f1c40f;
            margin-bottom: 20px;
            font-size: 22px;
        }

        .modal-select-liga p {
            color: #bdc3c7;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .opcoes-liga {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin: 25px 0;
        }

        .opcao-liga {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px 5px;
            cursor: pointer;
            transition: 0.3s;
            border: 2px solid transparent;
            -webkit-tap-highlight-color: transparent;
        }

        .opcao-liga:active {
            transform: scale(0.95);
            background: rgba(241, 196, 15, 0.3);
        }

        .opcao-liga:hover {
            transform: scale(1.05);
            border-color: #f1c40f;
            background: rgba(241, 196, 15, 0.2);
        }

        .opcao-liga .icone-grande {
            font-size: 48px;
            margin-bottom: 8px;
        }

        .opcao-liga .nome-liga {
            font-size: 14px;
            font-weight: bold;
            color: white;
        }

        .btn-fechar-modal {
            background: #f1c40f;
            color: #000;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            margin: 20px auto 0;
            display: block;
            width: fit-content;
            transition: 0.3s;
            -webkit-tap-highlight-color: transparent;
        }

        .btn-fechar-modal:active {
            transform: scale(0.95);
            background: #f39c12;
        }

        .btn-fechar-modal:hover {
            background: #f39c12;
            transform: scale(1.05);
        }

        /* Mensagem de sucesso */
        .success-message {
            background: #27ae60;
            color: white;
            padding: 10px;
            border-radius: 10px;
            margin-top: 15px;
            font-weight: bold;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Status de suspensão */
        .status-suspenso {
            color: #f39c12 !important;
            font-weight: bold;
        }

        .suspenso-badge {
            background: #f39c12;
            color: #000;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            margin-left: 5px;
        }

        /* Estilos do Painel Master */
        .master-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            flex-wrap: wrap;
        }

        .master-tab {
            background: #2c3e50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 30px 30px 0 0;
            cursor: pointer;
            font-weight: bold;
            font-size: 12px;
            transition: 0.3s;
            opacity: 0.7;
        }

        .master-tab.active {
            background: #f1c40f;
            color: #000;
            opacity: 1;
            transform: translateY(-2px);
        }

        .master-panel {
            background: #1a2634;
            border-radius: 15px;
            padding: 20px;
            color: white;
            margin-top: 15px;
        }

        .search-box {
            background: #2c3e50;
            border: 1px solid #f1c40f;
            border-radius: 30px;
            padding: 8px 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }

        .search-box input {
            flex: 1;
            background: transparent;
            border: none;
            color: white;
            outline: none;
            font-size: 14px;
        }

        .search-box input::placeholder {
            color: #95a5a6;
        }

        .search-box button {
            background: #f1c40f;
            border: none;
            border-radius: 20px;
            padding: 5px 15px;
            font-weight: bold;
            cursor: pointer;
        }

        .master-table {
            width: 100%;
            border-collapse: collapse;
            background: #2c3e50;
            border-radius: 15px;
            overflow: hidden;
            font-size: 12px;
        }

        .master-table th {
            background: #000;
            color: #f1c40f;
            padding: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .master-table td {
            padding: 10px;
            border-bottom: 1px solid #405060;
        }

        .master-table tr:hover {
            background: #34495e;
        }

        .btn-ban {
            background: #c0392b;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }

        .btn-unban {
            background: #27ae60;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }

        .btn-suspend {
            background: #f39c12;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }

        .btn-edit {
            background: #2980b9;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            margin-right: 3px;
        }

        .btn-revert {
            background: #f39c12;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }

        .btn-staff {
            background: #8e44ad;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }

        .badge-staff {
            background: #8e44ad;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 9px;
            margin-left: 5px;
        }

        .badge-master {
            background: #f1c40f;
            color: #000;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 9px;
            margin-left: 5px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #2c3e50;
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            border: 3px solid #f1c40f;
        }

        .modal-content h3 {
            color: #f1c40f;
            margin-bottom: 20px;
            text-align: center;
        }

        .modal-content input, .modal-content select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #f1c40f;
            background: #34495e;
            color: white;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
        }

        .modal-confirm {
            background: #27ae60;
            color: white;
        }

        .modal-cancel {
            background: #c0392b;
            color: white;
        }

        .notificacao-item {
            background: #2c3e50;
            border-left: 4px solid #f1c40f;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            font-size: 12px;
        }

        .notificacao-item .vencedor {
            color: #27ae60;
            font-weight: bold;
        }

        .notificacao-item .perdedor {
            color: #c0392b;
            font-weight: bold;
        }

        .notificacao-item .tempo {
            color: #f1c40f;
            font-size: 10px;
            margin-top: 5px;
        }

        .badge {
            background: #f1c40f;
            color: #000;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            margin-left: 5px;
        }

        /* Estilo para links no ranking */
        .jogador-link {
            cursor: pointer;
            transition: 0.3s;
            font-weight: 500;
        }

        .jogador-link:hover {
            color: #27ae60 !important;
            text-decoration: underline;
        }

        .jogador-banido {
            color: #c0392b !important;
        }

        .jogador-suspenso {
            color: #f39c12 !important;
        }

        /* ===== MODAIS DE ESTATÍSTICAS ===== */
        .estatisticas-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-content-estatisticas {
            background: linear-gradient(135deg, #2c3e50, #1a2634);
            border-radius: 25px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            border: 3px solid #f1c40f;
            color: white;
            position: relative;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f1c40f;
        }

        .modal-header h2 {
            color: #f1c40f;
            font-size: 24px;
            margin-top: 10px;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 28px;
            cursor: pointer;
            color: #f1c40f;
            transition: 0.3s;
        }

        .modal-close:hover {
            transform: scale(1.2);
            color: #e67e22;
        }

        .estatisticas-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .estatistica-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(241, 196, 15, 0.3);
        }

        .estatistica-card .valor {
            font-size: 24px;
            font-weight: bold;
            color: #f1c40f;
            margin: 5px 0;
        }

        .estatistica-card .rotulo {
            font-size: 11px;
            color: #bdc3c7;
            text-transform: uppercase;
        }

        .ranking-posicao {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 50px;
        }

        .ranking-posicao .posicao-numero {
            font-size: 32px;
            font-weight: 900;
            color: #f1c40f;
        }

        .ranking-posicao .posicao-label {
            font-size: 12px;
            color: #bdc3c7;
        }

        .streak-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            font-size: 18px;
        }

        .streak-info .fire {
            color: #f59e0b;
            font-size: 24px;
        }

        .btn-fechar-modal {
            background: #f1c40f;
            color: #000;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            margin: 20px auto 0;
            display: block;
            width: fit-content;
            transition: 0.3s;
        }

        .btn-fechar-modal:hover {
            background: #f39c12;
            transform: scale(1.05);
        }

        /* Formulários responsivos */
        .form-group { 
            display: grid; 
            grid-template-columns: 140px 1fr; 
            margin-bottom: 15px; 
            align-items: center; 
            text-align: left; 
        }
        .form-group label { 
            font-weight: bold; 
            font-size: 13px; 
            color: #333; 
        }
        .form-group input, 
        .form-group select { 
            padding: 10px 12px; 
            border: 1px solid #ccc; 
            border-radius: 5px; 
            background: #f9f9f9; 
            font-size: 14px; 
            outline: none; 
            width: 100%;
        }
        .form-group small {
            font-size: 11px;
            color: #7f8c8d;
            margin-top: 3px;
            display: block;
        }
        .form-group input[type="checkbox"] {
            width: auto;
            margin-right: 5px;
        }
        .form-group a {
            color: #2980b9;
            text-decoration: none;
        }
        .form-group a:hover {
            text-decoration: underline;
        }
        .btn-submit { 
            background: linear-gradient(180deg, #3498db 0%, #2980b9 100%); 
            color: white; 
            border: none; 
            padding: 15px; 
            width: 80%; 
            border-radius: 30px; 
            font-weight: bold; 
            cursor: pointer; 
            margin: 20px auto 0; 
            display: block; 
        }

        /* Sidebar direita */
        .right-box { 
            background: white; 
            border-radius: 12px; 
            overflow: hidden; 
            margin-bottom: 15px; 
            color: #2c3e50; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.2); 
        }
        .right-box-title { 
            background: #2c3e50; 
            color: white; 
            padding: 8px; 
            font-size: 12px; 
            text-align: center; 
            font-weight: bold; 
            text-transform: uppercase; 
        }
        .right-box-content { 
            padding: 15px; 
            font-size: 12px; 
        }
        .login-input { 
            width: 100%; 
            padding: 10px; 
            margin-bottom: 10px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
        }
        .btn-login { 
            width: 100%; 
            padding: 10px; 
            background: #27ae60; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
            font-weight: bold; 
        }
        .profile-card { 
            text-align: center; 
        }
        
        .profile-stats {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 5px;
            margin: 15px 0;
        }
        .stat-item {
            background: #f0f0f0;
            padding: 5px;
            border-radius: 4px;
            font-size: 11px;
        }
        .btn-action { 
            width: 100%; 
            padding: 8px; 
            margin-top: 8px; 
            font-size: 11px; 
            border-radius: 4px; 
            border: none; 
            cursor: pointer; 
            font-weight: bold; 
        }
        .btn-join { background: #f1c40f; color: #000; }
        .btn-special { background: #8e44ad; color: #fff; }
        .btn-logout { background: #c0392b; color: #fff; }
        .footer-line { 
            padding: 15px; 
            text-align: center; 
            color: #7f8c8d; 
            font-size: 12px; 
        }

        /* ===== MEDIA QUERIES ===== */
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 180px 1fr;
                gap: 15px;
            }
            .sidebar-right {
                grid-column: span 2;
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }
            .logo-area h1 {
                font-size: 42px;
            }
            .pool-table-visual {
                width: 200px;
                height: 110px;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
                padding: 15px;
            }
            .logo-area h1 {
                font-size: 38px;
            }
            .logo-area p {
                font-size: 14px;
            }
            .pool-table-visual {
                margin-top: 15px;
                width: 180px;
                height: 100px;
            }
            .cue-stick {
                width: 120px;
                top: 40px;
            }
            .ball-8-top {
                width: 50px;
                height: 50px;
            }
            .ball-8-top .inner-circle {
                width: 22px;
                height: 22px;
                font-size: 14px;
            }
            
            .ranking-table-wrapper {
                display: none;
            }
            
            .ranking-cards-container {
                display: flex;
                flex-direction: column;
                gap: 12px;
                margin: 20px 0;
            }
            
            .ranking-card {
                background: white;
                border-radius: 16px;
                padding: 16px;
                display: flex;
                align-items: center;
                gap: 15px;
                box-shadow: 0 8px 20px rgba(0,0,0,0.06);
                border: 1px solid #e2e8f0;
                transition: 0.3s;
                position: relative;
                overflow: hidden;
            }
            
            .ranking-card:hover {
                transform: translateY(-3px);
                box-shadow: 0 12px 30px rgba(0,0,0,0.1);
            }
            
            .ranking-card::before {
                content: '';
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                width: 6px;
                background: linear-gradient(180deg, #94a3b8, #64748b);
            }
            
            .ranking-card.top-1::before {
                background: linear-gradient(180deg, #fbbf24, #f59e0b);
            }
            
            .ranking-card.top-2::before {
                background: linear-gradient(180deg, #94a3b8, #64748b);
            }
            
            .ranking-card.top-3::before {
                background: linear-gradient(180deg, #fca5a5, #ef4444);
            }
            
            .ranking-card-avatar {
                width: 50px;
                height: 50px;
                background: linear-gradient(135deg, #94a3b8, #64748b);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-size: 24px;
            }
            
            .ranking-card.top-1 .ranking-card-avatar {
                background: linear-gradient(135deg, #fbbf24, #f59e0b);
            }
            
            .ranking-card.top-2 .ranking-card-avatar {
                background: linear-gradient(135deg, #94a3b8, #64748b);
            }
            
            .ranking-card.top-3 .ranking-card-avatar {
                background: linear-gradient(135deg, #fca5a5, #ef4444);
            }
            
            .ranking-card-info {
                flex: 1;
            }
            
            .ranking-card-nome {
                font-weight: 700;
                font-size: 16px;
                color: #0f172a;
                margin-bottom: 4px;
            }
            
            .ranking-card-detalhes {
                display: flex;
                gap: 15px;
                font-size: 12px;
                color: #64748b;
            }
            
            .ranking-card-posicao {
                font-size: 20px;
                font-weight: 900;
                min-width: 40px;
                text-align: center;
                color: #f1c40f;
            }
            
            .ranking-card-pontos {
                font-weight: 700;
                color: #2980b9;
                font-size: 18px;
                min-width: 60px;
                text-align: right;
            }
            
            .ranking-card.vazio .ranking-card-avatar {
                background: linear-gradient(135deg, #cbd5e1, #94a3b8);
            }
            
            .ranking-card.vazio .ranking-card-pontos {
                color: #94a3b8;
            }
            
            .grid-how-works {
                gap: 10px;
            }
            .step-card {
                padding: 15px;
                min-height: 100px;
            }
            .step-card strong {
                font-size: 14px;
            }
            
            .info-bar {
                flex-direction: column;
                text-align: center;
            }
            
            .avatares-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .jogos-container {
                gap: 20px;
            }
            
            .jogo-card {
                width: 220px;
                padding: 20px;
            }
            
            .bola-jogo {
                width: 100px;
                height: 100px;
                font-size: 40px;
            }
            
            .regras-secao h2 {
                font-size: 18px;
            }
        }

        @media (max-width: 576px) {
            body {
                padding: 5px;
            }
            
            .main-content {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 10px;
            }
            
            .sidebar-left {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 8px;
            }
            
            .sidebar-right {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .btn-menu {
                padding: 10px;
                font-size: 10px;
                border-radius: 15px;
            }
            
            .center-panel {
                padding: 12px;
            }
            
            .section-title {
                font-size: 14px;
                padding: 10px;
            }
            
            .grid-how-works {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .ranking-options {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .rank-card {
                padding: 12px;
            }
            
            .rank-icon {
                width: 60px;
                height: 60px;
                font-size: 30px;
            }
            
            .form-group {
                grid-template-columns: 1fr;
                gap: 5px;
            }
            
            .form-group label {
                margin-bottom: 2px;
            }
            
            .form-group > div[style*="display: flex"] {
                flex-direction: row !important;
                flex-wrap: wrap;
            }
            
            #dia-nasc, #mes-nasc, #ano-nasc {
                min-width: calc(33.33% - 5px) !important;
                flex: 1 !important;
            }
            
            .form-group select {
                width: 100%;
            }
            
            .btn-submit {
                width: 100%;
                padding: 12px;
                font-size: 14px;
            }
            
            .tab-button {
                font-size: 11px;
                padding: 10px;
                min-width: 80px;
            }
            
            .profile-stats {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .stat-item {
                padding: 8px;
            }
            
            .ranking-card {
                padding: 12px;
                flex-wrap: wrap;
            }
            
            .ranking-card-avatar {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
            
            .ranking-card-nome {
                font-size: 14px;
            }
            
            .ranking-card-pontos {
                font-size: 16px;
            }
            
            .ranking-card-posicao {
                width: 100%;
                text-align: left;
                margin-bottom: 5px;
            }
            
            .pagination-container {
                gap: 10px;
            }
            
            .pagination-btn {
                padding: 8px 15px;
                font-size: 11px;
            }
            
            .pagination-info {
                padding: 6px 15px;
                font-size: 12px;
            }
            
            .master-table {
                font-size: 10px;
            }
            
            .master-table th, .master-table td {
                padding: 6px;
            }
            
            .btn-edit, .btn-ban, .btn-unban, .btn-revert, .btn-suspend, .btn-staff {
                padding: 3px 6px;
                font-size: 9px;
            }
            
            .icones-perfil-container {
                gap: 8px;
            }
            
            .icone-perfil {
                width: 45px;
                height: 45px;
                font-size: 22px;
            }
            
            .opcoes-liga {
                gap: 10px;
            }
            
            .opcao-liga .icone-grande {
                font-size: 40px;
            }
            
            .avatares-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .jogos-container {
                flex-direction: column;
                align-items: center;
            }
            
            .jogo-card {
                width: 100%;
                max-width: 280px;
            }
            
            .regras-secao {
                padding: 15px;
            }
        }

        @media (max-width: 400px) {
            .logo-area h1 {
                font-size: 32px;
            }
            
            .logo-area p {
                font-size: 12px;
            }
            
            .sidebar-left {
                grid-template-columns: 1fr;
            }
            
            .btn-menu {
                font-size: 12px;
                padding: 12px;
            }
            
            .pool-table-visual {
                width: 150px;
                height: 85px;
            }
            
            .cue-stick {
                width: 100px;
                top: 35px;
            }
            
            #dia-nasc, #mes-nasc, #ano-nasc {
                min-width: 100% !important;
                margin-bottom: 5px;
            }
            
            .icone-perfil {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
            
            .opcao-liga .icone-grande {
                font-size: 36px;
            }
        }

        .char-counter {
            font-size: 10px;
            color: #2980b9;
            display: block;
            margin-top: 3px;
        }
    </style>
    <!-- Adicionar CryptoJS para hash SHA256 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>
<body>

<div class="container">
    <header class="header">
        <div class="logo-area">
            <h1>LSJO</h1>
            <p>Liga Supremos de Jogos Online</p>
            <span>Liderando a diversão desde 2026</span>
        </div>
        <div class="pool-table-visual">
            <div class="cue-stick"></div>
            <div class="ball-8-top"><div class="inner-circle">8</div></div>
        </div>
    </header>

    <div class="info-bar" id="relogio">
        <span>📅 Carregando data e hora...</span>
        <span class="total-jogadores" id="total-jogadores-info">👥 Total: 0 jogadores</span>
    </div>

    <div class="main-content">
        <aside class="sidebar-left">
            <button class="btn-menu" onclick="showSection('home')">🏠 HOME</button>
            <button class="btn-menu btn-pato" id="nav-pato" onclick="showSection('notificar')">🦆 NOTIFICAR</button>
            <button class="btn-menu btn-master-especial" id="nav-master" onclick="showSection('master')">👑 PAINEL MASTER</button>
            <!-- Botão Jogos (inicialmente oculto) -->
            <button class="btn-menu btn-blue btn-jogos" id="nav-jogos" onclick="showSection('jogos')">🎮 JOGOS</button>
            <button class="btn-menu btn-blue" onclick="showSection('rankings-hub')">🏆 RANKINGS</button>
            <button class="btn-menu" id="nav-cadastro" onclick="showSection('cadastro')">📝 CADASTRO</button>
            <button class="btn-menu" onclick="showSection('regras')">📜 REGRAS</button>
            <button class="btn-menu">📧 CONTATO</button>
        </aside>

        <main class="center-panel">
            <section id="section-home">
                <div class="section-title" style="background: #2980b9;">🏠 PAGINA INICIAL LSJO</div>
                <div class="grid-how-works">
                    <div class="step-card card-green"><strong>📝 1. CADASTRE-SE</strong><p>Crie sua conta e receba seu ID exclusivo.</p></div>
                    <div class="step-card card-blue"><strong>🎮 2. JOGUE</strong><p>Desafie adversários em nossos servidores parceiros.</p></div>
                    <div class="step-card card-orange"><strong>📢 3. NOTIFIQUE</strong><p>Ao perder, envie o resultado para validar o ranking.</p></div>
                    <div class="step-card card-gold"><strong>🏆 4. RANKING</strong><p>Acompanhe sua posição e torne-se um Supremo.</p></div>
                </div>
            </section>

            <!-- SEÇÃO DE JOGOS -->
            <section id="section-jogos" style="display:none;">
                <div class="section-title" style="background: linear-gradient(135deg, #e67e22, #d35400);">
                    🎮 JOGOS ONLINE
                </div>
                
                <div class="jogos-container">
                    <!-- Card Bola 8 -->
                    <div class="jogo-card" onclick="window.open('https://www.flyordie.com/pt_BR/bola8', '_blank')">
                        <div class="bola-jogo bola8">🎱</div>
                        <h3>BOLA 8</h3>
                        <p style="color: #bdc3c7; margin: 10px 0; font-size: 13px;">O clássico jogo de sinuca</p>
                        <button class="btn-jogar">JOGAR AGORA</button>
                    </div>
                    
                    <!-- Card Bola 9 -->
                    <div class="jogo-card" onclick="window.open('https://www.flyordie.com/pt_BR/bola9', '_blank')">
                        <div class="bola-jogo bola9">9</div>
                        <h3>BOLA 9</h3>
                        <p style="color: #bdc3c7; margin: 10px 0; font-size: 13px;">Modo competitivo com 9 bolas</p>
                        <button class="btn-jogar">JOGAR AGORA</button>
                    </div>
                </div>
                
                <!-- Aviso de responsabilidade -->
                <div class="aviso-jogos">
                    <span class="icone">🎯</span>
                    <p>
                        <span class="destaque">Os jogos são hospedados por terceiros.</span><br>
                        O LSJO não é responsável pelo conteúdo, funcionamento ou disponibilidade dos sites externos. 
                        Ao clicar em "JOGAR AGORA", você será redirecionado para plataformas parceiras.
                    </p>
                    <p style="margin-top: 10px; font-size: 12px; color: #95a5a6;">
                        Divirta-se com responsabilidade! 🎱
                    </p>
                </div>
            </section>

            <!-- SEÇÃO DE REGRAS -->
            <section id="section-regras" style="display:none;">
                <div class="section-title" style="background: linear-gradient(135deg, #3498db, #2980b9);">
                    📘 GUIA DO JOGADOR - LSJO
                </div>
                
                <div class="regras-container">
                    <!-- Introdução -->
                    <div class="regras-secao">
                        <h2><span>🎯</span> Bem-vindo à LSJO!</h2>
                        <p>Este guia vai te ajudar a aproveitar tudo que a Liga Supremos de Jogos Online oferece.</p>
                    </div>
                    
                    <!-- Cadastro -->
                    <div class="regras-secao">
                        <h2><span>📝</span> COMO SE CADASTRAR</h2>
                        <ol>
                            <li>Clique em "CADASTRO" no menu lateral</li>
                            <li>Escolha um nome começando com LSJO_ (ex: LSJO_Fulano)</li>
                            <li>Crie uma senha com mínimo 6 caracteres</li>
                            <li>Informe sua data de nascimento (você precisa ter pelo menos 13 anos)</li>
                            <li>Aceite os termos de uso</li>
                            <li>Clique em "CRIAR MINHA CONTA"</li>
                        </ol>
                        <p class="aviso"><strong>Importante:</strong> Guarde bem o ID de 4 dígitos que você receberá - ele é sua chave de acesso!</p>
                    </div>
                    
                    <!-- Login -->
                    <div class="regras-secao">
                        <h2><span>🔐</span> COMO FAZER LOGIN</h2>
                        <ol>
                            <li>No painel lateral direito, digite seu ID e senha</li>
                            <li>Clique em "ENTRAR"</li>
                            <li>Pronto! Seu perfil aparecerá na lateral</li>
                        </ol>
                    </div>
                    
                    <!-- Perfil -->
                    <div class="regras-secao">
                        <h2><span>👤</span> SEU PERFIL</h2>
                        <p>No seu perfil você encontra:</p>
                        <ul>
                            <li>Seu avatar (clique nele para personalizar)</li>
                            <li>Seu nome e ID</li>
                            <li>Pontuação total</li>
                            <li>Status da conta</li>
                        </ul>
                        <h3>Personalizando seu avatar:</h3>
                        <p>Clique no avatar ou no ícone de lápis (✏️) e escolha entre várias opções de ícones.</p>
                    </div>
                    
                    <!-- Como Jogar -->
                    <div class="regras-secao">
                        <h2><span>🎮</span> COMO JOGAR</h2>
                        <h3>Iniciando uma partida:</h3>
                        <ol>
                            <li>Clique em "JOGOS" no menu</li>
                            <li>Escolha entre BOLA 8 ou BOLA 9</li>
                            <li>Clique em "JOGAR AGORA" para acessar a plataforma parceira</li>
                        </ol>
                        <h3>🗣️ Combinando a partida:</h3>
                        <p>Ao entrar na sala de jogo, use o chat disponível na plataforma para:</p>
                        <ul>
                            <li>Informar seu ID da LSJO ao adversário</li>
                            <li>Solicitar que o adversário informe o ID dele</li>
                            <li>Confirmar que ambos estão prontos para iniciar</li>
                        </ul>
                        <div class="exemplo">
                            Jogador A: "Meu ID é 1234, qual o seu?"<br>
                            Jogador B: "ID 5678 aqui. Vamos começar!"
                        </div>
                    </div>
                    
                    <!-- Print da Partida -->
                    <div class="regras-secao">
                        <h2><span>📸</span> PROVA DA PARTIDA (IMPORTANTE!)</h2>
                        <p>Para garantir a lisura do campeonato, ao final da partida, tanto o vencedor quanto o perdedor devem:</p>
                        <ul>
                            <li><strong>Tirar um PRINT DA TELA</strong> mostrando:</li>
                            <ul>
                                <li>O resultado final da partida (quem ganhou)</li>
                                <li>A data e hora visíveis no computador (pode ser no canto inferior direito da tela)</li>
                                <li>Os nomes dos jogadores na sala do jogo</li>
                            </ul>
                            <li>Manter o print guardado como prova</li>
                        </ul>
                        <h3>Exemplo de print válido:</h3>
                        <ul>
                            <li>Mostrar claramente o placar final</li>
                            <li>Incluir a barra de tarefas com o relógio do Windows visível</li>
                            <li>Ou qualquer relógio do sistema que não possa ser facilmente editado</li>
                        </ul>
                    </div>
                    
                    <!-- Denúncias -->
                    <div class="regras-secao">
                        <h2><span>⚠️</span> DENÚNCIAS E CONTESTAÇÕES</h2>
                        <p>Se algo errado acontecer, caso haja alguma irregularidade (jogador que não notificou, resultado errado, etc.):</p>
                        <ol>
                            <li>Acesse o botão "CONTATO" no menu</li>
                            <li>Envie sua denúncia <strong>ANEXANDO O PRINT</strong> da partida</li>
                            <li>Informe:</li>
                            <ul>
                                <li>Seu ID</li>
                                <li>ID do adversário</li>
                                <li>Data e hora da partida</li>
                                <li>Explicação do ocorrido</li>
                            </ul>
                        </ol>
                        <p class="aviso"><strong>⏰ PRAZO LIMITE:</strong> Denúncias só serão aceitas em até <strong>12 HORAS</strong> após a partida!</p>
                        <p>Após esse prazo, a notificação será considerada válida e não será mais possível contestar o resultado.</p>
                        <h3>Por que o print é importante?</h3>
                        <ul>
                            <li>É a única prova aceita pela staff</li>
                            <li>Garante que não houve fraude</li>
                            <li>Protege tanto o vencedor quanto o perdedor</li>
                            <li>A data/hora no print comprova que está dentro do prazo de 12 horas</li>
                        </ul>
                    </div>
                    
                    <!-- Notificar Derrotas -->
                    <div class="regras-secao">
                        <h2><span>📢</span> COMO NOTIFICAR DERROTAS</h2>
                        <p>Perdeu uma partida? Siga esses passos:</p>
                        <ol>
                            <li>Clique em "NOTIFICAR" no menu OU no ícone do patinho 🦆 no seu perfil</li>
                            <li>Selecione a liga do jogo</li>
                            <li>Digite o ID do vencedor</li>
                            <li>Escolha a quantidade de derrotas (1 a 7)</li>
                            <li>Clique em "CONFIRMAR DERROTA"</li>
                        </ol>
                        <h3>O que acontece:</h3>
                        <ul>
                            <li>Você perde 2 pontos por derrota</li>
                            <li>O vencedor ganha 2 pontos por vitória</li>
                            <li>O ranking é atualizado na hora</li>
                            <li>Um som de pato confirma a notificação</li>
                        </ul>
                        <p class="aviso"><strong>Limite:</strong> Máximo de 7 derrotas para o mesmo oponente a cada 12 horas.</p>
                    </div>
                    
                    <!-- Ligas e Rankings -->
                    <div class="regras-secao">
                        <h2><span>🏆</span> LIGAS E RANKINGS</h2>
                        <h3>Para participar de uma liga:</h3>
                        <ol>
                            <li>No seu perfil, clique em "INSCREVER NA LIGA"</li>
                            <li>Escolha a liga desejada (Bola 8 ou Bola 9)</li>
                        </ol>
                        <h3>Acessando rankings:</h3>
                        <ol>
                            <li>Clique em "RANKINGS" no menu</li>
                            <li>Escolha a liga que quer consultar</li>
                            <li>Use as abas para ver rankings por:</li>
                            <ul>
                                <li>⭐ PONTOS - Classificação geral</li>
                                <li>🔥 STREAK - Sequência de vitórias</li>
                                <li>📊 APROVEITAMENTO - Percentual de vitórias</li>
                            </ul>
                        </ol>
                        <h3>Navegação:</h3>
                        <ul>
                            <li>Use os botões "ANTERIOR" e "PRÓXIMA" para ver mais jogadores</li>
                            <li>No celular, os rankings aparecem em cards</li>
                            <li>No computador, em tabelas completas</li>
                        </ul>
                        <h3>Clique nos jogadores:</h3>
                        <p>Veja estatísticas rápidas clicando no nome de qualquer jogador ativo!</p>
                    </div>
                    
                    <!-- Status da Conta -->
                    <div class="regras-secao">
                        <h2><span>⚠️</span> STATUS DA CONTA</h2>
                        <p><strong class="sucesso">Ativo 🟢</strong> - Tudo normal, você pode jogar e notificar normalmente.</p>
                        <p><strong class="aviso">Suspenso ⏳</strong> - Você ainda pode fazer login, mas não pode notificar derrotas (patinho desabilitado). Motivo e duração aparecem no seu perfil.</p>
                        <p><strong class="erro">Banido 🚫</strong> - Conta bloqueada permanentemente. Não é possível fazer login.</p>
                    </div>
                    
                    <!-- Dúvidas Comuns -->
                    <div class="regras-secao">
                        <h2><span>❓</span> DÚVIDAS COMUNS</h2>
                        <p><strong>Esqueci meu ID. E agora?</strong> Infelizmente não há recuperação automática. Guarde seu ID em um local seguro!</p>
                        <p><strong>Posso mudar meu nome de usuário?</strong> Não, o nome é definido no cadastro. Para alterar, seria necessário criar nova conta.</p>
                        <p><strong>Por que não consigo notificar?</strong> Verifique se: você está logado, não está suspenso, não excedeu o limite de 7 derrotas para aquele oponente.</p>
                        <p><strong>Perdi a partida mas esqueci de printar. E agora?</strong> Sem o print, não será possível contestar qualquer irregularidade após as 12 horas. SEMPRE tire o print ao final da partida!</p>
                        <p><strong>Meu oponente não notificou minha vitória. O que faço?</strong> Envie uma denúncia pelo CONTATO dentro de 12 horas, anexando o print da partida com data/hora visível.</p>
                        <p><strong>O print precisa mostrar o relógio do Windows?</strong> Sim, ou qualquer relógio do sistema que mostre data e hora atuais. Isso comprova que a partida aconteceu naquele momento.</p>
                        <p><strong>Posso editar o print?</strong> Não. Prints editados serão desconsiderados e podem resultar em banimento.</p>
                    </div>
                    
                    <!-- Acesso por Celular -->
                    <div class="regras-secao">
                        <h2><span>📱</span> ACESSO POR CELULAR</h2>
                        <p>No celular, o site se adapta:</p>
                        <ul>
                            <li>Menu vira botões lado a lado</li>
                            <li>Ranking vira cards para facilitar a leitura</li>
                            <li>Tudo pensado para toque na tela</li>
                        </ul>
                        <p><strong>Para prints no celular:</strong> Certifique-se de que a barra de status do celular (com hora) apareça na imagem!</p>
                    </div>
                    
                    <!-- Regras Básicas -->
                    <div class="regras-secao">
                        <h2><span>📜</span> REGRAS BÁSICAS</h2>
                        <h3>✅ Faça:</h3>
                        <ul>
                            <li>Jogue limpo</li>
                            <li>Informe seu ID no chat antes de começar</li>
                            <li>Tire PRINT do resultado com DATA/HORA visível</li>
                            <li>Notifique apenas resultados reais</li>
                            <li>Respeite os outros jogadores</li>
                            <li>Personalize seu avatar</li>
                        </ul>
                        <h3>❌ Não faça:</h3>
                        <ul>
                            <li>Notificações falsas (resultados inventados)</li>
                            <li>Ofensas ou assédio</li>
                            <li>Criar múltiplas contas</li>
                            <li>Compartilhar sua senha</li>
                            <li>Editar prints ou criar provas falsas</li>
                        </ul>
                        <p><strong>Consequências:</strong> Suspensões temporárias para infrações leves e banimento permanente para casos graves.</p>
                    </div>
                    
                    <!-- Ajuda -->
                    <div class="regras-secao">
                        <h2><span>🆘</span> PRECISA DE AJUDA?</h2>
                        <p>Use o botão "CONTATO" no menu para falar com a administração.</p>
                        <p class="aviso">Lembre-se: Sempre anexe o PRINT da partida com DATA/HORA visível e faça a denúncia dentro do prazo de 12 horas!</p>
                    </div>
                    
                    <!-- Rodapé -->
                    <div class="regras-secao" style="text-align: center;">
                        <p>LSJO - Liga Supremos de Jogos Online</p>
                        <p><strong>Divirta-se e boa sorte nos rankings! 🎱🏆</strong></p>
                    </div>
                </div>
            </section>

            <section id="section-notificar" style="display:none;">
                <div class="section-title" style="background: #e67e22;">📢 NOTIFICAR DERROTA</div>
                <div style="background: #f8f9fa; border: 2px solid #e67e22; border-radius: 15px; padding: 20px;">
                    <div class="form-group">
                        <label>Liga do Jogo:</label>
                        <select id="notif-liga">
                            <option value="BOLA 8">🎱 BOLA 8</option>
                            <option value="BOLA 9">⚪ BOLA 9</option>
                            <option value="TRUCO">🃏 TRUCO</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ID do Vencedor:</label>
                        <input type="text" id="notif-venc" placeholder="Ex: 1001">
                    </div>
                    <div class="form-group">
                        <label>Qtd Derrotas:</label>
                        <select id="notif-qtd">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                        </select>
                    </div>
                    <button class="btn-submit" id="btn-enviar-notif" style="background: #e67e22;">CONFIRMAR DERROTA 🦆</button>
                </div>
            </section>

            <section id="section-master" style="display:none;">
                <div class="section-title" style="background: #000; border: 1px solid #f1c40f; color: #f1c40f;">👑 SISTEMA DEUS - CONTROLE MASTER</div>
                
                <!-- Abas do Master -->
                <div class="master-tabs">
                    <button class="master-tab active" onclick="mudarMasterTab('usuarios')">👥 USUÁRIOS</button>
                    <button class="master-tab" onclick="mudarMasterTab('staff')">🛡️ GERENCIAR STAFF</button>
                    <button class="master-tab" onclick="mudarMasterTab('notificacoes')">📢 NOTIFICAÇÕES (30min)</button>
                </div>
                
                <!-- Painel de Usuários -->
                <div id="master-usuarios" class="master-panel">
                    <div class="search-box">
                        <input type="text" id="search-user" placeholder="Buscar por ID ou Nick..." onkeyup="filtrarUsuarios()">
                        <button>🔍</button>
                    </div>
                    
                    <div style="overflow-x: auto;">
                        <table class="master-table" id="tabela-usuarios">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>AVATAR</th>
                                    <th>NICK</th>
                                    <th>PONTOS</th>
                                    <th>STATUS</th>
                                    <th>AÇÕES</th>
                                </tr>
                            </thead>
                            <tbody id="lista-usuarios-master">
                                <!-- Será preenchido via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Painel de Staff -->
                <div id="master-staff" class="master-panel" style="display: none;">
                    <h3 style="color: #f1c40f; margin-bottom: 20px;">🛡️ GERENCIAR STAFF</h3>
                    
                    <!-- ÁREA PARA ADICIONAR STAFF -->
                    <div style="background: #2c3e50; border-radius: 15px; padding: 20px; margin-bottom: 25px;">
                        <h4 style="color: white; margin-bottom: 15px;">ADICIONAR NOVO STAFF</h4>
                        
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <input type="text" id="staff-id-input" placeholder="Digite o ID do jogador (ex: 1234)" 
                                   style="flex: 2; min-width: 200px; padding: 12px; border-radius: 8px; border: 2px solid #f1c40f; background: #34495e; color: white; font-size: 14px;">
                            
                            <button id="btn-add-staff" onclick="adicionarStaff()" 
                                    style="flex: 1; min-width: 120px; background: #27ae60; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 14px; padding: 12px; transition: 0.3s;">
                                ➕ ADICIONAR STAFF
                            </button>
                        </div>
                        
                        <div id="staff-mensagem" style="margin-top: 10px; font-size: 12px; min-height: 20px;"></div>
                    </div>
                    
                    <!-- LISTA DE STAFF ATUAIS -->
                    <div style="background: #2c3e50; border-radius: 15px; padding: 20px;">
                        <h4 style="color: white; margin-bottom: 15px;">LISTA DE STAFF ATUAIS</h4>
                        
                        <div style="overflow-x: auto;">
                            <table class="master-table" style="width: 100%;">
                                <thead>
                                    <tr>
                                        <th>AVATAR</th>
                                        <th>ID</th>
                                        <th>NICKNAME</th>
                                        <th>CARGO</th>
                                        <th>AÇÃO</th>
                                    </tr>
                                </thead>
                                <tbody id="lista-staff-tbody">
                                    <!-- Será preenchido via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div id="staff-vazio" style="text-align: center; padding: 30px; color: #95a5a6; display: none;">
                            📭 Nenhum staff cadastrado ainda
                        </div>
                    </div>
                </div>
                
                <!-- Painel de Notificações (últimos 30min) -->
                <div id="master-notificacoes" class="master-panel" style="display: none;">
                    <h3 style="color: #f1c40f; margin-bottom: 15px;">📋 ÚLTIMAS NOTIFICAÇÕES (30 MINUTOS)</h3>
                    <div id="lista-notificacoes" style="max-height: 500px; overflow-y: auto;">
                        <!-- Será preenchido via JS -->
                    </div>
                </div>
            </section>

            <section id="section-rankings-hub" style="display:none;">
                <div class="section-title" style="background: #34495e;">🏆 SELECIONE O JOGO</div>
                <div class="ranking-options">
                    <div class="rank-card" onclick="abrirRanking('BOLA 8')">
                        <div class="rank-icon">🎱</div>
                        <h3>Bola 8</h3>
                    </div>
                    <div class="rank-card" onclick="abrirRanking('BOLA 9')">
                        <div class="rank-icon" style="background: radial-gradient(circle at 30% 30%, #f1c40f, #f39c12); color: #000;">9</div>
                        <h3>Bola 9</h3>
                    </div>
                    <div class="rank-card" onclick="abrirRanking('TRUCO')">
                        <div class="rank-icon">🃏</div>
                        <h3>Truco</h3>
                    </div>
                </div>
            </section>

            <section id="section-ranking-view" style="display:none;">
                <div class="section-title" id="ranking-view-title" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    🏆 RANKING BOLA 8
                </div>
                
                <div class="tab-container">
                    <button class="tab-button active" onclick="mudarAbaRanking('PONTOS', this)">
                        <span class="tab-icon">⭐</span> PONTOS
                    </button>
                    <button class="tab-button" onclick="mudarAbaRanking('SEQUÊNCIA', this)">
                        <span class="tab-icon">🔥</span> STREAK
                    </button>
                    <button class="tab-button" onclick="mudarAbaRanking('APROVEITAMENTO', this)">
                        <span class="tab-icon">📊</span> APROVEITAMENTO
                    </button>
                </div>
                
                <button class="btn-voltar" onclick="showSection('rankings-hub')">
                    <span class="seta">←</span> VOLTAR AOS JOGOS
                </button>
                
                <!-- Ranking Cards (Mobile) -->
                <div class="ranking-cards-container" id="ranking-cards">
                    <!-- Cards serão gerados via JS -->
                </div>
                
                <!-- Ranking Table (Desktop) -->
                <div class="ranking-table-wrapper">
                    <table class="ranking-table-moderno">
                        <thead>
                            <tr>
                                <th>POS</th>
                                <th>AVATAR</th>
                                <th>JOGADOR</th>
                                <th>ID</th>
                                <th>PONTOS</th>
                                <th>V/D</th>
                                <th>STREAK</th>
                            </tr>
                        </thead>
                        <tbody id="corpo-tabela-dinamica">
                            <!-- Dados serão inseridos via JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Mensagem de ranking vazio (será mostrada via JS quando necessário) -->
                <div id="empty-ranking-message" class="empty-ranking-message" style="display: none;">
                    <div class="icon">🏆</div>
                    <h3>Nenhum jogador cadastrado ainda</h3>
                    <p>Seja o primeiro a se cadastrar e aparecer no ranking!</p>
                    <button class="btn-menu btn-blue" onclick="showSection('cadastro')" style="width: auto; padding: 10px 30px; margin: 0 auto;">FAZER CADASTRO</button>
                </div>
                
                <!-- Paginação -->
                <div class="pagination-container" id="pagination">
                    <button class="pagination-btn" id="prev-page" onclick="mudarPagina('anterior')" disabled>
                        <span>←</span> ANTERIOR
                    </button>
                    <span class="pagination-info" id="page-info">Página 1 de 1</span>
                    <button class="pagination-btn" id="next-page" onclick="mudarPagina('proxima')" disabled>
                        PRÓXIMA <span>→</span>
                    </button>
                </div>
                
                <!-- Legenda -->
                <div class="ranking-legenda">
                    <div class="legenda-item">
                        <span class="legenda-cor" style="background: linear-gradient(135deg, #fbbf24, #f59e0b);"></span>
                        <span>TOP 3 - Elitério Supremo</span>
                    </div>
                    <div class="legenda-item">
                        <span class="legenda-cor" style="background: linear-gradient(135deg, #60a5fa, #3b82f6);"></span>
                        <span>TOP 10 - Mestres da Bola</span>
                    </div>
                    <div class="legenda-item">
                        <span class="legenda-cor" style="background: linear-gradient(135deg, #34d399, #10b981);"></span>
                        <span>TOP 20 - Guerreiros</span>
                    </div>
                    <div class="legenda-item">
                        <span class="legenda-cor" style="background: #94a3b8;"></span>
                        <span>Vaga Disponível</span>
                    </div>
                </div>
            </section>

            <section id="section-cadastro" style="display:none;">
                <div class="section-title" style="background: #27ae60;">📝 NOVO REGISTRO</div>
                <div style="max-width: 600px; margin: 0 auto;">
                    <div class="form-group">
                        <label>Nome de Usuário*</label>
                        <div>
                            <input type="text" id="reg-nick" value="LSJO_" maxlength="15" oninput="validarPrefixo(this)" style="font-weight: bold; color: #2980b9;">
                            <span class="char-counter" id="contador">10 caracteres restantes</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Senha*</label>
                        <input type="password" id="reg-pass" placeholder="Mínimo 6 caracteres" minlength="6">
                    </div>
                    
                    <div class="form-group">
                        <label>Confirmar Senha*</label>
                        <input type="password" id="reg-pass-confirm" placeholder="Digite a senha novamente">
                    </div>
                    
                    <div class="form-group">
                        <label>Data de Nascimento*</label>
                        <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                            <select id="dia-nasc" style="flex:1; min-width: 70px;" required>
                                <option value="">Dia</option>
                            </select>
                            <select id="mes-nasc" style="flex:2; min-width: 100px;" required>
                                <option value="">Mês</option>
                                <option value="1">Janeiro</option>
                                <option value="2">Fevereiro</option>
                                <option value="3">Março</option>
                                <option value="4">Abril</option>
                                <option value="5">Maio</option>
                                <option value="6">Junho</option>
                                <option value="7">Julho</option>
                                <option value="8">Agosto</option>
                                <option value="9">Setembro</option>
                                <option value="10">Outubro</option>
                                <option value="11">Novembro</option>
                                <option value="12">Dezembro</option>
                            </select>
                            <select id="ano-nasc" style="flex:1; min-width: 80px;" required>
                                <option value="">Ano</option>
                            </select>
                        </div>
                        <small style="color: #666; display: block; margin-top: 5px;">Você deve ter pelo menos 13 anos</small>
                    </div>
                    
                    <div class="form-group">
                        <label>Email (opcional)</label>
                        <input type="email" id="reg-email" placeholder="seu@email.com">
                    </div>
                    
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox" id="termos" required>
                            <span style="font-size: 12px;">Li e aceito os <a href="#" style="color: #2980b9;">termos de uso</a></span>
                        </label>
                    </div>
                    
                    <button class="btn-submit" id="btn-cadastro-firebase">CRIAR MINHA CONTA</button>
                    
                    <div style="text-align: center; margin-top: 15px; font-size: 12px; color: #666;">
                        Já tem uma conta? <a href="#" onclick="showSection('home'); document.getElementById('box-login').style.display='block';" style="color: #2980b9; text-decoration: none;">Faça login</a>
                    </div>
                </div>
            </section>
        </main>

        <aside class="sidebar-right">
            <div class="right-box" id="box-login">
                <div class="right-box-title">🔐 ACESSO RESTRITO</div>
                <div class="right-box-content">
                    <input type="text" class="login-input" id="login-id" placeholder="ID de Acesso">
                    <input type="password" class="login-input" id="login-pass" placeholder="Senha">
                    <button class="btn-login" id="btn-login-firebase">ENTRAR</button>
                </div>
            </div>

            <!-- PERFIL COM AVATAR EDITÁVEL -->
            <div class="right-box" id="box-perfil" style="display:none;">
                <div class="right-box-title">🪪 PERFIL DO SUPREMO</div>
                <div class="right-box-content profile-card">
                    <!-- Avatar com opção de editar -->
                    <div class="avatar-container">
                        <div class="profile-avatar" id="profile-avatar" onclick="abrirModalAvatar()">🎱</div>
                        <div class="edit-avatar-icon" onclick="abrirModalAvatar()">✏️</div>
                    </div>
                    
                    <span class="profile-name" id="user-name">LSJO_PLAYER</span>
                    <div class="profile-stats">
                        <div class="stat-item"><span>ID:</span> <strong id="user-id-card">0000</strong></div>
                        <div class="stat-item"><span>Pontos:</span> <strong id="user-pts-card">0</strong></div>
                        <div class="stat-item"><span id="status-label">Status:</span> <strong id="status-value" style="color:green">Ativa</strong></div>
                    </div>
                    
                    <!-- Mensagem de suspensão (aparece se suspenso) -->
                    <div id="suspenso-mensagem" style="display: none; background: #f39c12; color: #000; padding: 8px; border-radius: 8px; margin: 10px 0; font-size: 11px; font-weight: bold;">
                        ⚠️ Você está suspenso até <span id="suspenso-ate"></span>
                    </div>
                    
                    <!-- ÍCONES DAS LIGAS -->
                    <div class="icones-perfil-container">
                        <!-- PATINHO (desabilitado se suspenso) -->
                        <div id="pato-perfil" class="icone-perfil pato" onclick="showSection('notificar')" title="Notificar Derrota">
                            🦆
                        </div>
                        
                        <!-- BOLA 8 -->
                        <div id="icone-bola8" class="icone-perfil bola8 inativo" onclick="abrirEstatisticasLiga('BOLA 8')" title="Bola 8 (Clique para ver estatísticas)">
                            🎱
                        </div>
                        
                        <!-- BOLA 9 -->
                        <div id="icone-bola9" class="icone-perfil bola9 inativo" onclick="abrirEstatisticasLiga('BOLA 9')" title="Bola 9 (Clique para ver estatísticas)">
                            9
                        </div>
                        
                        <!-- TRUCO -->
                        <div id="icone-truco" class="icone-perfil truco inativo" onclick="abrirEstatisticasLiga('TRUCO')" title="Truco (Clique para ver estatísticas)">
                            🃏
                        </div>
                    </div>
                    
                    <button class="btn-action btn-join" onclick="abrirModalSelecionarLiga()">INSCREVER NA LIGA</button>
                    <button class="btn-action btn-special">MEMBRO ESPECIAL ⭐</button>
                    <button class="btn-action btn-logout" onclick="fazerLogout()">DESLIGAR</button>
                </div>
            </div>

            <div class="right-box">
                <div class="right-box-title">📊 ESTATÍSTICAS</div>
                <div class="right-box-content">
                    <div>Sistema: Soma Zero</div>
                    <div>Status: <span style="color:green">● Online</span></div>
                    <div>Total de Vagas: <strong>40 por página</strong></div>
                </div>
            </div>
            <div class="right-box">
                <div class="right-box-title">📢 AVISOS</div>
                <div class="right-box-content">Notificações falsas resultam em banimento.</div>
            </div>
        </aside>
    </div>
    <footer class="footer-line">LSJO © 2026 - Todos os direitos reservados</footer>
</div>

<!-- MODAL DE SELEÇÃO DE AVATAR -->
<div id="modal-avatar" class="modal">
    <div class="modal-select-liga">
        <h3>🎨 ESCOLHA SEU AVATAR</h3>
        <p>Selecione um avatar para seu perfil:</p>
        
        <div class="avatares-grid">
            <div class="avatar-opcao" onclick="selecionarAvatar('🎱')">🎱</div>
            <div class="avatar-opcao" onclick="selecionarAvatar('9️⃣')">9️⃣</div>
            <div class="avatar-opcao" onclick="selecionarAvatar('🃏')">🃏</div>
            <div class="avatar-opcao" onclick="selecionarAvatar('🔥')">🔥</div>
            <div class="avatar-opcao" onclick="selecionarAvatar('⚡')">⚡</div>
            <div class="avatar-opcao" onclick="selecionarAvatar('👑')">👑</div>
            <div class="avatar-opcao" onclick="selecionarAvatar('⭐')">⭐</div>
            <div class="avatar-opcao" onclick="selecionarAvatar('🎯')">🎯</div>
            <div class="avatar-opcao" onclick="selecionarAvatar('🎮')">🎮</div>
            <div class="avatar-opcao" onclick="selecionarAvatar('🏆')">🏆</div>
        </div>
        
        <div id="avatar-sucesso" style="display: none;" class="success-message">
            ✅ Avatar atualizado com sucesso!
        </div>
        
        <button class="btn-fechar-modal" onclick="fecharModal('modal-avatar')">FECHAR</button>
    </div>
</div>

<!-- MODAL DE SELEÇÃO DE LIGA -->
<div id="modal-select-liga" class="modal">
    <div class="modal-select-liga">
        <h3>🎯 ESCOLHA UMA LIGA</h3>
        <p>Toque na liga que deseja participar:</p>
        
        <div class="opcoes-liga">
            <div class="opcao-liga" onclick="inscreverNaLiga('BOLA 8')">
                <div class="icone-grande">🎱</div>
                <div class="nome-liga">BOLA 8</div>
            </div>
            <div class="opcao-liga" onclick="inscreverNaLiga('BOLA 9')">
                <div class="icone-grande" style="background: radial-gradient(circle at 30% 30%, #f1c40f, #f39c12); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 8px; color: #000; font-weight: 900; font-size: 32px;">9</div>
                <div class="nome-liga">BOLA 9</div>
            </div>
            <div class="opcao-liga" onclick="inscreverNaLiga('TRUCO')">
                <div class="icone-grande">🃏</div>
                <div class="nome-liga">TRUCO</div>
            </div>
        </div>
        
        <div id="mensagem-sucesso" style="display: none;" class="success-message">
            ✅ Inscrição realizada com sucesso!
        </div>
        
        <button class="btn-fechar-modal" onclick="fecharModal('modal-select-liga')">FECHAR</button>
    </div>
</div>

<!-- MODAL DE SUSPENSÃO -->
<div id="modal-suspender" class="modal">
    <div class="modal-content">
        <h3>⏰ SUSPENDER JOGADOR</h3>
        <p id="suspend-user-info" style="color: white; margin-bottom: 15px;"></p>
        
        <select id="tempo-suspensao">
            <option value="3600000">1 hora</option>
            <option value="21600000">6 horas</option>
            <option value="43200000">12 horas</option>
            <option value="86400000">1 dia</option>
            <option value="259200000">3 dias</option>
            <option value="604800000">7 dias</option>
            <option value="2592000000">30 dias</option>
        </select>
        
        <div class="modal-buttons">
            <button class="modal-confirm" onclick="confirmarSuspender()">SUSPENDER</button>
            <button class="modal-cancel" onclick="fecharModal('modal-suspender')">CANCELAR</button>
        </div>
    </div>
</div>

<!-- MODAL DE STAFF -->
<div id="modal-staff" class="modal">
    <div class="modal-content">
        <h3>🛡️ GERENCIAR STAFF</h3>
        <p id="staff-user-info" style="color: white; margin-bottom: 15px;"></p>
        
        <select id="staff-tipo">
            <option value="staff">Tornar Staff</option>
            <option value="remover">Remover Staff</option>
        </select>
        
        <div class="modal-buttons">
            <button class="modal-confirm" onclick="confirmarStaff()">CONFIRMAR</button>
            <button class="modal-cancel" onclick="fecharModal('modal-staff')">CANCELAR</button>
        </div>
    </div>
</div>

<!-- Modais do Master (já existentes) -->
<div id="modal-edit-id" class="modal">
    <div class="modal-content">
        <h3>✏️ ALTERAR ID</h3>
        <input type="text" id="edit-user-id" placeholder="ID atual" readonly>
        <input type="text" id="edit-new-id" placeholder="Novo ID (4 dígitos)" maxlength="4">
        <div class="modal-buttons">
            <button class="modal-confirm" onclick="confirmarAlterarId()">CONFIRMAR</button>
            <button class="modal-cancel" onclick="fecharModal('modal-edit-id')">CANCELAR</button>
        </div>
    </div>
</div>

<div id="modal-revert-notif" class="modal">
    <div class="modal-content">
        <h3>↩️ REVERTER NOTIFICAÇÃO</h3>
        <p id="revert-info" style="color: white; margin-bottom: 15px;"></p>
        <div class="modal-buttons">
            <button class="modal-confirm" onclick="confirmarReverter()">REVERTER</button>
            <button class="modal-cancel" onclick="fecharModal('modal-revert-notif')">CANCELAR</button>
        </div>
    </div>
</div>

<!-- MODAIS DE ESTATÍSTICAS DAS LIGAS -->
<!-- Modal Estatísticas Bola 8 -->
<div id="modal-bola8" class="estatisticas-modal">
    <div class="modal-content-estatisticas">
        <span class="modal-close" onclick="fecharModalEstatisticas('modal-bola8')">&times;</span>
        <div class="modal-header">
            <div style="font-size: 48px;">🎱</div>
            <h2>BOLA 8</h2>
        </div>
        
        <div class="ranking-posicao">
            <span class="posicao-label">Ranking Geral:</span>
            <span class="posicao-numero" id="bola8-posicao">#0</span>
        </div>
        
        <div class="estatisticas-grid">
            <div class="estatistica-card">
                <div class="rotulo">PONTOS</div>
                <div class="valor" id="bola8-pontos">0</div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">V/D</div>
                <div class="valor" id="bola8-vd">0/0</div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">STREAK</div>
                <div class="valor streak-info">
                    <span class="fire">🔥</span>
                    <span id="bola8-streak">0</span>
                </div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">APROVEIT.</div>
                <div class="valor" id="bola8-aproveitamento">0%</div>
            </div>
        </div>
        
        <div class="ranking-posicao" style="background: rgba(241,196,15,0.1);">
            <span class="posicao-label">Ranking Aproveitamento:</span>
            <span class="posicao-numero" id="bola8-posicao-aproveitamento">#0</span>
        </div>
        
        <button class="btn-fechar-modal" onclick="fecharModalEstatisticas('modal-bola8')">FECHAR</button>
    </div>
</div>

<!-- Modal Estatísticas Bola 9 -->
<div id="modal-bola9" class="estatisticas-modal">
    <div class="modal-content-estatisticas">
        <span class="modal-close" onclick="fecharModalEstatisticas('modal-bola9')">&times;</span>
        <div class="modal-header">
            <div style="font-size: 48px; background: radial-gradient(circle at 30% 30%, #f1c40f, #f39c12); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto; color: #000; font-weight: 900;">9</div>
            <h2>BOLA 9</h2>
        </div>
        
        <div class="ranking-posicao">
            <span class="posicao-label">Ranking Geral:</span>
            <span class="posicao-numero" id="bola9-posicao">#0</span>
        </div>
        
        <div class="estatisticas-grid">
            <div class="estatistica-card">
                <div class="rotulo">PONTOS</div>
                <div class="valor" id="bola9-pontos">0</div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">V/D</div>
                <div class="valor" id="bola9-vd">0/0</div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">STREAK</div>
                <div class="valor streak-info">
                    <span class="fire">🔥</span>
                    <span id="bola9-streak">0</span>
                </div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">APROVEIT.</div>
                <div class="valor" id="bola9-aproveitamento">0%</div>
            </div>
        </div>
        
        <div class="ranking-posicao" style="background: rgba(241,196,15,0.1);">
            <span class="posicao-label">Ranking Aproveitamento:</span>
            <span class="posicao-numero" id="bola9-posicao-aproveitamento">#0</span>
        </div>
        
        <button class="btn-fechar-modal" onclick="fecharModalEstatisticas('modal-bola9')">FECHAR</button>
    </div>
</div>

<!-- Modal Estatísticas Truco -->
<div id="modal-truco" class="estatisticas-modal">
    <div class="modal-content-estatisticas">
        <span class="modal-close" onclick="fecharModalEstatisticas('modal-truco')">&times;</span>
        <div class="modal-header">
            <div style="font-size: 48px;">🃏</div>
            <h2>TRUCO</h2>
        </div>
        
        <div class="ranking-posicao">
            <span class="posicao-label">Ranking Geral:</span>
            <span class="posicao-numero" id="truco-posicao">#0</span>
        </div>
        
        <div class="estatisticas-grid">
            <div class="estatistica-card">
                <div class="rotulo">PONTOS</div>
                <div class="valor" id="truco-pontos">0</div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">V/D</div>
                <div class="valor" id="truco-vd">0/0</div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">STREAK</div>
                <div class="valor streak-info">
                    <span class="fire">🔥</span>
                    <span id="truco-streak">0</span>
                </div>
            </div>
            <div class="estatistica-card">
                <div class="rotulo">APROVEIT.</div>
                <div class="valor" id="truco-aproveitamento">0%</div>
            </div>
        </div>
        
        <div class="ranking-posicao" style="background: rgba(241,196,15,0.1);">
            <span class="posicao-label">Ranking Aproveitamento:</span>
            <span class="posicao-numero" id="truco-posicao-aproveitamento">#0</span>
        </div>
        
        <button class="btn-fechar-modal" onclick="fecharModalEstatisticas('modal-truco')">FECHAR</button>
    </div>
</div>

<audio id="duckSound" src="https://www.soundjay.com/nature/sounds/duck-quack-1.mp3"></audio>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getDatabase, ref, set, get, child, onValue, update, remove, push } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

    // CONFIGURAÇÃO COM REGIÃO EUROPE-WEST1
    const firebaseConfig = {
        apiKey: "AIzaSyDez172nRfLpCffiEKRRtxMsVR0LL12sbE",
        authDomain: "lsjo-a5672.firebaseapp.com",
        projectId: "lsjo-a5672",
        databaseURL: "https://lsjo-a5672-default-rtdb.europe-west1.firebasedatabase.app/",
        appId: "1:251677846751:web:6eb9ebf1c1f6159b9a8d6a"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    let usuarioLogado = null;
    let usuarioLogadoTipo = 'usuario'; // 'master', 'staff', 'usuario'
    
    // Variáveis de paginação
    let paginaAtual = 1;
    const ITENS_POR_PAGINA = 40;
    let totalJogadores = 0;
    let todosJogadores = [];
    let rankingTipoAtual = 'BOLA 8';
    let tipoOrdenacaoAtual = 'PONTOS';
    
    // Variáveis para os modais
    let usuarioSelecionado = null;
    let notificacaoSelecionada = null;
    
    // Variáveis para segurança do master
    let tentativasMaster = 0;
    let ultimaTentativaMaster = 0;

    // Lista de avatares disponíveis
    const avatares = ['🎱', '9️⃣', '🃏', '🔥', '⚡', '👑', '⭐', '🎯', '🎮', '🏆'];

    // Gerar opções de data
    function gerarOpcoesData() {
        const diaSelect = document.getElementById('dia-nasc');
        const anoSelect = document.getElementById('ano-nasc');
        
        if (diaSelect) {
            diaSelect.innerHTML = '<option value="">Dia</option>';
            for (let i = 1; i <= 31; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i.toString().padStart(2, '0');
                diaSelect.appendChild(option);
            }
        }
        
        if (anoSelect) {
            anoSelect.innerHTML = '<option value="">Ano</option>';
            const anoAtual = new Date().getFullYear();
            const anoMinimo = anoAtual - 100;
            const anoMaximo = anoAtual - 13;
            
            for (let i = anoMaximo; i >= anoMinimo; i--) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                anoSelect.appendChild(option);
            }
        }
    }

    // Função para calcular streak baseado no histórico
    function calcularStreak(jogador) {
        if (!jogador.historico || jogador.historico.length === 0) {
            return 0;
        }
        
        const ultimasPartidas = jogador.historico.slice(-10);
        let streak = 0;
        
        for (let i = ultimasPartidas.length - 1; i >= 0; i--) {
            if (ultimasPartidas[i].resultado === 'vitoria') {
                streak++;
            } else {
                break;
            }
        }
        
        return streak;
    }

    // Função para calcular aproveitamento
    function calcularAproveitamento(jogador) {
        const vitorias = jogador.v || 0;
        const derrotas = jogador.d || 0;
        const totalJogos = vitorias + derrotas;
        
        if (totalJogos === 0) return 0;
        return Math.round((vitorias / totalJogos) * 100);
    }

    // Função para verificar se usuário está suspenso
    function estaSuspenso(user) {
        if (!user.suspensoAte) return false;
        return Date.now() < user.suspensoAte;
    }

    // Função para formatar data de suspensão
    function formatarDataSuspenso(timestamp) {
        return new Date(timestamp).toLocaleDateString('pt-BR');
    }

    // Função para obter classe de status do jogador
    function getStatusClass(jogador) {
        if (jogador.banido) return 'jogador-banido';
        if (estaSuspenso(jogador)) return 'jogador-suspenso';
        return '';
    }

    // Função para obter ícone de status
    function getStatusIcon(jogador) {
        if (jogador.banido) return ' 🚫';
        if (estaSuspenso(jogador)) return ' ⏳';
        return '';
    }

    // CADASTRO
    document.getElementById('btn-cadastro-firebase').onclick = async () => {
        const nick = document.getElementById('reg-nick').value;
        const pass = document.getElementById('reg-pass').value;
        const passConfirm = document.getElementById('reg-pass-confirm')?.value;
        const dia = document.getElementById('dia-nasc')?.value;
        const mes = document.getElementById('mes-nasc')?.value;
        const ano = document.getElementById('ano-nasc')?.value;
        const termos = document.getElementById('termos')?.checked;
        
        if (nick === "LSJO_" || nick.length < 6) { 
            alert("Escolha um nome com pelo menos 6 caracteres!"); 
            return; 
        }
        
        if (pass.length < 6) {
            alert("A senha deve ter no mínimo 6 caracteres!");
            return;
        }
        
        if (pass !== passConfirm) {
            alert("As senhas não conferem!");
            return;
        }
        
        if (!dia || !mes || !ano) {
            alert("Por favor, preencha sua data de nascimento completa!");
            return;
        }
        
        if (!termos) {
            alert("Você precisa aceitar os termos de uso!");
            return;
        }
        
        // Validar idade mínima (13 anos)
        const dataNasc = new Date(ano, mes - 1, dia);
        const hoje = new Date();
        let idade = hoje.getFullYear() - dataNasc.getFullYear();
        const mesDiff = hoje.getMonth() - dataNasc.getMonth();
        
        if (mesDiff < 0 || (mesDiff === 0 && hoje.getDate() < dataNasc.getDate())) {
            idade--;
        }
        
        if (idade < 13) {
            alert("Você deve ter pelo menos 13 anos para se cadastrar!");
            return;
        }
        
        const id = Math.floor(1000 + Math.random() * 9000).toString();
        
        try {
            await set(ref(db, 'usuarios/' + id), {
                nickname: nick, 
                senha: pass, 
                id: id, 
                pontos: 0,
                v: 0, 
                d: 0,
                status: 'ativo',
                banido: false,
                tipo: 'usuario', // 'master', 'staff', 'usuario'
                avatar: '🎱', // Avatar padrão
                historico: [],
                dataNasc: `${dia}/${mes}/${ano}`,
                email: document.getElementById('reg-email')?.value || '',
                dataCadastro: new Date().toISOString()
            });
            
            alert(`✅ CONTA CRIADA COM SUCESSO!\n\nUsuário: ${nick}\nID de Acesso: ${id}\n\nGuarde seu ID com segurança!`);
            showSection('home');
        } catch (error) {
            alert("Erro ao criar conta: " + error.message);
        }
    };

    // LOGIN com segurança reforçada para master
    document.getElementById('btn-login-firebase').onclick = async () => {
        const id = document.getElementById('login-id').value;
        const pass = document.getElementById('login-pass').value;
        const agora = Date.now();

        // Verificar se está em modo de espera por muitas tentativas
        if (tentativasMaster >= 5 && (agora - ultimaTentativaMaster) < 300000) { // 5 minutos de bloqueio
            alert("⏳ Muitas tentativas de login. Aguarde 5 minutos.");
            return;
        }

        // Buscar configuração do master no Firebase (NÃO aparece no código)
        const configRef = ref(db, 'config/master');
        const configSnap = await get(configRef);
        
        if (configSnap.exists()) {
            const masterConfig = configSnap.val();
            
            // Calcular hash da senha digitada
            const senhaHash = CryptoJS.SHA256(pass).toString();
            
            // Verificar se o ID corresponde ao master (ID está no banco, não no código)
            if (id == masterConfig.id && senhaHash === masterConfig.hash) {
                // Login master bem-sucedido
                document.getElementById('nav-master').style.display = 'block';
                entrarNoPerfil({
                    nickname: "LSJO_MASTER", 
                    id: masterConfig.id, 
                    pontos: "0", 
                    status: 'ativo',
                    tipo: 'master',
                    avatar: '👑'
                });
                
                // Resetar contador de tentativas
                tentativasMaster = 0;
                return;
            } else {
                // Registrar tentativa falha
                tentativasMaster++;
                ultimaTentativaMaster = agora;
            }
        }

        // Login normal (não master)
        const dbRef = ref(db);
        const snap = await get(child(dbRef, 'usuarios/' + id));
        
        if (snap.exists() && snap.val().senha === pass) {
            const user = snap.val();
            
            // Verificar se está banido
            if (user.banido) {
                alert("❌ Esta conta está banida!");
                return;
            }
            
            // Verificar se está suspenso
            if (estaSuspenso(user)) {
                alert(`⚠️ Sua conta está suspensa até ${formatarDataSuspenso(user.suspensoAte)}. Você pode fazer login, mas não pode notificar derrotas.`);
            }
            
            usuarioLogado = user;
            entrarNoPerfil(user);
            
            // Se for staff ou master, mostrar painel master
            if (user.tipo === 'staff' || user.tipo === 'master') {
                document.getElementById('nav-master').style.display = 'block';
                usuarioLogadoTipo = user.tipo;
            }
            
            // Resetar contador de tentativas
            tentativasMaster = 0;
        } else {
            // Incrementar contador de tentativas
            tentativasMaster++;
            ultimaTentativaMaster = agora;
            
            // Mensagem genérica para não dar pistas
            alert("ID ou Senha incorretos!");
        }
    };

    // Função para entrar no perfil (agora mostra botão jogos)
    function entrarNoPerfil(user) {
        usuarioLogado = user;
        
        // Mostrar botão JOGOS
        document.getElementById('nav-jogos').style.display = 'block';
        
        // Atualizar avatar
        document.getElementById('profile-avatar').innerText = user.avatar || '🎱';
        
        document.getElementById('user-name').innerText = user.nickname;
        document.getElementById('user-id-card').innerText = user.id;
        document.getElementById('user-pts-card').innerText = user.pontos || 0;
        
        // Verificar status de suspensão
        if (estaSuspenso(user)) {
            document.getElementById('status-value').innerHTML = '⚠️ SUSPENSO';
            document.getElementById('status-value').style.color = '#f39c12';
            document.getElementById('suspenso-mensagem').style.display = 'block';
            document.getElementById('suspenso-ate').innerText = formatarDataSuspenso(user.suspensoAte);
            
            // Desabilitar patinho
            document.getElementById('pato-perfil').classList.add('disabled');
        } else {
            document.getElementById('status-value').innerHTML = 'Ativa';
            document.getElementById('status-value').style.color = 'green';
            document.getElementById('suspenso-mensagem').style.display = 'none';
            document.getElementById('pato-perfil').classList.remove('disabled');
        }
        
        document.getElementById('box-login').style.display = 'none';
        document.getElementById('box-perfil').style.display = 'block';
        document.getElementById('nav-pato').style.display = 'block';
        document.getElementById('nav-cadastro').style.display = 'none';
        
        // Atualizar ícones das ligas
        atualizarIconesLigas();
    }

    // ===== FUNÇÕES DE AVATAR =====
    
    window.abrirModalAvatar = () => {
        document.getElementById('modal-avatar').style.display = 'flex';
    };

    window.selecionarAvatar = async (avatar) => {
        if (!usuarioLogado) return;
        
        try {
            await update(ref(db, 'usuarios/' + usuarioLogado.id), {
                avatar: avatar
            });
            
            usuarioLogado.avatar = avatar;
            document.getElementById('profile-avatar').innerText = avatar;
            
            document.getElementById('avatar-sucesso').style.display = 'block';
            
            setTimeout(() => {
                document.getElementById('avatar-sucesso').style.display = 'none';
                fecharModal('modal-avatar');
            }, 1500);
            
        } catch (error) {
            alert("Erro ao atualizar avatar: " + error.message);
        }
    };

    // ===== FUNÇÕES DAS LIGAS =====
    
    window.abrirModalSelecionarLiga = () => {
        if (!usuarioLogado) {
            alert("Faça login primeiro!");
            return;
        }
        document.getElementById('mensagem-sucesso').style.display = 'none';
        document.getElementById('modal-select-liga').style.display = 'flex';
    };

    window.inscreverNaLiga = async (liga) => {
        if (!usuarioLogado) {
            alert("Faça login primeiro!");
            fecharModal('modal-select-liga');
            return;
        }
        
        try {
            const inscricaoRef = ref(db, `ligas/${liga}/inscritos/${usuarioLogado.id}`);
            const snap = await get(inscricaoRef);
            
            if (snap.exists()) {
                alert(`Você já está inscrito na liga ${liga}!`);
                fecharModal('modal-select-liga');
                return;
            }
            
            await set(ref(db, `ligas/${liga}/inscritos/${usuarioLogado.id}`), {
                id: usuarioLogado.id,
                nickname: usuarioLogado.nickname,
                dataInscricao: Date.now()
            });
            
            await set(ref(db, `ligas/${liga}/estatisticas/${usuarioLogado.id}`), {
                pontos: 0,
                vitorias: 0,
                derrotas: 0
            });
            
            const msgDiv = document.getElementById('mensagem-sucesso');
            msgDiv.style.display = 'block';
            msgDiv.innerHTML = `✅ Inscrito na ${liga} com sucesso!`;
            
            await atualizarIconesLigas();
            
            setTimeout(() => {
                fecharModal('modal-select-liga');
            }, 1500);
            
        } catch (error) {
            alert("Erro ao inscrever: " + error.message);
        }
    };

    window.abrirEstatisticasLiga = async (liga) => {
        if (!usuarioLogado) {
            alert("Faça login primeiro!");
            return;
        }
        
        const inscricaoRef = ref(db, `ligas/${liga}/inscritos/${usuarioLogado.id}`);
        const snap = await get(inscricaoRef);
        
        if (!snap.exists()) {
            alert(`Você não está inscrito na liga ${liga}!`);
            return;
        }
        
        const estatisticasRef = ref(db, `ligas/${liga}/estatisticas/${usuarioLogado.id}`);
        const statsSnap = await get(estatisticasRef);
        const stats = statsSnap.val() || { pontos: 0, vitorias: 0, derrotas: 0 };
        
        const rankingRef = ref(db, `ligas/${liga}/estatisticas`);
        const rankingSnap = await get(rankingRef);
        const rankingData = rankingSnap.val() || {};
        
        const rankingGeral = Object.entries(rankingData)
            .map(([id, data]) => ({ id, pontos: data.pontos || 0, vitorias: data.vitorias || 0, derrotas: data.derrotas || 0 }))
            .sort((a, b) => b.pontos - a.pontos);
        
        const posicaoGeral = rankingGeral.findIndex(j => j.id === usuarioLogado.id) + 1;
        
        const rankingAproveitamento = Object.entries(rankingData)
            .map(([id, data]) => {
                const vitorias = data.vitorias || 0;
                const derrotas = data.derrotas || 0;
                const total = vitorias + derrotas;
                const aproveitamento = total > 0 ? (vitorias / total) * 100 : 0;
                return { id, aproveitamento, vitorias, derrotas };
            })
            .sort((a, b) => b.aproveitamento - a.aproveitamento);
        
        const posicaoAproveitamento = rankingAproveitamento.findIndex(j => j.id === usuarioLogado.id) + 1;
        
        const historicoRef = ref(db, `usuarios/${usuarioLogado.id}/historico`);
        const historicoSnap = await get(historicoRef);
        const historico = historicoSnap.val() || [];
        const historicoLiga = historico.filter(h => h.liga === liga);
        const ultimas5 = historicoLiga.slice(-5);
        let streak = 0;
        for (let i = ultimas5.length - 1; i >= 0; i--) {
            if (ultimas5[i].resultado === 'vitoria') streak++;
            else break;
        }
        
        const vitorias = stats.vitorias || 0;
        const derrotas = stats.derrotas || 0;
        const total = vitorias + derrotas;
        const aproveitamento = total > 0 ? Math.round((vitorias / total) * 100) : 0;
        
        const modalId = liga === 'BOLA 8' ? 'modal-bola8' : (liga === 'BOLA 9' ? 'modal-bola9' : 'modal-truco');
        const prefixo = liga === 'BOLA 8' ? 'bola8' : (liga === 'BOLA 9' ? 'bola9' : 'truco');
        
        document.getElementById(`${prefixo}-posicao`).innerText = `#${posicaoGeral || 0}`;
        document.getElementById(`${prefixo}-pontos`).innerText = stats.pontos || 0;
        document.getElementById(`${prefixo}-vd`).innerText = `${stats.vitorias || 0}/${stats.derrotas || 0}`;
        document.getElementById(`${prefixo}-streak`).innerText = streak;
        document.getElementById(`${prefixo}-aproveitamento`).innerText = `${aproveitamento}%`;
        document.getElementById(`${prefixo}-posicao-aproveitamento`).innerText = `#${posicaoAproveitamento || 0}`;
        
        document.getElementById(modalId).style.display = 'flex';
    };

    window.fecharModalEstatisticas = (modalId) => {
        document.getElementById(modalId).style.display = 'none';
    };

    async function atualizarIconesLigas() {
        if (!usuarioLogado) return;
        
        const ligas = ['BOLA 8', 'BOLA 9', 'TRUCO'];
        const icones = {
            'BOLA 8': 'icone-bola8',
            'BOLA 9': 'icone-bola9',
            'TRUCO': 'icone-truco'
        };
        
        for (const liga of ligas) {
            const iconeId = icones[liga];
            const icone = document.getElementById(iconeId);
            
            const inscricaoRef = ref(db, `ligas/${liga}/inscritos/${usuarioLogado.id}`);
            const snap = await get(inscricaoRef);
            
            if (snap.exists()) {
                icone.classList.remove('inativo');
                icone.title = `${liga} (Clique para ver estatísticas)`;
            } else {
                icone.classList.add('inativo');
                icone.title = `${liga} (Não inscrito - Clique em "INSCREVER NA LIGA")`;
            }
        }
    }

    // ===== FUNÇÃO PARA VER ESTATÍSTICAS DE OUTRO JOGADOR =====
    window.verEstatisticasJogador = async (jogadorId, jogadorNome) => {
        if (!usuarioLogado) {
            alert("Faça login para ver estatísticas de outros jogadores!");
            return;
        }
        
        // Buscar dados do jogador
        const jogadorRef = ref(db, `usuarios/${jogadorId}`);
        const jogadorSnap = await get(jogadorRef);
        
        if (!jogadorSnap.exists()) {
            alert("Jogador não encontrado!");
            return;
        }
        
        const jogador = jogadorSnap.val();
        
        // Verificar se está banido
        if (jogador.banido) {
            alert("❌ Este jogador está banido!");
            return;
        }
        
        // Abrir modal com estatísticas do jogador (usando o mesmo modal do ranking)
        // Por simplicidade, vamos mostrar um alert com as informações básicas
        const status = jogador.banido ? '🚫 Banido' : (estaSuspenso(jogador) ? '⏳ Suspenso' : '✅ Ativo');
        const data = `📊 ESTATÍSTICAS DE ${jogador.nickname}
        
ID: ${jogador.id}
Status: ${status}
Pontos: ${jogador.pontos || 0}
Vitórias: ${jogador.v || 0}
Derrotas: ${jogador.d || 0}
Aproveitamento: ${calcularAproveitamento(jogador)}%
Avatar: ${jogador.avatar || '🎱'}`;
        
        alert(data);
    };

    // RANKING COM PAGINAÇÃO
    window.abrirRanking = (tipo) => {
        rankingTipoAtual = tipo;
        showSection('ranking-view');
        document.getElementById('ranking-view-title').innerHTML = `🏆 RANKING ${tipo}`;
        paginaAtual = 1;
        tipoOrdenacaoAtual = 'PONTOS';
        
        document.querySelectorAll('.tab-button').forEach((btn, index) => {
            if (index === 0) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });
        
        const usuariosRef = ref(db, 'usuarios');
        onValue(usuariosRef, (snapshot) => {
            const data = snapshot.val();
            todosJogadores = [];
            
            if(data) {
                todosJogadores = Object.values(data)
                    .filter(u => u.id !== "0001")
                    .map(jogador => {
                        if (!jogador.historico) {
                            const historico = [];
                            const totalVitorias = jogador.v || 0;
                            const totalDerrotas = jogador.d || 0;
                            
                            for (let i = 0; i < totalVitorias; i++) {
                                historico.push({ resultado: 'vitoria' });
                            }
                            for (let i = 0; i < totalDerrotas; i++) {
                                historico.push({ resultado: 'derrota' });
                            }
                            return { ...jogador, historico, avatar: jogador.avatar || '🎱' };
                        }
                        return { ...jogador, avatar: jogador.avatar || '🎱' };
                    });
            }
            
            totalJogadores = todosJogadores.length;
            document.getElementById('total-jogadores-info').innerHTML = `👥 Total: ${totalJogadores} jogadores`;
            
            atualizarPaginacao();
            renderizarPaginaAtual('PONTOS');
        });
    };

    function renderizarPaginaAtual(tipoOrdenacao = tipoOrdenacaoAtual) {
        const corpo = document.getElementById('corpo-tabela-dinamica');
        const cardsContainer = document.getElementById('ranking-cards');
        const emptyMessage = document.getElementById('empty-ranking-message');
        
        if (!corpo || !cardsContainer) return;
        
        corpo.innerHTML = "";
        cardsContainer.innerHTML = "";
        
        const jogadoresComMetricas = todosJogadores.map(jogador => ({
            ...jogador,
            streak: calcularStreak(jogador),
            aproveitamento: calcularAproveitamento(jogador),
            statusClass: getStatusClass(jogador),
            statusIcon: getStatusIcon(jogador)
        }));
        
        let jogadoresOrdenados = [...jogadoresComMetricas];
        
        switch(tipoOrdenacao) {
            case 'PONTOS':
                jogadoresOrdenados.sort((a, b) => (b.pontos || 0) - (a.pontos || 0));
                break;
            case 'SEQUÊNCIA':
                jogadoresOrdenados.sort((a, b) => b.streak - a.streak);
                break;
            case 'APROVEITAMENTO':
                jogadoresOrdenados.sort((a, b) => b.aproveitamento - a.aproveitamento);
                break;
        }
        
        // Filtrar banidos? (decidi mostrar todos, mas com indicador visual)
        // Se quiser esconder banidos, descomente a linha abaixo:
        // jogadoresOrdenados = jogadoresOrdenados.filter(j => !j.banido);
        
        if (jogadoresOrdenados.length === 0) {
            emptyMessage.style.display = 'block';
            document.getElementById('pagination').style.display = 'none';
            return;
        } else {
            emptyMessage.style.display = 'none';
            document.getElementById('pagination').style.display = 'flex';
        }
        
        const inicio = (paginaAtual - 1) * ITENS_POR_PAGINA;
        const fim = inicio + ITENS_POR_PAGINA;
        const jogadoresPagina = jogadoresOrdenados.slice(inicio, fim);
        
        jogadoresPagina.forEach((jogador, index) => {
            const posicaoGlobal = inicio + index + 1;
            const classeLinha = posicaoGlobal === 1 ? 'top-1' : (posicaoGlobal === 2 ? 'top-2' : (posicaoGlobal === 3 ? 'top-3' : ''));
            const streakClass = jogador.streak > 5 ? 'streak-high' : '';
            
            let valorColuna;
            if (tipoOrdenacao === 'PONTOS') {
                valorColuna = `${jogador.pontos || 0} pts`;
            } else if (tipoOrdenacao === 'SEQUÊNCIA') {
                valorColuna = `🔥 ${jogador.streak}`;
            } else {
                valorColuna = `${jogador.aproveitamento}%`;
            }
            
            // Determinar se o jogador pode ser clicado (banidos não)
            const podeClicar = !jogador.banido;
            const onclickAttr = podeClicar ? `onclick="verEstatisticasJogador('${jogador.id}', '${jogador.nickname}')"` : '';
            const cursorStyle = podeClicar ? 'cursor: pointer;' : 'cursor: not-allowed;';
            const statusDisplay = jogador.banido ? '🚫 ' : (estaSuspenso(jogador) ? '⏳ ' : '');
            
            corpo.innerHTML += `
                <tr class="${classeLinha}">
                    <td><strong>${posicaoGlobal}º</strong></td>
                    <td style="font-size: 20px;">${jogador.avatar || '🎱'}</td>
                    <td>
                        <span class="jogador-link ${jogador.statusClass}" 
                              style="${cursorStyle}" 
                              ${onclickAttr}
                              title="${podeClicar ? 'Clique para ver estatísticas' : (jogador.banido ? 'Jogador banido' : 'Jogador suspenso')}">
                            ${statusDisplay}${jogador.nickname}
                        </span>
                    </td>
                    <td>${jogador.id}</td>
                    <td><strong style="color: #2980b9;">${valorColuna}</strong></td>
                    <td>${jogador.v || 0}/${jogador.d || 0}</td>
                    <td>
                        <span style="display: flex; align-items: center; gap: 5px;">
                            <span class="${streakClass}">🔥</span>
                            <span class="${streakClass}">${jogador.streak}</span>
                        </span>
                    </td>
                </tr>
            `;
            
            // Cards para mobile (também com link)
            cardsContainer.innerHTML += `
                <div class="ranking-card ${classeLinha}" ${podeClicar ? `onclick="verEstatisticasJogador('${jogador.id}', '${jogador.nickname}')"` : ''} style="${podeClicar ? 'cursor: pointer;' : 'cursor: not-allowed; opacity: 0.7;'}">
                    <div class="ranking-card-avatar" style="font-size: 24px;">${jogador.avatar || '🎱'}</div>
                    <div class="ranking-card-info">
                        <div class="ranking-card-nome ${jogador.statusClass}">
                            ${statusDisplay}${jogador.nickname}
                        </div>
                        <div class="ranking-card-detalhes">
                            <span>ID: ${jogador.id}</span>
                            <span>${jogador.v || 0}V / ${jogador.d || 0}D</span>
                        </div>
                    </div>
                    <div class="ranking-card-posicao">${posicaoGlobal}º</div>
                    <div class="ranking-card-pontos">${valorColuna}</div>
                </div>
            `;
        });
        
        const vagasRestantes = ITENS_POR_PAGINA - jogadoresPagina.length;
        for (let i = 0; i < vagasRestantes; i++) {
            const posicaoVaga = inicio + jogadoresPagina.length + i + 1;
            
            corpo.innerHTML += `
                <tr class="slot-vazio">
                    <td><strong>${posicaoVaga}º</strong></td>
                    <td>⚪</td>
                    <td>--- VAGA DISPONÍVEL ---</td>
                    <td>-----</td>
                    <td><strong style="color: #94a3b8;">0</strong></td>
                    <td>0/0</td>
                    <td><span style="color: #94a3b8;">🔥 0</span></td>
                </tr>
            `;
            
            cardsContainer.innerHTML += `
                <div class="ranking-card vazio">
                    <div class="ranking-card-avatar" style="font-size: 24px;">⚪</div>
                    <div class="ranking-card-info">
                        <div class="ranking-card-nome">--- VAGA DISPONÍVEL ---</div>
                        <div class="ranking-card-detalhes">
                            <span>Aguardando Jogador</span>
                        </div>
                    </div>
                    <div class="ranking-card-posicao">${posicaoVaga}º</div>
                    <div class="ranking-card-pontos">0</div>
                </div>
            `;
        }
    }

    function atualizarPaginacao() {
        const totalPaginas = Math.max(1, Math.ceil(Math.max(todosJogadores.length, 1) / ITENS_POR_PAGINA));
        document.getElementById('page-info').innerHTML = `Página ${paginaAtual} de ${totalPaginas}`;
        
        document.getElementById('prev-page').disabled = paginaAtual === 1;
        document.getElementById('next-page').disabled = paginaAtual === totalPaginas;
    }

    window.mudarPagina = (direcao) => {
        if (direcao === 'anterior' && paginaAtual > 1) {
            paginaAtual--;
        } else if (direcao === 'proxima') {
            const totalPaginas = Math.max(1, Math.ceil(todosJogadores.length / ITENS_POR_PAGINA));
            if (paginaAtual < totalPaginas) {
                paginaAtual++;
            }
        }
        atualizarPaginacao();
        renderizarPaginaAtual(tipoOrdenacaoAtual);
    };

    window.mudarAbaRanking = (tipo, btn) => {
        document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        tipoOrdenacaoAtual = tipo;
        paginaAtual = 1;
        renderizarPaginaAtual(tipo);
    };

    // NOTIFICAR DERROTA (com verificação de suspensão)
    document.getElementById('btn-enviar-notif').onclick = async () => {
        const liga = document.getElementById('notif-liga').value;
        const idVenc = document.getElementById('notif-venc').value;
        const qtd = parseInt(document.getElementById('notif-qtd').value);
        const agora = Date.now();

        if(!usuarioLogado) {
            alert("Você precisa estar logado!");
            return;
        }
        
        // Verificar se está suspenso
        if (estaSuspenso(usuarioLogado)) {
            alert(`❌ Você está suspenso até ${formatarDataSuspenso(usuarioLogado.suspensoAte)} e não pode notificar derrotas.`);
            return;
        }
        
        if(idVenc === usuarioLogado.id) {
            alert("Você não pode notificar derrota para si mesmo!");
            return;
        }
        
        const snapV = await get(child(ref(db), `usuarios/${idVenc}`));
        if(!snapV.exists()) {
            alert("Vencedor não existe!");
            return;
        }
        
        if (snapV.val().banido) {
            alert("Vencedor está banido!");
            return;
        }

        const travaRef = ref(db, `travas/${usuarioLogado.id}_vs_${idVenc}`);
        const snapT = await get(travaRef);
        let count = 0;
        if(snapT.exists() && (agora - snapT.val().timestamp < 12*60*60*1000)) {
            count = snapT.val().quantidade;
        }

        if(count + qtd > 7) {
            alert("Limite de 7 derrotas por 12h atingido!");
            return;
        }

        const pontosPerdidos = qtd * 2;
        const pontosGanhos = qtd * 2;
        
        await update(ref(db, `usuarios/${usuarioLogado.id}`), { 
            pontos: (usuarioLogado.pontos || 0) - pontosPerdidos, 
            d: (usuarioLogado.d || 0) + qtd 
        });
        
        await update(ref(db, `usuarios/${idVenc}`), { 
            pontos: (snapV.val().pontos || 0) + pontosGanhos, 
            v: (snapV.val().v || 0) + qtd 
        });
        
        const statsPerdedorRef = ref(db, `ligas/${liga}/estatisticas/${usuarioLogado.id}`);
        const statsPerdedorSnap = await get(statsPerdedorRef);
        const statsPerdedor = statsPerdedorSnap.val() || { pontos: 0, vitorias: 0, derrotas: 0 };
        
        await set(statsPerdedorRef, {
            pontos: (statsPerdedor.pontos || 0) - pontosPerdidos,
            vitorias: statsPerdedor.vitorias || 0,
            derrotas: (statsPerdedor.derrotas || 0) + qtd
        });
        
        const statsVencedorRef = ref(db, `ligas/${liga}/estatisticas/${idVenc}`);
        const statsVencedorSnap = await get(statsVencedorRef);
        const statsVencedor = statsVencedorSnap.val() || { pontos: 0, vitorias: 0, derrotas: 0 };
        
        await set(statsVencedorRef, {
            pontos: (statsVencedor.pontos || 0) + pontosGanhos,
            vitorias: (statsVencedor.vitorias || 0) + qtd,
            derrotas: statsVencedor.derrotas || 0
        });
        
        const perdedorHist = [...(usuarioLogado.historico || [])];
        const vencedorHist = [...(snapV.val().historico || [])];
        
        for (let i = 0; i < qtd; i++) {
            perdedorHist.push({ resultado: 'derrota', data: agora, liga: liga, vencedorId: idVenc });
            vencedorHist.push({ resultado: 'vitoria', data: agora, liga: liga, perdedorId: usuarioLogado.id });
        }
        
        await update(ref(db, `usuarios/${usuarioLogado.id}`), { historico: perdedorHist });
        await update(ref(db, `usuarios/${idVenc}`), { historico: vencedorHist });
        
        const notifRef = ref(db, 'notificacoes');
        await push(notifRef, {
            liga: liga,
            vencedorId: idVenc,
            vencedorNome: snapV.val().nickname,
            perdedorId: usuarioLogado.id,
            perdedorNome: usuarioLogado.nickname,
            quantidade: qtd,
            pontosGanhos: pontosGanhos,
            pontosPerdidos: pontosPerdidos,
            timestamp: agora
        });
        
        await set(travaRef, { quantidade: count + qtd, timestamp: agora });

        document.getElementById('duckSound').play();
        alert(`🦆 Derrota Notificada na liga ${liga} com sucesso!`);
        
        await atualizarIconesLigas();
    };

    // ===== FUNÇÕES DO PAINEL MASTER/STAFF =====
    
    window.mudarMasterTab = (tab) => {
        document.querySelectorAll('.master-tab').forEach(t => t.classList.remove('active'));
        event.target.classList.add('active');
        
        if (tab === 'usuarios') {
            document.getElementById('master-usuarios').style.display = 'block';
            document.getElementById('master-staff').style.display = 'none';
            document.getElementById('master-notificacoes').style.display = 'none';
            carregarUsuariosMaster();
        } else if (tab === 'staff') {
            document.getElementById('master-usuarios').style.display = 'none';
            document.getElementById('master-staff').style.display = 'block';
            document.getElementById('master-notificacoes').style.display = 'none';
            carregarListaStaff();
        } else {
            document.getElementById('master-usuarios').style.display = 'none';
            document.getElementById('master-staff').style.display = 'none';
            document.getElementById('master-notificacoes').style.display = 'block';
            carregarNotificacoes();
        }
    };

    function carregarUsuariosMaster() {
        const usuariosRef = ref(db, 'usuarios');
        onValue(usuariosRef, (snapshot) => {
            const data = snapshot.val();
            const listaMaster = document.getElementById('lista-usuarios-master');
            if(!listaMaster) return;
            listaMaster.innerHTML = "";
            
            if(data) {
                Object.values(data).forEach(u => {
                    if(u.id !== "0001") {
                        let status = '';
                        let acoes = '';
                        
                        // Verificar status
                        if (u.banido) {
                            status = '<span style="color: #c0392b;">🔴 BANIDO</span>';
                        } else if (estaSuspenso(u)) {
                            status = `<span style="color: #f39c12;">⚠️ SUSPENSO até ${formatarDataSuspenso(u.suspensoAte)}</span>`;
                        } else {
                            status = '<span style="color: #27ae60;">🟢 ATIVO</span>';
                        }
                        
                        // Ações baseadas no tipo de usuário logado
                        if (usuarioLogadoTipo === 'master') {
                            // Master tem todas as ações
                            acoes = `
                                <button class="btn-edit" onclick="abrirModalEditarId('${u.id}')">✏️ ID</button>
                                <button class="btn-suspend" onclick="abrirModalSuspender('${u.id}', '${u.nickname}')">⏰ SUSPENDER</button>
                                ${u.banido ? 
                                    `<button class="btn-unban" onclick="desbanirUsuario('${u.id}')">✅ DESBANIR</button>` : 
                                    `<button class="btn-ban" onclick="banirUsuario('${u.id}')">🚫 BANIR</button>`
                                }
                                <button class="btn-staff" onclick="abrirModalStaff('${u.id}', '${u.nickname}', '${u.tipo || 'usuario'}')">🛡️ STAFF</button>
                            `;
                        } else if (usuarioLogadoTipo === 'staff') {
                            // Staff só pode banir/desbanir/suspender (sem ver senha ou editar ID)
                            acoes = `
                                <button class="btn-suspend" onclick="abrirModalSuspender('${u.id}', '${u.nickname}')">⏰ SUSPENDER</button>
                                ${u.banido ? 
                                    `<button class="btn-unban" onclick="desbanirUsuario('${u.id}')">✅ DESBANIR</button>` : 
                                    `<button class="btn-ban" onclick="banirUsuario('${u.id}')">🚫 BANIR</button>`
                                }
                            `;
                        }
                        
                        listaMaster.innerHTML += `<tr>
                            <td><strong>${u.id}</strong></td>
                            <td style="font-size: 20px;">${u.avatar || '🎱'}</td>
                            <td>${u.nickname}</td>
                            <td>${u.pontos || 0}</td>
                            <td>${status}</td>
                            <td>${acoes}</td>
                        </tr>`;
                    }
                });
            }
        });
    }

    // ===== FUNÇÕES PARA GERENCIAR STAFF =====
    
    window.adicionarStaff = async () => {
        const idInput = document.getElementById('staff-id-input');
        const id = idInput.value.trim();
        const mensagemDiv = document.getElementById('staff-mensagem');
        
        if (!id) {
            mensagemDiv.innerHTML = '<span style="color: #e67e22;">⚠️ Digite um ID!</span>';
            return;
        }
        
        if (id.length !== 4 || isNaN(id)) {
            mensagemDiv.innerHTML = '<span style="color: #e67e22;">⚠️ ID deve ter 4 dígitos!</span>';
            return;
        }
        
        // Verificar se o usuário existe
        const snap = await get(child(ref(db), `usuarios/${id}`));
        
        if (!snap.exists()) {
            mensagemDiv.innerHTML = `<span style="color: #c0392b;">❌ Jogador com ID ${id} não encontrado!</span>`;
            return;
        }
        
        const usuario = snap.val();
        
        // Verificar se já é staff ou master
        if (usuario.tipo === 'master') {
            mensagemDiv.innerHTML = '<span style="color: #f39c12;">👑 Este é o Master, não pode ser alterado!</span>';
            return;
        }
        
        if (usuario.tipo === 'staff') {
            mensagemDiv.innerHTML = `<span style="color: #f39c12;">⚠️ ${usuario.nickname} já é staff!</span>`;
            return;
        }
        
        // Promover a staff
        await update(ref(db, `usuarios/${id}`), {
            tipo: 'staff'
        });
        
        mensagemDiv.innerHTML = `<span style="color: #27ae60;">✅ ${usuario.nickname} agora é staff!</span>`;
        idInput.value = '';
        
        // Recarregar lista de staff
        carregarListaStaff();
        
        // Limpar mensagem após 3 segundos
        setTimeout(() => {
            mensagemDiv.innerHTML = '';
        }, 3000);
    };

    // Função para carregar lista de staff
    async function carregarListaStaff() {
        const usuariosRef = ref(db, 'usuarios');
        const snapshot = await get(usuariosRef);
        const data = snapshot.val();
        const tbody = document.getElementById('lista-staff-tbody');
        const vazioDiv = document.getElementById('staff-vazio');
        
        if (!tbody) return;
        
        tbody.innerHTML = "";
        let temStaff = false;
        
        if (data) {
            // Primeiro mostra o Master (sempre no topo)
            Object.values(data).forEach(u => {
                if (u.id === "0001") {
                    temStaff = true;
                    tbody.innerHTML += `
                        <tr style="background: rgba(241, 196, 15, 0.1);">
                            <td style="font-size: 20px;">${u.avatar || '👑'}</td>
                            <td><strong>${u.id}</strong></td>
                            <td>${u.nickname} <span style="background: #f1c40f; color: #000; padding: 2px 6px; border-radius: 4px; font-size: 9px; margin-left: 5px;">MASTER</span></td>
                            <td>👑 Master</td>
                            <td>-</td>
                        </tr>
                    `;
                }
            });
            
            // Depois mostra os staffs
            Object.values(data).forEach(u => {
                if (u.tipo === 'staff' && u.id !== "0001") {
                    temStaff = true;
                    tbody.innerHTML += `
                        <tr>
                            <td style="font-size: 20px;">${u.avatar || '🛡️'}</td>
                            <td><strong>${u.id}</strong></td>
                            <td>${u.nickname}</td>
                            <td>🛡️ Staff</td>
                            <td>
                                <button class="btn-ban" onclick="removerStaff('${u.id}', '${u.nickname}')" style="background: #c0392b; padding: 5px 10px;">
                                    ❌ REMOVER
                                </button>
                            </td>
                        </tr>
                    `;
                }
            });
        }
        
        if (!temStaff) {
            vazioDiv.style.display = 'block';
        } else {
            vazioDiv.style.display = 'none';
        }
    }

    // Função para remover staff
    window.removerStaff = async (id, nome) => {
        if (confirm(`Tem certeza que deseja remover ${nome} (ID: ${id}) do staff?`)) {
            await update(ref(db, `usuarios/${id}`), {
                tipo: 'usuario'
            });
            
            alert(`✅ ${nome} não é mais staff!`);
            carregarListaStaff();
        }
    };

    async function carregarNotificacoes() {
        const notifRef = ref(db, 'notificacoes');
        const snapshot = await get(notifRef);
        const data = snapshot.val();
        const listaNotif = document.getElementById('lista-notificacoes');
        
        if (!listaNotif) return;
        listaNotif.innerHTML = "";
        
        const agora = Date.now();
        const meiaHora = 30 * 60 * 1000;
        
        if (data) {
            const notificacoes = Object.entries(data)
                .map(([key, value]) => ({ id: key, ...value }))
                .filter(n => (agora - n.timestamp) <= meiaHora)
                .sort((a, b) => b.timestamp - a.timestamp);
            
            if (notificacoes.length === 0) {
                listaNotif.innerHTML = '<div style="text-align: center; padding: 30px; color: #95a5a6;">📭 Nenhuma notificação nos últimos 30 minutos</div>';
                return;
            }
            
            notificacoes.forEach(notif => {
                const dataNotif = new Date(notif.timestamp).toLocaleString('pt-BR');
                const tempoAtras = Math.round((agora - notif.timestamp) / 60000);
                
                listaNotif.innerHTML += `
                    <div class="notificacao-item">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <span class="badge">${notif.liga}</span>
                                <strong class="vencedor">${notif.vencedorNome}</strong> 🏆 vs 
                                <strong class="perdedor">${notif.perdedorNome}</strong>
                            </div>
                            ${usuarioLogadoTipo === 'master' ? 
                                `<button class="btn-revert" onclick="abrirModalReverter('${notif.id}', '${notif.vencedorId}', '${notif.perdedorId}', ${notif.quantidade}, ${notif.pontosGanhos})">↩️ REVERTER</button>` : 
                                ''
                            }
                        </div>
                        <div style="margin-top: 5px; color: #bdc3c7;">
                            ${notif.quantidade}x derrotas | +${notif.pontosGanhos} pts / -${notif.pontosPerdidos} pts
                        </div>
                        <div class="tempo">⏱️ ${dataNotif} (há ${tempoAtras} min)</div>
                    </div>
                `;
            });
        } else {
            listaNotif.innerHTML = '<div style="text-align: center; padding: 30px; color: #95a5a6;">📭 Nenhuma notificação encontrada</div>';
        }
    }

    // Funções de banimento (staff e master)
    window.banirUsuario = async (id) => {
        if(confirm(`⚠️ Tem certeza que deseja BANIR o ID ${id}?`)) {
            await update(ref(db, `usuarios/${id}`), { 
                banido: true,
                status: 'banido'
            });
            alert(`✅ Usuário ${id} banido com sucesso!`);
        }
    };

    window.desbanirUsuario = async (id) => {
        if(confirm(`⚠️ Tem certeza que deseja DESBANIR o ID ${id}?`)) {
            await update(ref(db, `usuarios/${id}`), { 
                banido: false,
                status: 'ativo'
            });
            alert(`✅ Usuário ${id} desbanido com sucesso!`);
        }
    };

    // Funções de suspensão (staff e master)
    window.abrirModalSuspender = (id, nome) => {
        usuarioSelecionado = id;
        document.getElementById('suspend-user-info').innerHTML = `Suspender usuário: <strong>${nome}</strong> (ID: ${id})`;
        document.getElementById('modal-suspender').style.display = 'flex';
    };

    window.confirmarSuspender = async () => {
        const tempo = parseInt(document.getElementById('tempo-suspensao').value);
        const suspensoAte = Date.now() + tempo;
        
        await update(ref(db, `usuarios/${usuarioSelecionado}`), {
            suspensoAte: suspensoAte,
            status: 'suspenso'
        });
        
        alert(`✅ Usuário suspenso até ${formatarDataSuspenso(suspensoAte)}!`);
        fecharModal('modal-suspender');
    };

    // Funções de staff (apenas master)
    window.abrirModalStaff = (id, nome, tipoAtual) => {
        if (usuarioLogadoTipo !== 'master') {
            alert("Apenas o Master pode gerenciar staff!");
            return;
        }
        
        usuarioSelecionado = id;
        document.getElementById('staff-user-info').innerHTML = `Gerenciar staff: <strong>${nome}</strong> (ID: ${id})`;
        document.getElementById('modal-staff').style.display = 'flex';
    };

    window.confirmarStaff = async () => {
        const acao = document.getElementById('staff-tipo').value;
        
        if (acao === 'staff') {
            await update(ref(db, `usuarios/${usuarioSelecionado}`), {
                tipo: 'staff'
            });
            alert(`✅ Usuário promovido a Staff!`);
        } else {
            await update(ref(db, `usuarios/${usuarioSelecionado}`), {
                tipo: 'usuario'
            });
            alert(`✅ Staff removido!`);
        }
        
        fecharModal('modal-staff');
        carregarListaStaff();
    };

    // Funções de edição de ID (apenas master)
    window.abrirModalEditarId = (id) => {
        if (usuarioLogadoTipo !== 'master') {
            alert("Apenas o Master pode alterar IDs!");
            return;
        }
        
        usuarioSelecionado = id;
        document.getElementById('edit-user-id').value = id;
        document.getElementById('modal-edit-id').style.display = 'flex';
    };

    window.confirmarAlterarId = async () => {
        if (usuarioLogadoTipo !== 'master') {
            alert("Apenas o Master pode alterar IDs!");
            fecharModal('modal-edit-id');
            return;
        }
        
        const novoId = document.getElementById('edit-new-id').value;
        
        if (!novoId || novoId.length !== 4 || isNaN(novoId)) {
            alert("❌ Digite um ID válido de 4 dígitos!");
            return;
        }
        
        const snap = await get(child(ref(db), `usuarios/${novoId}`));
        if (snap.exists()) {
            alert("❌ Este ID já está em uso por outro jogador!");
            return;
        }
        
        const snapOld = await get(child(ref(db), `usuarios/${usuarioSelecionado}`));
        const userData = snapOld.val();
        
        await set(ref(db, `usuarios/${novoId}`), {
            ...userData,
            id: novoId
        });
        
        await remove(ref(db, `usuarios/${usuarioSelecionado}`));
        
        alert(`✅ ID alterado de ${usuarioSelecionado} para ${novoId} com sucesso!`);
        fecharModal('modal-edit-id');
        document.getElementById('edit-new-id').value = '';
    };

    // Funções de reverter notificação (apenas master)
    window.abrirModalReverter = (notifId, vencedorId, perdedorId, qtd, pontos) => {
        if (usuarioLogadoTipo !== 'master') {
            alert("Apenas o Master pode reverter notificações!");
            return;
        }
        
        notificacaoSelecionada = { notifId, vencedorId, perdedorId, qtd, pontos };
        document.getElementById('revert-info').innerHTML = 
            `Reverter notificação?<br><br>` +
            `🏆 Vencedor ID: ${vencedorId}<br>` +
            `😢 Perdedor ID: ${perdedorId}<br>` +
            `📊 Quantidade: ${qtd} derrotas<br>` +
            `💰 Pontos: ${pontos}`;
        document.getElementById('modal-revert-notif').style.display = 'flex';
    };

    window.confirmarReverter = async () => {
        if (usuarioLogadoTipo !== 'master') return;
        
        const n = notificacaoSelecionada;
        
        const snapVencedor = await get(child(ref(db), `usuarios/${n.vencedorId}`));
        const snapPerdedor = await get(child(ref(db), `usuarios/${n.perdedorId}`));
        
        const vencedor = snapVencedor.val();
        const perdedor = snapPerdedor.val();
        
        await update(ref(db, `usuarios/${n.vencedorId}`), {
            pontos: (vencedor.pontos || 0) - n.pontos,
            v: (vencedor.v || 0) - n.qtd
        });
        
        await update(ref(db, `usuarios/${n.perdedorId}`), {
            pontos: (perdedor.pontos || 0) + n.pontos,
            d: (perdedor.d || 0) - n.qtd
        });
        
        const novoHistVencedor = (vencedor.historico || []).filter(h => 
            !(h.data === n.timestamp && h.resultado === 'vitoria' && h.perdedorId === n.perdedorId)
        );
        
        const novoHistPerdedor = (perdedor.historico || []).filter(h => 
            !(h.data === n.timestamp && h.resultado === 'derrota' && h.vencedorId === n.vencedorId)
        );
        
        await update(ref(db, `usuarios/${n.vencedorId}`), { historico: novoHistVencedor });
        await update(ref(db, `usuarios/${n.perdedorId}`), { historico: novoHistPerdedor });
        
        await remove(ref(db, `notificacoes/${n.notifId}`));
        
        alert("✅ Notificação revertida com sucesso!");
        fecharModal('modal-revert-notif');
        carregarNotificacoes();
    };

    // Funções auxiliares
    window.filtrarUsuarios = () => {
        const filtro = document.getElementById('search-user').value.toLowerCase();
        const linhas = document.querySelectorAll('#lista-usuarios-master tr');
        
        linhas.forEach(linha => {
            const texto = linha.innerText.toLowerCase();
            if (texto.includes(filtro) || filtro === '') {
                linha.style.display = '';
            } else {
                linha.style.display = 'none';
            }
        });
    };

    window.fecharModal = (modalId) => {
        document.getElementById(modalId).style.display = 'none';
    };

    // Monitorar notificações em tempo real
    onValue(ref(db, 'notificacoes'), () => {
        if (document.getElementById('master-notificacoes').style.display === 'block') {
            carregarNotificacoes();
        }
    });

    // Inicialização
    document.addEventListener('DOMContentLoaded', () => {
        gerarOpcoesData();
        setInterval(atualizarRelogio, 1000);
        atualizarRelogio();
        showSection('home');
        
        const navMaster = document.getElementById('nav-master');
        if (navMaster.style.display === 'block') {
            carregarUsuariosMaster();
        }
    });

    function atualizarRelogio() {
        const agora = new Date();
        const info = document.getElementById('relogio');
        const totalJogadoresSpan = document.getElementById('total-jogadores-info');
        if(info && totalJogadoresSpan) {
            info.querySelector('span:first-child').innerHTML = `📅 ${agora.toLocaleDateString('pt-BR')} - ⏰ ${agora.toLocaleTimeString('pt-BR')}`;
            totalJogadoresSpan.innerHTML = `👥 Total: ${totalJogadores} jogadores`;
        }
    }
</script>

<script>
    function showSection(id) {
        document.querySelectorAll('main > section').forEach(s => s.style.display = 'none');
        const section = document.getElementById('section-' + id);
        if(section) section.style.display = 'block';
    }

    function validarPrefixo(input) {
        if (!input.value.startsWith("LSJO_")) { 
            input.value = "LSJO_"; 
        }
        const restantes = 15 - input.value.length;
        document.getElementById('contador').innerHTML = `${restantes} caracteres restantes`;
        if(restantes < 3) {
            document.getElementById('contador').style.color = '#c0392b';
        } else {
            document.getElementById('contador').style.color = '#2980b9';
        }
    }

    function fazerLogout() {
        if(confirm("Deseja realmente desligar?")) { 
            location.reload(); 
        }
    }
    
    window.onclick = function(event) {
        if (event.target.classList.contains('modal')) {
            event.target.style.display = 'none';
        }
        if (event.target.classList.contains('estatisticas-modal')) {
            event.target.style.display = 'none';
        }
    }
</script>
</body>
</html>
